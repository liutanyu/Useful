%!PS-Adobe-2.0
%%Creator: dvips 5.47 Copyright 1986-91 Radical Eye Software
%%Title: tr355.dvi
%%Pages: 31 1
%%BoundingBox: 0 0 612 792
%%EndComments
%%BeginProcSet: tex.pro
/TeXDict 200 dict def TeXDict begin /N /def load def /B{bind def}N /S /exch
load def /X{S N}B /TR /translate load N /isls false N /vsize 10 N /@rigin{
isls{[0 1 -1 0 0 0]concat}if 72 Resolution div 72 VResolution div neg scale
Resolution VResolution vsize neg mul TR matrix currentmatrix dup dup 4 get
round 4 exch put dup dup 5 get round 5 exch put setmatrix}N /@letter{/vsize 10
N}B /@landscape{/isls true N /vsize -1 N}B /@a4{/vsize 10.6929133858 N}B /@a3{
/vsize 15.5531 N}B /@ledger{/vsize 16 N}B /@legal{/vsize 13 N}B /@manualfeed{
statusdict /manualfeed true put}B /@copies{/#copies X}B /FMat[1 0 0 -1 0 0]N
/FBB[0 0 0 0]N /nn 0 N /IE 0 N /ctr 0 N /df-tail{/nn 8 dict N nn begin
/FontType 3 N /FontMatrix fntrx N /FontBBox FBB N string /base X array
/BitMaps X /BuildChar{CharBuilder}N /Encoding IE N end dup{/foo setfont}2
array copy cvx N load 0 nn put /ctr 0 N[}B /df{/sf 1 N /fntrx FMat N df-tail}
B /dfs{div /sf X /fntrx[sf 0 0 sf neg 0 0]N df-tail}B /E{pop nn dup definefont
setfont}B /ch-width{ch-data dup length 5 sub get}B /ch-height{ch-data dup
length 4 sub get}B /ch-xoff{128 ch-data dup length 3 sub get sub}B /ch-yoff{
ch-data dup length 2 sub get 127 sub}B /ch-dx{ch-data dup length 1 sub get}B
/ch-image{ch-data dup type /stringtype ne{ctr get /ctr ctr 1 add N}if}B /id 0
N /rw 0 N /rc 0 N /gp 0 N /cp 0 N /G 0 N /sf 0 N /CharBuilder{save 3 1 roll S
dup /base get 2 index get S /BitMaps get S get /ch-data X pop /ctr 0 N ch-dx 0
ch-xoff ch-yoff ch-height sub ch-xoff ch-width add ch-yoff setcachedevice
ch-width ch-height true[1 0 0 -1 -.1 ch-xoff sub ch-yoff .1 add]{ch-image}
imagemask restore}B /D{/cc X dup type /stringtype ne{]}if nn /base get cc ctr
put nn /BitMaps get S ctr S sf 1 ne{dup dup length 1 sub dup 2 index S get sf
div put}if put /ctr ctr 1 add N}B /I{cc 1 add D}B /bop{userdict /bop-hook
known{bop-hook}if /SI save N @rigin 0 0 moveto}N /eop{clear SI restore
showpage userdict /eop-hook known{eop-hook}if}N /@start{userdict /start-hook
known{start-hook}if /VResolution X /Resolution X 1000 div /DVImag X /IE 256
array N 0 1 255{IE S 1 string dup 0 3 index put cvn put}for}N /p /show load N
/RMat[1 0 0 -1 0 0]N /BDot 260 string N /rulex 0 N /ruley 0 N /v{/ruley X
/rulex X V}B /V statusdict begin /product where{pop product dup length 7 ge{0
7 getinterval(Display)eq}{pop false}ifelse}{false}ifelse end{{gsave TR -.1 -.1
TR 1 1 scale rulex ruley false RMat{BDot}imagemask grestore}}{{gsave TR -.1
-.1 TR rulex ruley scale 1 1 false RMat{BDot}imagemask grestore}}ifelse B /a{
moveto}B /delta 0 N /tail{dup /delta X 0 rmoveto}B /M{S p delta add tail}B /b{
S p tail}B /c{-4 M}B /d{-3 M}B /e{-2 M}B /f{-1 M}B /g{0 M}B /h{1 M}B /i{2 M}B
/j{3 M}B /k{4 M}B /w{0 rmoveto}B /l{p -4 w}B /m{p -3 w}B /n{p -2 w}B /o{p -1 w
}B /q{p 1 w}B /r{p 2 w}B /s{p 3 w}B /t{p 4 w}B /x{0 S rmoveto}B /y{3 2 roll p
a}B /bos{/SS save N}B /eos{clear SS restore}B end
%%EndProcSet
TeXDict begin 1000 300 300 @start /Fa 2 63 df<FFFEFFFEFFFE0F037E8C14>45
D<4000F000F8007E003F000F8007E003F000FC007E001E007E00FC03F007E00F803F007E00F800
F00040000F157E9514>62 D E /Fb 7 117 df<0003FE000FFF001E0700380700380000380000
700000700000700000700007FFFC07FFFC00E03800E03800E03800E07801E07001C07001C07001
C0F001C0E603C0E60380E60380EE0380FC038078078000070000070000E70000EE0000FC0000F8
00001821819916>12 D<001F80001F80000380000780000780000700000700000F00000F00000E
0003EE000FFE001E7E00383C00781C00703C00F03C00E03800E03800E07800E07B00E07300E0F3
00F3F7007FFE003E3C00111A7C9914>100 D<03F00FF81E38381878387078FFF0FFC0E000E000
E000E018E03870F03FE01F800D107C8F12>I<0380038003800000000000000000000000003E00
7E006700EF00CE00CE001E001C001C003C00398039807B8073003F003E0009197D980C>105
D<3C7E007EFF00EFC780CF8380CF0380DE07801E07001C07001C07003C0F003C0E60380E60381E
E0781CC0780FC0700F8013107D8F16>110 D<3CF87FFCEF9CCF1CCE1CDE001E001C001C003C00
3C00380038007800780070000E107D8F10>114 D<06000E000E000E000E001E001C00FFC0FFC0
3C003800380038007800700070007000F180E180E380E700FE007C000A177C960D>116
D E /Fc 25 122 df<007E0001FE0007CF00070F000F0F000E0F000E00000E00000E00000E0000
FFFF00FFFF000E07000E07000E07000E07000E07000E07000E07000E07000E07000E07000E0700
0E07007F0FE07F0FE0131A809915>12 D<F1E0F9F0F9F0F9F0183018303870306070E0E1C0C180
0C0B7F9913>34 D<F0F0F0F004047D830B>46 D<7FFFFF007FFFFF00781E0F00601E0300601E03
00E01E0380C01E0180C01E0180C01E0180001E0000001E0000001E0000001E0000001E0000001E
0000001E0000001E0000001E0000001E0000001E0000001E0000001E0000001E0000001E000003
FFF00003FFF000191A7F991C>84 D<1830387070E060C0E1C0C180C180F9F0F9F0F9F078F00C0B
7B9913>92 D<7F80FFE0F1F0F0F0607000F01FF03FF07870F070E070E073E0F3F1F37FFE3F3C10
107E8F13>97 D<FC0000FC00001C00001C00001C00001C00001C00001C00001C00001C00001CFC
001FFE001F0F001E07801C03801C01C01C01C01C01C01C01C01C01C01C01C01C03801E07801F0F
001BFE0019F800121A7F9915>I<07F81FFC3C3C783C7018E000E000E000E000E000F000700078
0C3E1C1FF807E00E107F8F11>I<007E00007E00000E00000E00000E00000E00000E00000E0000
0E00000E000FEE001FFE003C3E00781E00700E00E00E00E00E00E00E00E00E00E00E00E00E0070
0E00781E003C3E001FFFC00FCFC0121A7F9915>I<07E01FF03C78701C701CFFFCFFFCE000E000
E000F0007000780C3E1C1FF807E00E107F8F11>I<00F803FC07BC0F3C0E3C0E000E000E000E00
0E00FFC0FFC00E000E000E000E000E000E000E000E000E000E000E000E007FE07FE00E1A80990C
>I<0FDF1FFF38777038703870387038703838703FE07FC0700070007FF83FFC7FFEF01FE00FE0
07E007F00F7C3E3FFC0FF010187F8F13>I<FC0000FC00001C00001C00001C00001C00001C0000
1C00001C00001C00001CF8001FFC001F1E001E0E001C0E001C0E001C0E001C0E001C0E001C0E00
1C0E001C0E001C0E001C0E00FF9FC0FF9FC0121A7F9915>I<3C003C003C003C00000000000000
000000000000FC00FC001C001C001C001C001C001C001C001C001C001C001C001C00FF80FF8009
1A80990A>I<01E001E001E001E000000000000000000000000007E007E000E000E000E000E000
E000E000E000E000E000E000E000E000E000E000E000E060E0F1E0F3C0FF807F000B2183990C>
I<FCFC3F00FFFEFF801F0FC3C01E0781C01C0701C01C0701C01C0701C01C0701C01C0701C01C07
01C01C0701C01C0701C01C0701C01C0701C0FF9FE7F8FF9FE7F81D107F8F20>109
D<FCF800FFFC001F1E001E0E001C0E001C0E001C0E001C0E001C0E001C0E001C0E001C0E001C0E
001C0E00FF9FC0FF9FC012107F8F15>I<07E01FF8381C700E6006E007E007E007E007E007E007
700E700E3C3C1FF807E010107F8F13>I<FCFC00FFFE001F0F001E07801C03801C03C01C01C01C
01C01C01C01C01C01C03C01C03801E07801F1F001FFE001DF8001C00001C00001C00001C00001C
0000FF8000FF800012177F8F15>I<FDE0FFF01F701E701E001C001C001C001C001C001C001C00
1C001C00FFC0FFC00C107F8F0F>114 D<3FE07FE0F0E0E060E060F000FF807FC01FE001F0C0F0
E070E070F0F0FFE0DF800C107F8F0F>I<0C000C000C000C001C001C003C00FFC0FFC01C001C00
1C001C001C001C001C001C601C601C601C601EE00FC007800B177F960F>I<FC7E00FC7E001C0E
001C0E001C0E001C0E001C0E001C0E001C0E001C0E001C0E001C0E001C1E001E3E000FFFC007EF
C012107F8F15>I<7F1FC07F1FC00F1E00071C0003B80003B00001E00000E00000F00001F00003
B800071C00061C001E0E00FF1FE0FF1FE01310808F14>120 D<FF3F80FF3F803C0E001C0C001C
0C000E18000E18000E380007300007300007F00003E00003E00001C00001C00001C00001800001
8000618000F30000C70000FE000078000011177F8F14>I E /Fd 1 50 df<18007800F8009800
1800180018001800180018001800180018001800FF80FF8009107E8F0F>49
D E /Fe 1 111 df<3E3F007FFF806FE380EF8380CF83800F03800E03801E07801E07001C0730
1C0F703C0E703C0FE03807C0140E808D15>110 D E /Ff 8 121 df<70F8F8F87005057C840D>
58 D<70F8FCFC7C0C0C0C1C183870F060060E7C840D>I<80000000E0000000F80000003E000000
0F80000003E0000000F80000003E0000000F80000003E0000000F80000003E0000000F80000003
C0000003C000000F8000003E000000F8000003E000000F8000003E000000F8000003E000000F80
00003E000000F8000000E0000000800000001A1C7C9823>62 D<00FFFFFF00FFFFFF000F003E00
0F000E000F000E001F000E001E0006001E000E001E000C003E060C003C060C003C0600003C0E00
007C1C00007FFC00007FFC0000783C0000F8180000F0180000F0180000F0180001F0000001E000
0001E0000001E0000003E0000003C0000003C0000007C000007FFE0000FFFE0000201F7E9E1D>
70 D<00FFFFC000FFFFF0000F00F8000F003C001F003C001F003E001E003E001E003E003E003E
003E007C003C007C003C0078007C00F0007C01F0007807C0007FFF8000FFFC0000F8000000F000
0000F0000001F0000001F0000001E0000001E0000003E0000003E0000003C0000003C0000007C0
00007FFC0000FFFC00001F1F7E9E1D>80 D<1F07F07F003F8FF8FF8033FC3BC38071F83F83C061
F01F01C063E03E03C0E3C03C038003C03C03800380380380078078078007807807000700700700
0700700F000F00F00E1C0F00F00E180E00E01E180E00E01C381E01E01E701E01E00FE01C01C007
C026147F9328>109 D<1F07E0003F9FF00033FC700071F0780061E0380063E07800E3C0700003
C07000038070000780F0000780E0000700E0000701E0000F01C3800F01C3000E03C3000E038700
1E03CE001E01FC001C00F80019147F931B>I<07C3C01FFFE03C7E70307CF07038F06078F0E070
E000700000700000F00000F00000E00000E00071E070F1E060F1C0E0F3E0C0E7E3C07FFF803C3E
0014147E931A>120 D E /Fg 28 122 df<000FF000007FF80001FC3C0003F07C0007E07C0007
C0FE0007C07C0007C07C0007C0000007C0000007C0000007C1FE00FFFFFE00FFFFFE0007C03E00
07C03E0007C03E0007C03E0007C03E0007C03E0007C03E0007C03E0007C03E0007C03E0007C03E
0007C03E0007C03E0007C03E0007C03E0007C03E003FF9FFC03FF9FFC01A20809F1D>12
D<7CFEFEFEFEFEFE7C7C7C7C7C7C7C38383838383838000000007CFEFEFEFEFE7C07207C9F10>
33 D<FFF0FFF0FFF0FFF00C047F8B11>45 D<00700000F0000FF000FFF000F3F00003F00003F0
0003F00003F00003F00003F00003F00003F00003F00003F00003F00003F00003F00003F00003F0
0003F00003F00003F00003F00003F00003F00003F000FFFF80FFFF80111D7C9C1A>49
D<07F8003FFE00787F807C1FC0FE1FC0FE0FE0FE0FE0FE07E07C07E0380FE0000FE0000FC0001F
C0001F80003F00003E00007C0000F80001F00003C0600380600700600E00E01FFFE03FFFC07FFF
C0FFFFC0FFFFC0FFFFC0131D7D9C1A>I<07FC001FFF803F0FC03F07C03F03E03F03E01E03E000
03E001FFE00FFFE03FC3E07E03E0FC03E0F803E0F803E0F803E0FC07E07E1FE03FFDFE0FF0FE17
147F9319>97 D<FF0000FF00001F00001F00001F00001F00001F00001F00001F00001F00001F00
001F00001F1FC01FFFF01FE1F81F807C1F007E1F003E1F003F1F003F1F003F1F003F1F003F1F00
3F1F003F1F003F1F003E1F007E1F80FC1FE1F81CFFF0183FC018207E9F1D>I<03FE000FFF801F
8FC03F0FC07E0FC07C0FC0FC0780FC0000FC0000FC0000FC0000FC0000FC0000FC00007E00007E
00603F00E01FC3C00FFF8003FE0013147E9317>I<0007F80007F80000F80000F80000F80000F8
0000F80000F80000F80000F80000F80000F803FCF80FFFF81F87F83F01F87E00F87C00F8FC00F8
FC00F8FC00F8FC00F8FC00F8FC00F8FC00F8FC00F87C00F87E01F83E03F81F87F80FFEFF03F8FF
18207E9F1D>I<01FF0007FFC01F87E03F01F07E00F07E00F8FC00F8FC00F8FFFFF8FFFFF8FC00
00FC0000FC00007C00007E00003E00183F00381FC0F007FFE001FF8015147F9318>I<003F8000
FFC001FFE003E7E007E7E007C7E007C3C007C00007C00007C00007C00007C000FFFC00FFFC0007
C00007C00007C00007C00007C00007C00007C00007C00007C00007C00007C00007C00007C00007
C00007C00007C0003FFC003FFC0013207F9F10>I<03FE7C0FFFFE1F8FDE1F07DE3E03E03E03E0
3E03E03E03E03E03E01F07C01F8FC01FFF801FFE001800001C00001E00001FFFC01FFFF00FFFF8
3FFFFC7C00FEF8003EF0001EF0001EF0001EF8003E7C007C3F01F81FFFF003FF80171E7F931A>
I<FF0000FF00001F00001F00001F00001F00001F00001F00001F00001F00001F00001F00001F1F
C01F7FF01FF1F01FC0F81F80F81F80F81F00F81F00F81F00F81F00F81F00F81F00F81F00F81F00
F81F00F81F00F81F00F81F00F8FFE3FFFFE3FF18207D9F1D>I<3E007F007F007F007F007F003E
00000000000000000000000000FF00FF001F001F001F001F001F001F001F001F001F001F001F00
1F001F001F001F001F00FFE0FFE00B217EA00E>I<FF0000FF00001F00001F00001F00001F0000
1F00001F00001F00001F00001F00001F00001F01FE1F01FE1F00F01F01E01F03801F07001F1E00
1F3C001F7C001FFE001FFF001F1F001E0F801E07C01E07E01E03F01E01F01E00F8FFC3FFFFC3FF
18207E9F1C>107 D<FF00FF001F001F001F001F001F001F001F001F001F001F001F001F001F00
1F001F001F001F001F001F001F001F001F001F001F001F001F001F001F00FFE0FFE00B207E9F0E
>I<FE1FE07F80FE7FF9FFE01EF0FBC3E01FC0FF03F01F807E01F01F807E01F01F007C01F01F00
7C01F01F007C01F01F007C01F01F007C01F01F007C01F01F007C01F01F007C01F01F007C01F01F
007C01F01F007C01F01F007C01F0FFE3FF8FFEFFE3FF8FFE27147D932C>I<FE1FC0FE7FF01EF1
F01FC0F81F80F81F80F81F00F81F00F81F00F81F00F81F00F81F00F81F00F81F00F81F00F81F00
F81F00F81F00F8FFE3FFFFE3FF18147D931D>I<01FF0007FFC01F83F03E00F83E00F87C007C7C
007CFC007EFC007EFC007EFC007EFC007EFC007E7C007C7C007C3E00F83E00F81F83F007FFC001
FF0017147F931A>I<FF1FC0FFFFF01FE1F81F80FC1F007E1F007E1F003F1F003F1F003F1F003F
1F003F1F003F1F003F1F007F1F007E1F007E1F80FC1FE3F81FFFF01F3FC01F00001F00001F0000
1F00001F00001F00001F0000FFE000FFE000181D7E931D>I<03F8180FFE381FC7783F03F87E01
F87E00F8FE00F8FC00F8FC00F8FC00F8FC00F8FC00F8FC00F8FC00F87E00F87E01F83F03F81F87
F80FFEF803F8F80000F80000F80000F80000F80000F80000F80000F80007FF0007FF181D7E931C
>I<FE3F00FEFF801EEFC01FCFC01F8FC01F8FC01F07801F00001F00001F00001F00001F00001F
00001F00001F00001F00001F00001F0000FFF000FFF00012147E9316>I<0FF63FFE781EE00EE0
06F006F800FFC07FF87FFC1FFE03FF003FC00FE007E007F00FFC1EFFFCCFF010147E9315>I<01
800180018003800380038007800F803F80FFFCFFFC0F800F800F800F800F800F800F800F800F80
0F800F860F860F860F860F860FCC07FC01F80F1D7F9C14>I<FF07F8FF07F81F00F81F00F81F00
F81F00F81F00F81F00F81F00F81F00F81F00F81F00F81F00F81F00F81F00F81F01F81F03F81F87
F80FFEFF03FCFF18147D931D>I<FFE7FE1FE0FFE7FE1FE01F00F007001F00F807000F80F80600
0F80F8060007C1FC0C0007C1BC0C0007C1BE1C0003E31E180003E31E180001F71F300001F60F30
0001F60FF00000FC07E00000FC07E000007C07C000007803C000007803C000003001800023147F
9326>119 D<FFE1FF00FFE1FF000F80700007C0E00007E0C00003E1800001F3800000FF000000
7E0000003E0000003F0000007F8000006F800000C7C0000183E0000381F0000701F8000E00FC00
FF81FF80FF81FF8019147F931C>I<FFE07F80FFE07F801F001C000F8018000F80180007C03000
07C0300003E0600003E0600001F0C00001F0C00001F9C00000F9800000FF8000007F0000007F00
00003E0000003E0000001C0000001C0000001800000018000078300000FC300000FC600000C0E0
0000E1C000007F8000001E000000191D7F931C>I E /Fh 8 56 df<0030000030000030000030
00003000003000003000003000003000003000003000FFFFFCFFFFFC0030000030000030000030
0000300000300000300000300000300000300000300016187E931B>43 D<03000F00FF00F70007
00070007000700070007000700070007000700070007000700070007007FF07FF00C157E9412>
49 D<1F803FE071F0E0F8E078E078E0380078007800F000F001E003C007800E001C1838187038
FFF0FFF0FFF00D157E9412>I<1FE03FF87078703C703C003C003C007800F807F007E00078003C
001E001EE01EE01EE03E707C7FF81FE00F157F9412>I<007000F000F001F003F0077006700E70
1C70187030707070E070FFFEFFFE007000700070007003FE03FE0F157F9412>I<70307FF07FE0
7FC060006000600060006FC07FE078F06070003800380038E038E038E070F0F07FE01F800D157E
9412>I<03F00FF81E1C3C1C781C70007000E080EFF0FFF8F81CF01EE00EE00EE00E600E700E70
1C3C3C1FF80FE00F157F9412>I<60007FFE7FFE7FFEE01CC038C070006000E001C00180038003
000700070006000E000E000E000E000E000E000F167E9512>I E /Fi 52
123 df<00003FE00000FFF80001E0380003807800038078000700700007000000070000000F00
00000E0000000E0000000E000000FFFFE001FFFFE0001C01C0001C01C0001C01C0001C03C0001C
0380003C0380003803800038078000380700003807000078070000700F1800700E3800700E3000
700E3000F00F7000E007E000E003C000E0000001E0000001C0000001C0000071C000007B800000
FF8000007F0000007E0000001D29829F1A>12 D<00E001F001F003E003E003E003C003C007C007
C007800780078007000F000F000E000E000E000C001C001C001800000000000000000000007000
F800F800F000F0000C217BA00E>33 D<FFF0FFF0FFE00C037D8A10>45 D<70F8F8F0F005057B84
0E>I<0000006000000060000000E0000000C0000001C000000380000003000000070000000600
00000E0000001C0000001800000038000000300000007000000060000000E0000001C000000180
0000038000000300000007000000060000000E0000001C00000018000000380000003000000070
00000060000000E0000001C0000001800000038000000300000007000000060000000E0000001C
00000018000000380000003000000070000000E0000000C00000001B2D80A117>I<000F80003F
E000F0F001C0700380700380380700780F00780F00780E00781E00781E00703C00F03C00F03C00
F03C00F07801E07801E07801E07801C07003C0F003C0F00380F00780F00700700F00700E00701C
003878001FF0000FC000151F7C9D17>I<00020006000E001E003E01FC07DC073C003C00380038
007800780070007000F000F000E000E001E001E001C001C003C003C0038003800780FFF8FFF80F
1E7B9D17>I<001F80007FE000F1F001C0700380780330780738380638780E30780C30780C7078
0CE0F80FC0F00781F00003E00007C0000F80001E00007C0001F00003C0000780000E00301C0070
3800603800E07FC3E07FFFC0E1FF80C0FF00C03E00151F7D9D17>I<001F80007FE001F0F003C0
7003803807603806703806707806607007E07007C0F00000E00001C000078000FF0000FE00000F
00000780000780000780000780300780780780780F80F00F00E00F00E01E00603C0070F8003FF0
001F8000151F7C9D17>I<0000E00000E00000E00001E00001C00001C00001C000038000038000
0780000700000700000E00000E00001C00001C0000380000380000700000F30000E70001C70003
8700078F000F0E001E0E003C0E007F9E00FFFCC0C0FFC0001F80003C0000380000380000380000
780000700000700000700013277E9D17>I<0007C0001FE0007C6000F0E001E1E003C1E00781E0
0780000F00000F00001E10001EFE003FFF003F07003E07003E07807C07807C0780780780780F80
780F00F00F00F00F00F01F00F01E00701E00703C0070780078F0003FE0001F8000131F7B9D17>
54 D<003F00007FC001F3C003C1E00380E00700E00700E00701E00F01C00F03C00F83800FC700
07FE0007FC0003FC0007FE000F7F001C3F00381F00780F00F00700E00700E00700E00F00E00E00
E01E00E01C00E03800F8F0007FE0001F8000131F7B9D17>56 D<003F00007F8001F3C003C1C007
80E00780E00F00E00F01E01F01E01E01E01E01E01E03E03E03C03C03C03C07C01C07C01C0F801E
1F800FFF800FFF80010F00000F00001E00001E00703C00F07800F07000E0E000E3C000FF80007E
0000131F7B9D17>I<3FFFFFF83FFFFFFC00000000000000000000000000000000000000000000
00000000000000000000FFFFFFF0FFFFFFE01E0C7B9023>61 D<00FC0003FE00078F000E07001C
0380180380380780300700700700700F00781E00F83E0070FC0001F00003E00007C0000F00000E
00000EE0001CC0001DC0001F80000F00000000000000000000000000000000001C00003E00003E
00003C00003C0000112178A017>63 D<000007000000070000000F0000000F0000001F0000003F
0000003F0000006F0000006F000000CF000000CF0000018F0000038F0000030F0000060F000006
0F00000C0F80000C07800018078000180780003FFF80007FFF800060078000C0078000C0078001
8007800180078003000780070007801F8007C07FE07FF8FFC07FF81D207E9F22>65
D<0001FE060007FF8E001F83CC007E00FC00F8007C01F0007C03C0003807C000380F8000380F00
00381E0000301E0000303C0000303C0000007C000000780000007800000078000000F8000000F0
000000F0000000F00001C0F0000180F00001807000038078000300780007003C000E003E001C00
1F0078000FC1F00007FFC00000FE00001F217A9F21>67 D<01FFFFFE01FFFFFE001E007C001E00
1C001E001C003E001C003C000C003C001C003C0018007C0C1800780C1800780C0000781C0000F8
380000FFF80000FFF80000F0780001F0300001E0300001E0303001E0307003E0006003C000E003
C000C003C001C007C001800780038007800F800F803F00FFFFFF00FFFFFE001F1F7D9E1F>69
D<01FFFFFC01FFFFFC001E00F8001E0038001E0038003E0018003C0018003C0038003C0030007C
0C3000780C3000780C0000781C0000F8380000FFF80000FFF80000F0780001F0300001E0300001
E0300001E0300003E0000003C0000003C0000003C0000007C0000007800000078000000F800000
FFFC0000FFFC00001E1F7D9E1E>I<01FFF001FFF0001F00001E00001E00003E00003C00003C00
003C00007C0000780000780000780000F80000F00000F00000F00001F00001E00001E00001E000
03E00003C00003C00003C00007C0000780000780000F8000FFF800FFF800141F7D9E12>73
D<01FFF80001FFF800001F0000001E0000001E0000003E0000003C0000003C0000003C0000007C
000000780000007800000078000000F8000000F0000000F0000000F0000001F0000001E0000001
E0018001E0038003E0030003C0030003C0070003C0060007C00E0007801E0007803C000F80FC00
FFFFFC00FFFFF800191F7D9E1D>76 D<01FF0000FFC001FF0000FFC0001F0001FC00001F0001F8
00001F0003F800003F0003F80000370006F0000037000CF0000037000DF00000770019F0000063
8019E00000638031E00000638033E00000E38063E00000C380C3C00000C380C3C00000C38187C0
0001C38187C0000183830780000183830780000183860F800003838C0F800003038C0F00000303
980F00000301D81F00000701F01F00000601F01E00000E01E01E00001F01C03E0000FFE1C3FFE0
00FFE183FFE0002A1F7D9E29>I<01FFFF8001FFFFE0001E00F0001E0078003E0038003E003C00
3C003C003C003C007C003C007C0078007800780078007000F800E000F801E000F0078000FFFF00
01FFF80001F0000001E0000001E0000003E0000003E0000003C0000003C0000007C0000007C000
0007800000078000000F800000FFF80000FFF800001E1F7D9E1F>80 D<01FFFF0001FFFFC0001E
01E0001E00F0001E0078003E0078003C0078003C0078003C0078007C00F0007800F0007801E000
7803C000F80F0000FFFE0000FFFC0000F03E0001F01E0001E01F0001E00F0001E01F0003E01E00
03C01E0003C01E0003C03E0007C03E0007803C1807803C180F803C38FFF81E70FFF81FE0000007
C01D207D9E21>82 D<0007F0C0001FFDC0007C3F8000F00F8000E0078001C0078003C003000380
030003800300038003000380000003C0000003E0000003FC000003FF800001FFE00000FFF00000
1FF8000003F8000000F80000007800000038000000380030003800300038007000780070007000
7000F0007801E000FC03C000FF078000CFFF0000C3FC00001A217D9F1A>I<1FFFFFF01FFFFFF0
1F0781E03C0780E038078060300F8060700F0060600F00E0600F00C0E01F00C0C01E00C0001E00
00001E0000003E0000003C0000003C0000003C0000007C000000780000007800000078000000F8
000000F0000000F0000000F0000001F0000001E0000001E0000003E00000FFFF0000FFFF00001C
1F789E21>I<00F9C003FFC0078FC00F0F801E07803C07803C0780780700780700780F00F80F00
F00E00F00E00F01E30F01E70F03C60707C6078FEE03FCFC01F078014147C9317>97
D<07803F803F80070007000F000F000E000E001E001E001C001CF83FFC3F1E3E0E3C0F780F780F
700F700F701FF01FE01EE01EE03CE03CE07870F071E03FC01F0010207B9F15>I<007E0003FF00
07C3800F07801E07803C07803C0000780000780000780000F80000F00000F00000F00000F00300
700700780F003C3C003FF8000FE00011147C9315>I<0000780003F80003F80000700000700000
F00000F00000E00000E00001E00001E00001C000F9C003FFC0078FC00F0F801E07803C07803C07
80780700780700780F00F80F00F00E00F00E00F01E30F01E70F03C60707C6078FEE03FCFC01F07
8015207C9F17>I<00FE0003FF0007C7800F01801E01803C03807C0700781F007FFC007FF000F8
0000F00000F00000F00000700300700700780F003C3C001FF8000FE00011147C9315>I<0000F8
0001FC0003BC00073C00073C000700000700000E00000E00000E00000E00000E0001FFE001FFE0
001C00001C00001C00003C00003800003800003800003800007800007000007000007000007000
00F00000E00000E00000E00000E00001E00001C00001C00001C0007380007B8000FF00007F0000
7C00001629829F0E>I<003E7000FFF001E3F003C3E00781E00F01E00F01E01E01C01E01C01E03
C03E03C03C03803C03803C07803C07803C0F001C1F001E3F000FFF0007CE00000E00001E00001E
00001C00703C00787800F8F0007FE0003F8000141D7E9315>I<01E0000FE0000FE00001C00001
C00003C00003C000038000038000078000078000070000073F000FFF800FE3800F83C00F01C01F
03C01E03801E03801C03803C07803C0700380700380F00780E38780E30701E30701C70F01EE0F0
0FC0E0078015207D9F17>I<00F000F000F000E000000000000000000000000000000F001F803B
C071C063C06380E380078007000F000F000E001E001C701C603C6038E03DC01F800F000C1F7D9E
0E>I<0003C00003C00003C0000380000000000000000000000000000000000000000000007C00
00FE0001CF00018700038700030F00070F00000E00000E00001E00001E00001C00001C00003C00
003C0000380000380000780000780000700000700000F00000F00000E00071E00079C000FF8000
7F00007E00001228829E0E>I<01E0000FE0000FE00001C00001C00003C00003C0000380000380
000780000780000700000703C00F0FE00F1C600E39E00E71E01EE1E01FC1C01F80001F80003FE0
003DF00038F0003878007878E07870C07070C07071C0F07B80F03F80E01E0013207D9F15>I<03
C01FC01FC00380038007800780070007000F000F000E000E001E001E001C001C003C003C003800
38007800780070007000F180F380E300E300F7007E003C000A207C9F0C>I<1E0FE0FC003F1FF3
FE0077F8778E0063F07E0F0063E03C0700E7C07C0F00C780780E000780780E000700700E000F00
F01E000F00F01C000E00E01C000E00E03C001E01E038E01E01E038C01C01C078C01C01C071C03C
03C07B803C03C03F003803801E0023147D9325>I<1E0FE03F1FF077F87063F07863E038E7C078
C780700780700700700F00F00F00E00E00E00E01E01E01C71E01C61C03C61C038E3C03DC3C01F8
3800F018147D931A>I<007E0003FF8007C7800F03C01E01C03C01E03C01E07801E07801E07803
E0F803E0F003C0F003C0F00780F00780700F00781E003C7C003FF8000FC00013147C9317>I<03
C1F007E7F80EFE3C0C7C1C0C781E1CF01E18F01E00E01E00E01E01E03E01E03E01C03C01C03C03
C07803C07803C0F003E1E007E3C007FF80073E000700000F00000F00000E00000E00001E00001E
0000FFC000FFC000171D809317>I<00F8C003FDC0078FC00F0F801E07803C07803C0780780700
780700780700F80F00F00E00F00E00F01E00F01E00F03C00707C0078FC003FFC001F3800003800
00380000780000700000700000700000F0000FFE000FFE00121D7C9315>I<1E1F003F3F8077F1
C063E3C063C3C0E783C0C783800700000700000F00000F00000E00000E00001E00001E00001C00
001C00003C00003C000038000012147D9313>I<01FC03FE07870F0F0E0F0E0F1E000F800FF80F
FC03FC007E001E701EF01CF01CF03CF0787FF01FC010147D9313>I<01C003C003C00380038007
8007800700FFF0FFF00F000E000E001E001E001C001C003C003C00380038007870786070E070C0
79C03F801F000C1C7C9B0F>I<0F00701F80F03BC0F071C0E063C0E06381E0E381E00781C00701
C00703C00F03C00E03800E03800E078C0E079C0E0F180E0F180F3FB807FBF003E1E016147D9318
>I<0F01C01F83E03BC3E071C3E063C1E06380E0E380C00780C00700C00701C00F01800E01800E
01800E03000E03000E07000E0E000F1C0007F80003F00013147D9315>I<0F0070E01F80F1F03B
C0E1F071C0E1F063C0E0F06381E070E381C0600781C0600701C0600703C0E00F03C0C00E0380C0
0E0380C00E0381C00E0781800E0783800E0F83000F1FCF0007FDFE0001F0F8001C147D931E>I<
07C7801FFFC03CFCE07079E07071E060F1E0E0E1C000E00000E00001E00001E00001C00001C000
73C0E0F3C0C0F381C0F7C180EFC780FFFF007C7C0013147D9315>I<0F00701F80F03BC0E071C0
E063C0E06381E0E381C00781C00701C00703C00F03800E03800E03800E07800E07000E0F000E0F
000F3F0007FE0003EE00000E00001E00101C00783C0078380078700071E0007FC0001F0000141D
7D9316>I<01F06003F8E007FFC00E1F800C0300000700000E00001C0000380000F00001E00003
80000700000E01C01C01801C03803F87007FFF00E1FE00C0F80013147E9313>I
E /Fj 30 122 df<000700000F00007F0007FF00FFFF00FFFF00F8FF0000FF0000FF0000FF0000
FF0000FF0000FF0000FF0000FF0000FF0000FF0000FF0000FF0000FF0000FF0000FF0000FF0000
FF0000FF0000FF0000FF0000FF0000FF0000FF0000FF0000FF0000FF0000FF0000FF0000FF007F
FFFE7FFFFE7FFFFE17277BA622>49 D<00FFC00007FFF8001FFFFE003F03FF007E00FF807F007F
C0FF807FC0FF803FE0FF803FE0FF803FE0FF801FE07F001FE03E003FE000003FE000003FC00000
3FC000007F8000007F800000FF000001FE000001FC000003F8000007E000000FC000001F800000
3E00E0007C00E0007800E000F001C001E001C0038001C007FFFFC00FFFFFC01FFFFFC03FFFFFC0
7FFFFF80FFFFFF80FFFFFF80FFFFFF801B277DA622>I<007FC00003FFF00007FFFC000FC1FE00
1F80FF003FC0FF003FE07F803FE07F803FE07F803FE07F803FE07F801FC0FF800F80FF000000FF
000001FE000003FC000007F00000FFC00000FFF8000001FE000000FF0000007F8000007FC00000
3FC000003FE01E003FE07F803FE07F803FE0FFC03FE0FFC03FE0FFC03FE0FFC03FC0FFC07FC07F
807F807F00FF803F81FF001FFFFC0007FFF80000FFC0001B277DA622>I<0000070000000F0000
001F0000003F0000007F000000FF000000FF000001FF000003FF0000077F00000F7F00000E7F00
001C7F0000387F0000707F0000F07F0000E07F0001C07F0003807F0007007F000F007F000E007F
001C007F0038007F0070007F00E0007F00FFFFFFF8FFFFFFF8FFFFFFF80000FF000000FF000000
FF000000FF000000FF000000FF000000FF00007FFFF8007FFFF8007FFFF81D277EA622>I<0C00
07000FC03F000FFFFE000FFFFE000FFFFC000FFFF8000FFFF0000FFFC0000FFF00000E0000000E
0000000E0000000E0000000E0000000E0000000E7FC0000FFFF8000FC1FE000E007F000C007F80
00003F8000003FC000003FC000003FE000003FE03E003FE07F003FE0FF803FE0FF803FE0FF803F
E0FF803FC0FF003FC07E007FC078007F803C00FF001F83FE000FFFFC0007FFF00000FF80001B27
7DA622>I<FFFFFFFFE0FFFFFFFFE0FFFFFFFFE003FE001FE003FE0007F003FE0001F003FE0000
F003FE0000F003FE00007003FE00007003FE00007003FE01C07803FE01C03803FE01C03803FE01
C03803FE03C00003FE03C00003FE0FC00003FFFFC00003FFFFC00003FFFFC00003FE0FC00003FE
03C00003FE03C00003FE01C00E03FE01C00E03FE01C00E03FE01C01C03FE00001C03FE00001C03
FE00001C03FE00003C03FE00003803FE00007803FE0000F803FE0001F803FE0003F803FE001FF8
FFFFFFFFF0FFFFFFFFF0FFFFFFFFF027297DA82D>69 D<FFFFFEFFFFFEFFFFFE01FF0001FF0001
FF0001FF0001FF0001FF0001FF0001FF0001FF0001FF0001FF0001FF0001FF0001FF0001FF0001
FF0001FF0001FF0001FF0001FF0001FF0001FF0001FF0001FF0001FF0001FF0001FF0001FF0001
FF0001FF0001FF0001FF0001FF0001FF0001FF00FFFFFEFFFFFEFFFFFE17297FA81A>73
D<FFFFFFF800FFFFFFFF00FFFFFFFFC003FE003FE003FE000FF003FE0007F803FE0007FC03FE00
03FC03FE0003FE03FE0003FE03FE0003FE03FE0003FE03FE0003FE03FE0003FE03FE0003FE03FE
0003FC03FE0007FC03FE0007F803FE000FF003FE003FE003FFFFFF8003FFFFFE0003FE00000003
FE00000003FE00000003FE00000003FE00000003FE00000003FE00000003FE00000003FE000000
03FE00000003FE00000003FE00000003FE00000003FE00000003FE00000003FE000000FFFFF800
00FFFFF80000FFFFF8000027297DA82F>80 D<FFFFFFE00000FFFFFFFE0000FFFFFFFF800003FE
007FE00003FE000FF00003FE0007F80003FE0007FC0003FE0003FC0003FE0003FE0003FE0003FE
0003FE0003FE0003FE0003FE0003FE0003FE0003FE0003FE0003FE0003FC0003FE0007F80003FE
0007F80003FE001FE00003FE007FC00003FFFFFE000003FFFFFC000003FE01FF000003FE007FC0
0003FE007FE00003FE003FE00003FE003FF00003FE001FF00003FE001FF00003FE001FF00003FE
001FF00003FE001FF00003FE001FF00003FE001FF00003FE001FF00003FE001FF00703FE001FF0
0703FE000FF80703FE000FF80FFFFFF807FE1EFFFFF801FFFCFFFFF8003FF030297DA834>82
D<00FF806003FFF0E00FFFFFE01FC0FFE03F001FE03E0007E07E0003E07C0003E0FC0001E0FC00
01E0FC0000E0FE0000E0FF0000E0FF800000FFF80000FFFFC0007FFFF8007FFFFE003FFFFF801F
FFFFC00FFFFFC007FFFFE001FFFFF0003FFFF00003FFF800001FF800000FF8000007F8E00003F8
E00001F8E00001F8E00001F8F00001F8F00001F0F80003F0FC0003E0FF0007E0FFE01FC0FFFFFF
80E1FFFE00C03FF8001D297CA826>I<7FFFFFFFFFC07FFFFFFFFFC07FFFFFFFFFC07F807FC03F
C07C007FC007C078007FC003C078007FC003C070007FC001C0F0007FC001E0F0007FC001E0E000
7FC000E0E0007FC000E0E0007FC000E0E0007FC000E0E0007FC000E000007FC0000000007FC000
0000007FC0000000007FC0000000007FC0000000007FC0000000007FC0000000007FC000000000
7FC0000000007FC0000000007FC0000000007FC0000000007FC0000000007FC0000000007FC000
0000007FC0000000007FC0000000007FC0000000007FC0000000007FC0000000007FC000000000
7FC0000000FFFFFFE00000FFFFFFE00000FFFFFFE0002B287EA730>I<03FFC0000FFFF0001F81
FC003FC0FE003FC07F003FC07F003FC03F803FC03F801F803F8000003F8000003F80001FFF8001
FFFF8007FE3F801FE03F803FC03F807F803F807F003F80FE003F80FE003F80FE003F80FE007F80
FF007F807F00FFC03FC3DFFC1FFF8FFC03FE07FC1E1B7E9A21>97 D<003FF80001FFFE0007F83F
000FE07F801FC07F803F807F803F807F807F807F807F003F00FF000000FF000000FF000000FF00
0000FF000000FF000000FF000000FF000000FF0000007F0000007F8000003F8001C03FC001C01F
C003C00FE0078007F83F0001FFFC00003FF0001A1B7E9A1F>99 D<00003FF80000003FF8000000
3FF800000003F800000003F800000003F800000003F800000003F800000003F800000003F80000
0003F800000003F800000003F800000003F800000003F800003FE3F80001FFFBF80003F83FF800
0FE00FF8001FC007F8003F8003F8003F8003F8007F8003F8007F0003F800FF0003F800FF0003F8
00FF0003F800FF0003F800FF0003F800FF0003F800FF0003F800FF0003F800FF0003F8007F0003
F8007F0003F8003F8003F8003F8007F8001FC00FF8000FE01FF80007F07FFF8001FFFBFF80003F
C3FF80212A7EA926>I<003FE00001FFFC0007F07E000FE03F001FC01F803F800FC03F800FC07F
000FC07F0007E0FF0007E0FF0007E0FF0007E0FFFFFFE0FFFFFFE0FF000000FF000000FF000000
FF0000007F0000007F8000003F8000E03F8001E01FC001C00FE007C003F81F8001FFFE00003FF8
001B1B7E9A20>I<000FF800003FFE0000FF3F0001FC7F8003F87F8003F87F8007F07F8007F07F
8007F03F0007F0000007F0000007F0000007F0000007F0000007F00000FFFFC000FFFFC000FFFF
C00007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007
F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F0000007F00000
07F0000007F000007FFF80007FFF80007FFF8000192A7EA915>I<FFE0000000FFE0000000FFE0
0000000FE00000000FE00000000FE00000000FE00000000FE00000000FE00000000FE00000000F
E00000000FE00000000FE00000000FE00000000FE00000000FE0FF00000FE3FFC0000FE787E000
0FEE07F0000FFC03F8000FF803F8000FF003F8000FF003F8000FF003F8000FE003F8000FE003F8
000FE003F8000FE003F8000FE003F8000FE003F8000FE003F8000FE003F8000FE003F8000FE003
F8000FE003F8000FE003F8000FE003F8000FE003F8000FE003F800FFFE3FFF80FFFE3FFF80FFFE
3FFF80212A7DA926>104 D<0F801FC03FE03FE03FE03FE03FE01FC00F80000000000000000000
0000000000FFE0FFE0FFE00FE00FE00FE00FE00FE00FE00FE00FE00FE00FE00FE00FE00FE00FE0
0FE00FE00FE00FE00FE00FE00FE0FFFEFFFEFFFE0F2B7DAA14>I<FFE0FFE0FFE00FE00FE00FE0
0FE00FE00FE00FE00FE00FE00FE00FE00FE00FE00FE00FE00FE00FE00FE00FE00FE00FE00FE00F
E00FE00FE00FE00FE00FE00FE00FE00FE00FE00FE00FE00FE00FE0FFFEFFFEFFFE0F2A7DA914>
108 D<FFC07F800FF000FFC1FFE03FFC00FFC7C3F0F87E000FCF03F9E07F000FDC01FB803F000F
F801FF003F800FF001FE003F800FF001FE003F800FF001FE003F800FE001FC003F800FE001FC00
3F800FE001FC003F800FE001FC003F800FE001FC003F800FE001FC003F800FE001FC003F800FE0
01FC003F800FE001FC003F800FE001FC003F800FE001FC003F800FE001FC003F800FE001FC003F
800FE001FC003F800FE001FC003F80FFFE1FFFC3FFF8FFFE1FFFC3FFF8FFFE1FFFC3FFF8351B7D
9A3A>I<FFC0FF0000FFC3FFC000FFC787E0000FCE07F0000FDC03F8000FF803F8000FF003F800
0FF003F8000FF003F8000FE003F8000FE003F8000FE003F8000FE003F8000FE003F8000FE003F8
000FE003F8000FE003F8000FE003F8000FE003F8000FE003F8000FE003F8000FE003F8000FE003
F8000FE003F800FFFE3FFF80FFFE3FFF80FFFE3FFF80211B7D9A26>I<003FE00001FFFC0003F0
7E000FC01F801F800FC03F800FE03F0007E07F0007F07F0007F07F0007F0FF0007F8FF0007F8FF
0007F8FF0007F8FF0007F8FF0007F8FF0007F8FF0007F87F0007F07F0007F03F800FE03F800FE0
1F800FC00FC01F8007F07F0001FFFC00003FE0001D1B7E9A22>I<FFE3FE0000FFEFFFC000FFFF
0FF0000FFC03F8000FF001FC000FE001FE000FE000FE000FE000FF000FE000FF000FE0007F800F
E0007F800FE0007F800FE0007F800FE0007F800FE0007F800FE0007F800FE0007F800FE0007F80
0FE000FF000FE000FF000FE000FE000FF001FE000FF003FC000FF807F8000FFE0FE0000FEFFFC0
000FE3FE00000FE00000000FE00000000FE00000000FE00000000FE00000000FE00000000FE000
00000FE00000000FE0000000FFFE000000FFFE000000FFFE00000021277E9A26>I<FFC7F0FFCF
FCFFDC7E0FD8FF0FF8FF0FF0FF0FF0FF0FF0FF0FE07E0FE0000FE0000FE0000FE0000FE0000FE0
000FE0000FE0000FE0000FE0000FE0000FE0000FE0000FE0000FE000FFFF00FFFF00FFFF00181B
7E9A1C>114 D<03FE701FFFF03E03F07801F07000F0F00070F00070F80070FE0000FFF000FFFF
007FFFC03FFFE01FFFF007FFF800FFFC0007FC0000FCE0007CE0003CF0003CF0003CF80078FC00
78FF01F0FFFFC0E1FF00161B7E9A1B>I<00700000700000700000700000F00000F00000F00001
F00003F00003F00007F0001FFFF0FFFFF0FFFFF007F00007F00007F00007F00007F00007F00007
F00007F00007F00007F00007F00007F00007F00007F03807F03807F03807F03807F03807F03807
F03803F87001FCF000FFE0003FC015267FA51B>I<FFE03FF800FFE03FF800FFE03FF8000FE003
F8000FE003F8000FE003F8000FE003F8000FE003F8000FE003F8000FE003F8000FE003F8000FE0
03F8000FE003F8000FE003F8000FE003F8000FE003F8000FE003F8000FE003F8000FE003F8000F
E003F8000FE007F8000FE007F8000FE00FF80007E01FF80003F83BFF8001FFF3FF80007FE3FF80
211B7D9A26>I<FFFE03FF80FFFE03FF80FFFE03FF8007F000700007F000700007F800F00003F8
00E00003FC01E00001FC01C00001FC01C00000FE03800000FE038000007F070000007F07000000
7F8F0000003F8E0000003FDE0000001FDC0000001FDC0000000FF80000000FF80000000FF80000
0007F000000007F000000003E000000003E000000001C00000211B7F9A24>I<FFFC0FFF00FFFC
0FFF00FFFC0FFF0007F003C00003F807800001FC07800000FE0F000000FF1E0000007F3C000000
3FF80000001FF00000000FF00000000FF000000007F000000007F80000000FFC0000001FFE0000
001EFE0000003C7F000000783F800000F01FC00001E01FE00001C00FE00003C007F000FFF01FFF
80FFF01FFF80FFF01FFF80211B7F9A24>120 D<FFFE03FF80FFFE03FF80FFFE03FF8007F00070
0007F000700007F800F00003F800E00003FC01E00001FC01C00001FC01C00000FE03800000FE03
8000007F070000007F070000007F8F0000003F8E0000003FDE0000001FDC0000001FDC0000000F
F80000000FF80000000FF800000007F000000007F000000003E000000003E000000001C0000000
01C000000003800000000380000038078000007C07000000FE0F000000FE0E000000FE1E000000
FE3C0000007C780000003FE00000000FC000000021277F9A24>I E /Fk
8 106 df<FFFFFFC0FFFFFFC01A027C8B23>0 D<018001C001800180C183E187F99F7DBE1FF807
E007E01FF87DBEF99FE187C1830180018001C0018010147D9417>3 D<0001FF0000000FFFE000
003F01F80000F8003E0001E0000F00038000038007000001C00E000000E00C000000601C000000
70380000003830000000183000000018700000001C600000000C600000000CE00000000EC00000
0006C000000006C000000006C000000006C000000006C000000006C000000006C000000006C000
000006E00000000E600000000C600000000C700000001C3000000018300000001838000000381C
000000700C000000600E000000E007000001C0038000038001E0000F0000F8003E00003F01F800
000FFFE0000001FF0000272B7DA02E>13 D<07E01FF83FFC7FFE7FFEFFFFFFFFFFFFFFFFFFFFFF
FFFFFFFFFF7FFE7FFE3FFC1FF807E010127D9317>15 D<001F007F00F801E001E001C001C001C0
01C001C001C001C001C001C001C001C001C001C003C003800F80FE00F800FE000F80038003C001
C001C001C001C001C001C001C001C001C001C001C001C001C001E001E000F8007F001F102D7DA1
17>102 D<FC00FF001F8003C003C001C001C001C001C001C001C001C001C001C001C001C001C0
01C001E000E000F8007F001F007F00F800E001E001C001C001C001C001C001C001C001C001C001
C001C001C001C003C003C01F80FF00FC00102D7DA117>I<00C000C001C0018001800380030007
00060006000E000C000C001C001800180038003000700060006000E000C000C000E00060006000
700030003800180018001C000C000C000E00060006000700030003800180018001C000C000C00A
2E7CA112>I<C000C000E00060006000700030003800180018001C000C000C000E000600060007
00030003800180018001C000C000C001C001800180038003000700060006000E000C000C001C00
1800180038003000700060006000E000C000C0000A2E7DA112>I E /Fl
82 124 df<001FC3F0007FEFF801F0FE7803C0FC780780F8780700700007007000070070000700
7000070070000700700007007000FFFFFF80FFFFFF800700700007007000070070000700700007
007000070070000700700007007000070070000700700007007000070070000700700007007000
07007000070070007FE3FF007FE3FF001D20809F1B>11 D<001F8000FFC001F1E003C1E00781E0
0701E0070000070000070000070000070000070000FFFFE0FFFFE00700E00700E00700E00700E0
0700E00700E00700E00700E00700E00700E00700E00700E00700E00700E00700E00700E07FC3FE
7FC3FE1720809F19>I<001FE000FFE001F1E003C1E00781E00700E00700E00700E00700E00700
E00700E00700E0FFFFE0FFFFE00700E00700E00700E00700E00700E00700E00700E00700E00700
E00700E00700E00700E00700E00700E00700E00700E07FE7FE7FE7FE1720809F19>I<001FC1FC
00007FE7FE0001F0FF0F0003C0FC0F000780F80F000700F00F0007007000000700700000070070
0000070070000007007000000700700000FFFFFFFF00FFFFFFFF00070070070007007007000700
700700070070070007007007000700700700070070070007007007000700700700070070070007
00700700070070070007007007000700700700070070070007007007007FE3FE3FF07FE3FE3FF0
2420809F26>I<70F8F8F8F8F8F8F8F8F870707070707070707070707070000000000070F8F8F8
7005217CA00D>33 D<7038F87CFC7EFC7E7C3E0C060C060C061C0E180C381C7038F07860300F0E
7E9F17>I<000300C0000300C0000300C0000701C000060180000601800006018000060180000E
0380000C0300000C0300000C0300000C0300001C070000180600FFFFFFFEFFFFFFFE00300C0000
300C0000300C0000701C0000601800006018000060180000601800FFFFFFFEFFFFFFFE01C07000
018060000180600001806000018060000380E0000300C0000300C0000300C0000300C0000701C0
000601800006018000060180001F297D9F26>I<70F8FCFC7C0C0C0C1C183870F060060E7C9F0D>
39 D<00E001C003C0038007000E000E001C001C003800380030007000700070006000E000E000
E000E000E000E000E000E000E000E000E000E000E000E00060007000700070003000380038001C
001C000E000E000700038003C001C000E00B2E7DA112>I<E0007000780038001C000E000E0007
00070003800380018001C001C001C000C000E000E000E000E000E000E000E000E000E000E000E0
00E000E000E000C001C001C001C0018003800380070007000E000E001C00380078007000E0000B
2E7DA112>I<000600000006000000060000000600000006000000060000000600000006000000
060000000600000006000000060000000600000006000000060000FFFFFFF0FFFFFFF000060000
000600000006000000060000000600000006000000060000000600000006000000060000000600
00000600000006000000060000000600001C207D9A23>43 D<70F8FCFC7C0C0C0C1C183870F060
060E7C840D>I<FFC0FFC0FFC00A037F8A0F>I<70F8F8F87005057C840D>I<0003000300070006
0006000E000C000C001C0018001800380030003000700060006000E000C000C001C00180018001
800380030003000700060006000E000C000C001C0018001800380030003000700060006000E000
C000C000102D7DA117>I<03F0000FFC001E1E001C0E00380700780780700380700380700380F0
03C0F003C0F003C0F003C0F003C0F003C0F003C0F003C0F003C0F003C0F003C0F003C0F003C070
03807003807003807807803807001C0E001E1E000FFC0003F000121F7E9D17>I<018003801F80
FF80E3800380038003800380038003800380038003800380038003800380038003800380038003
8003800380038003800380FFFEFFFE0F1E7C9D17>I<07F0001FFC003C3E00701F00600F80E007
80F807C0F807C0F803C0F803C07007C00007C00007C0000F80000F00001F00003E00003C000078
0000F00001E0000380000700000E00C01C00C03800C0700180FFFF80FFFF80FFFF80121E7E9D17
>I<07F0001FFC003C3F00380F00780F80780F807C0780780F80000F80000F80001F00001E0000
7E0003F80003F000003C00001F00000F80000F800007C00007C07007C0F807C0F807C0F807C0F8
0F80E00F80701F003C3E001FFC0007F000121F7E9D17>I<000E00000E00001E00003E00003E00
006E0000EE0000CE00018E00038E00030E00060E000E0E000C0E00180E00380E00300E00600E00
E00E00FFFFF0FFFFF0000E00000E00000E00000E00000E00000E00000E0000FFE000FFE0141E7F
9D17>I<3807003FFF003FFE003FFC003FF00030000030000030000030000030000030000031F8
0037FC003F1E003C0F003807803807800003C00003C00003C00003C07003C0F003C0F003C0F003
C0E00780600780700F003C3E001FFC0007F000121F7E9D17>I<00FE0003FF0007C7800F07801E
07803C07803C0780780000780000700000F06000F3FC00F7FE00FE0F00FC0780F80780F80380F0
03C0F003C0F003C0F003C0F003C07003C07003C07803C07807803807803C0F001E1E000FFC0003
F000121F7E9D17>I<6000007FFFC07FFFC07FFFC0600380C00300C00700C00E00000C00001C00
00380000300000700000E00000E00000C00001C00001C00003C000038000038000038000038000
078000078000078000078000078000078000078000078000121F7D9D17>I<03F0000FFC001E1E
003C0F003807807003807003807003807803807C07807E07003F8E001FFC000FF80007F8000FFE
001EFF003C3F80781F807007C0F003C0E003C0E001C0E001C0E001C0F003C07003807807003E1F
001FFC0007F000121F7E9D17>I<03F0000FFC001E1E003C0F00780700780780F00780F00380F0
0380F003C0F003C0F003C0F003C0F003C07007C07807C0780FC03C1FC01FFBC00FF3C00183C000
0380000780000780780700780F00781E00783C007878003FF0000FC000121F7E9D17>I<70F8F8
F8700000000000000000000070F8F8F87005147C930D>I<70F8F8F87000000000000000000000
70F8F8F87818181838303070E040051D7C930D>I<FFFFFFF0FFFFFFF000000000000000000000
00000000000000000000000000000000000000000000FFFFFFF0FFFFFFF01C0C7D9023>61
D<0FC03FF07878E03CE03CF03CF03CF03C007C007800F801E001C003C003800380030003000300
0300030003000000000000000000000007000F800F800F8007000E207D9F15>63
D<0003800000038000000380000007C0000007C0000007C000000DE000000DE000000DE0000018
F0000018F0000018F00000307800003078000030780000603C0000603C0000603C0000E01E0000
C01E0000FFFE0001FFFF0001800F0001800F0003800F800300078003000780070007C0070003C0
0F8003C0FFE03FFEFFE03FFE1F207F9F22>65 D<FFFFE000FFFFF80007803E0007801F0007800F
0007800F8007800F8007800F8007800F8007800F8007800F0007801F0007803E0007807C0007FF
F80007FFFC0007801E0007800F0007800F8007800780078007C0078007C0078007C0078007C007
8007C00780078007800F8007801F0007803E00FFFFFC00FFFFF0001A1F7E9E20>I<001FC0C000
FFF0C001F83DC007E00FC00F8007C00F0007C01F0003C03E0001C03C0001C07C0001C07C0000C0
7C0000C0F80000C0F8000000F8000000F8000000F8000000F8000000F8000000F8000000F80000
007C0000C07C0000C07C0000C03C0001C03E0001801F0001800F0003800F80070007E00E0001F8
3C0000FFF800001FE0001A217D9F21>I<FFFFE000FFFFFC0007803E0007800F00078007800780
03C0078003E0078001E0078001F0078000F0078000F0078000F8078000F8078000F8078000F807
8000F8078000F8078000F8078000F8078000F8078000F0078000F0078001F0078001E0078001E0
078003C00780078007800F0007803E00FFFFFC00FFFFE0001D1F7E9E23>I<FFFFFF00FFFFFF00
07801F000780070007800300078003000780038007800180078001800780C1800780C1800780C0
000780C0000781C00007FFC00007FFC0000781C0000780C0000780C0000780C0600780C0600780
0060078000C0078000C0078000C0078001C0078001C0078003C007800F80FFFFFF80FFFFFF801B
1F7E9E1F>I<FFFFFF00FFFFFF0007801F00078007000780030007800300078003800780018007
8001800780C1800780C1800780C0000780C0000781C00007FFC00007FFC0000781C0000780C000
0780C0000780C0000780C000078000000780000007800000078000000780000007800000078000
0007800000FFFE0000FFFE0000191F7E9E1E>I<001FE060007FF86001F83CE003E00FE007C007
E00F8003E01F0001E03E0000E03E0000E07C0000E07C0000607C000060F8000060F8000000F800
0000F8000000F8000000F8000000F8000000F8007FFCF8007FFC7C0001E07C0001E07C0001E03E
0001E03E0001E01F0001E00F8001E007C003E003E007E001FC1FE0007FFC60001FF0001E217D9F
24>I<FFF8FFF8FFF8FFF807800F0007800F0007800F0007800F0007800F0007800F0007800F00
07800F0007800F0007800F0007800F0007800F0007FFFF0007FFFF0007800F0007800F0007800F
0007800F0007800F0007800F0007800F0007800F0007800F0007800F0007800F0007800F000780
0F00FFF8FFF8FFF8FFF81D1F7E9E22>I<FFFCFFFC078007800780078007800780078007800780
078007800780078007800780078007800780078007800780078007800780078007800780FFFCFF
FC0E1F7F9E10>I<0FFFC00FFFC0003C00003C00003C00003C00003C00003C00003C00003C0000
3C00003C00003C00003C00003C00003C00003C00003C00003C00003C00003C00003C00003C0070
3C00F83C00F83C00F83C00F87C00E0780078F0003FE0000FC00012207E9E17>I<FFFC1FFCFFFC
1FFC078007E00780078007800F0007801E0007801C0007803800078070000780E0000781C00007
83800007878000078F8000079FC00007BBC00007FBE00007F1F00007E1F00007C0F80007807800
07807C0007803E0007803E0007801F0007800F0007800F80078007C007800FE0FFFC3FFCFFFC3F
FC1E1F7E9E23>I<FFFE00FFFE0007800007800007800007800007800007800007800007800007
800007800007800007800007800007800007800007800007800007800607800607800607800607
800E07800E07800C07801C07803C0780FCFFFFFCFFFFFC171F7E9E1C>I<FF80001FF8FFC0003F
F807C0003F0007C0003F0006E0006F0006E0006F0006E0006F00067000CF00067000CF00067000
CF000638018F000638018F000638018F00061C030F00061C030F00061C030F00060E060F00060E
060F00060E060F0006070C0F0006070C0F0006070C0F000603980F000603980F000603980F0006
01F00F000601F00F000601F00F000F00E00F00FFF0E1FFF8FFF0E1FFF8251F7E9E2A>I<FF807F
F8FFC07FF807C0078007E0030007F0030006F0030006F8030006780300067C0300063C0300063E
0300061F0300060F0300060F8300060783000607C3000603C3000603E3000601E3000601F30006
00FB0006007B0006007F0006003F0006003F0006001F0006001F0006000F000F000700FFF00700
FFF003001D1F7E9E22>I<001F800000FFF00001E0780007C03E000F801F000F000F001E000780
3C0003C03C0003C07C0003E07C0003E0780001E0F80001F0F80001F0F80001F0F80001F0F80001
F0F80001F0F80001F0F80001F0F80001F0780001E07C0003E07C0003E03C0003C03E0007C01E00
07800F000F000F801F0007C03E0001F0F80000FFF000001F80001C217D9F23>I<FFFFE000FFFF
F80007807C0007801E0007801F0007800F0007800F8007800F8007800F8007800F8007800F8007
800F0007801F0007801E0007807C0007FFF80007FFE00007800000078000000780000007800000
0780000007800000078000000780000007800000078000000780000007800000FFFC0000FFFC00
00191F7E9E1F>I<FFFFC000FFFFF00007807C0007801E0007801F0007800F0007800F8007800F
8007800F8007800F8007800F0007801F0007801E0007807C0007FFF00007FFE0000781F0000780
F8000780780007803C0007803C0007803C0007803C0007803E0007803E0007803E0007803E0607
803F0607801F0EFFFC1F8EFFFC0FFC000003F81F207E9E22>82 D<07E1801FF9803C3F80780F80
700780E00380E00380E00180E00180E00180F00000F800007C00007F80003FF8003FFE000FFF00
03FF00003F800007800003C00003C00001C0C001C0C001C0C001C0E001C0E00380F00380F80780
FE0F00CFFE00C3F80012217D9F19>I<7FFFFFE07FFFFFE0780F01E0700F00E0600F0060600F00
60E00F0070C00F0030C00F0030C00F0030C00F0030000F0000000F0000000F0000000F0000000F
0000000F0000000F0000000F0000000F0000000F0000000F0000000F0000000F0000000F000000
0F0000000F0000000F0000000F000007FFFE0007FFFE001C1F7E9E21>I<FFFC7FF8FFFC7FF807
800780078003000780030007800300078003000780030007800300078003000780030007800300
078003000780030007800300078003000780030007800300078003000780030007800300078003
0007800300078003000780070003C0060003C00E0001E00C0000F01C0000F87800003FF000000F
C0001D207E9E22>I<FFF07FF83FF0FFF07FF83FF01F000F800F800F00078003000F0007800300
07800FC0060007800FC0060007800FC00600078019E00E0003C019E00C0003C019E00C0003C039
E00C0001E030F0180001E030F0180001E030F0180000F06078300000F06078300000F060783000
00F0E07C30000078C03C60000078C03C60000078C03C6000003D801EC000003D801EC000003D80
1EC000003F000FC000001F000F8000001F000F8000001F000F8000000E00070000000E00070000
000E000700002C207F9E2F>87 D<7FF83FF87FF83FF807E00F8003C00F0001E00E0001F00C0000
F0180000783800007C3000003C7000003E6000001EC000000FC000000F8000000780000007C000
0007E000000DE000001DF0000018F8000038780000307C0000603C0000E01E0000C01F0001800F
0003800780078007C00FC007E0FFE01FFEFFE01FFE1F1F7F9E22>I<FEFEC0C0C0C0C0C0C0C0C0
C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0C0FEFE072D7CA10D
>91 D<180C3C1E381C70386030E070C060C060C060F87CFC7EFC7E7C3E381C0F0E7B9F17>I<FE
FE0606060606060606060606060606060606060606060606060606060606060606060606060606
060606FEFE072D7FA10D>I<183C387060E0C0C0C0F8FCFC7C38060E7D9F0D>96
D<3FE0007FF800787C00781E00780E00000E00000E00000E0007FE001FFE003F0E007C0E00F80E
00F00E30F00E30F01E30F81E307C7F703FFFE01FC78014147E9317>I<0E0000FE0000FE00000E
00000E00000E00000E00000E00000E00000E00000E00000E00000E3F000EFFC00FC3E00F81E00F
00F00E00F00E00780E00780E00780E00780E00780E00780E00780E00780E00F00F00F00F81E00F
C3C00CFF800C7F0015207F9F19>I<03FC0FFE1E1E3C1E781E7800F000F000F000F000F000F000
F000F80078007C033E071F0E0FFC03F010147E9314>I<000380003F80003F8000038000038000
038000038000038000038000038000038000038007F3800FFF801E1F803C0780780780780380F0
0380F00380F00380F00380F00380F00380F00380F003807803807807803C0F803E1F801FFBF807
E3F815207E9F19>I<03F8000FFC001E1E003C0F00780700780780F00380FFFF80FFFF80F00000
F00000F00000F00000F800007800007C01803E03801F87000FFE0003F80011147F9314>I<007E
00FF01EF038F078F0700070007000700070007000700FFF0FFF007000700070007000700070007
000700070007000700070007000700070007007FF07FF01020809F0E>I<0001E007F7F00FFF70
3E3E703C1E00780F00780F00780F00780F00780F00780F003C1E003E3E003FF80037F000300000
3000003800003FFE001FFFC03FFFE07803E0F000F0E00070E00070E00070F000F07801E03E07C0
1FFF8003FC00141F7F9417>I<0E0000FE0000FE00000E00000E00000E00000E00000E00000E00
000E00000E00000E00000E7F000EFF800FC7C00F83C00F01C00F01C00E01C00E01C00E01C00E01
C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C0FFE7FCFFE7FC16207F9F19>I<1C
003E003E003E001C000000000000000000000000000E007E007E000E000E000E000E000E000E00
0E000E000E000E000E000E000E000E000E00FFC0FFC00A1F809E0C>I<00E001F001F001F000E0
000000000000000000000000007007F007F000F000700070007000700070007000700070007000
700070007000700070007000700070007000700070F0F0F0E0F1E0FFC03F000C28829E0E>I<0E
0000FE0000FE00000E00000E00000E00000E00000E00000E00000E00000E00000E00000E1FF00E
1FF00E0F800E0F000E1E000E3C000E78000EF0000FF0000FF8000FBC000F3C000E1E000E0F000E
0F000E07800E07800E03C0FFCFF8FFCFF815207F9F18>I<0E00FE00FE000E000E000E000E000E
000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E00
0E000E000E00FFE0FFE00B20809F0C>I<0E3F03F000FEFFCFFC00FFC3DC3C000F81F81E000F00
F00E000F00F00E000E00E00E000E00E00E000E00E00E000E00E00E000E00E00E000E00E00E000E
00E00E000E00E00E000E00E00E000E00E00E000E00E00E000E00E00E00FFE7FE7FE0FFE7FE7FE0
23147F9326>I<0E7F00FEFF80FFC7C00F83C00F01C00F01C00E01C00E01C00E01C00E01C00E01
C00E01C00E01C00E01C00E01C00E01C00E01C00E01C0FFE7FCFFE7FC16147F9319>I<01F80007
FE001E07803C03C03801C07000E07000E0F000F0F000F0F000F0F000F0F000F0F000F07000E078
01E03801C03C03C01E078007FE0001F80014147F9317>I<0E3F00FEFFC0FFC3E00F81E00F01F0
0E00F00E00F80E00780E00780E00780E00780E00780E00780E00F80E00F00F01F00F81E00FC7C0
0EFF800E7F000E00000E00000E00000E00000E00000E00000E0000FFE000FFE000151D7F9319>
I<07F1800FF9801F1F803C0F807C0780780380F80380F00380F00380F00380F00380F00380F003
80F803807807807C07803C0F803E1F801FFB8007E3800003800003800003800003800003800003
80000380003FF8003FF8151D7E9318>I<0E7CFFFEFFDE0F9E0F1E0F000E000E000E000E000E00
0E000E000E000E000E000E000E00FFE0FFE00F147F9312>I<1FB07FF078F0E070E030E030F000
FC007FC03FE00FF000F8C078C038E038E038F078F8F0FFE0CFC00D147E9312>I<060006000600
06000E000E001E003E00FFF8FFF80E000E000E000E000E000E000E000E000E000E000E180E180E
180E180E180F3007F003E00D1C7F9B12>I<0E01C0FE1FC0FE1FC00E01C00E01C00E01C00E01C0
0E01C00E01C00E01C00E01C00E01C00E01C00E01C00E01C00E03C00E07C00F0FC007FDFC03F9FC
16147F9319>I<FF87F8FF87F81E03E00E01C00E01800E01800703000703000703000386000386
00038E0001CC0001CC0001FC0000F80000F80000700000700000700015147F9318>I<FF9FF3FC
FF9FF3FC1C07C0F01C0780E01C07C0E00E0FC0C00E0CC0C00E0CE0C0070CE18007186180071871
800398730003B0330003B0330003B03F0001F03E0001E01E0001E01E0000E01C0000C00C001E14
7F9321>I<7FC7FC7FC7FC0F03E007038003830001C70000EE0000EC00007800003800003C0000
7C0000EE0001C7000187000303800701C01F01E0FF87FEFF87FE1714809318>I<FF87F8FF87F8
1E03E00E01C00E01800E0180070300070300070300038600038600038E0001CC0001CC0001FC00
00F80000F80000700000700000700000600000600000600000C000F0C000F18000F380007F0000
3C0000151D7F9318>I<3FFF3FFF381F301E703C6078607860F001E003C003C007830F031E031E
073C067806F81EFFFEFFFE10147F9314>I<FFFFFCFFFFFC1602808C17>I
E /Fm 12 122 df<70F8F8F0F005057A840F>46 D<0000FE000007FFC0001F03E0007C00F000F0
007801E000380380001C0701F80C0E07FC0E0E1F1E0E1C3C0706187807C638F003C630E0038671
E0038661C0038661C0078EE3C0070CC380070CC380070CC3800F1CC3800E18C3801E18C3C03E38
C1C07E30C1F1EEE0E0FFCFE0E03F07807000000070000000380000001E0003E00F807FC007FFFC
0001FFC0001F2379A225>64 D<00F9C003FDC0078FC00F07C01E07801E07803C07807C07807807
00780700780F00F80F00F00E00F00E18F01E38F01E30F03C30707C7079FE603FCFE01F07C01515
7B9419>97 D<07C03FC03F800780078007800700070007000F000E000E000E001E001CF81FFC1F
9E3E0F3C0F3C0F380F780F700F700F701FF01EE01EE01EE03CE03CE07870F071E03FC01F001023
7BA216>I<007E0001FF8007C3800F07801E07801E07803C00003C0000780000780000780000F8
0000F00000F00000F00000F00300700700780E003C3C003FF8000FE00011157B9416>I<00007C
0003FC0003F80000780000780000780000700000700000F00000F00000E00000E00001E00001E0
00F9C003FDC0078FC00F07C01E07801E07803C07807C0780780700780700780F00F80F00F00E00
F00E18F01E38F01E30F03C30707C7079FE603FCFE01F07C016237BA219>I<01F807FE0F8E1E06
3C067806780EF83CFFF8FFC0F000F000E000E000E000E006E00EF01C78783FF01FC00F157A9416
>I<0078007800780070000000000000000000000000000000000F801FC039C031C071C061C0E3
C0038003800780070007000F000E181E381C301C301C701CE01FC00F800D217DA00F>105
D<0F07E0001F9FF0003BFC780031F8380061F0380061E03800E3C0780003C07000038070000380
70000780F0000780E0000700E0000701E1800F01C3800F01C3000E03C3000E0387001E03CE001E
01FC001C00F80019157D941B>110 D<00FE0003FF800783800F07800E07800E07800E03000F00
000FF0000FFC0003FE00007F00001F00000F00700F00F00E00F00E00E01E00F07C007FF8001FE0
0011157D9414>115 D<0780381FC0383CE07830E07870E07061E070E1C0F001C0F003C0E00380
E00381E00781E00701C00701C30703C70703C607038607078E079FCC03FDFC01F0F818157D941A
>117 D<07801C1FC01C3CE03C30E03870E03861E038E1C07801C07003C0700380700380F00780
E00700E00700E00701E00701C00703C00707C0078FC003FF8001FB800003800007800007003C0F
003C0E003C1E00383C0038F8003FE0001F8000161F7D9418>121 D E /Fn
39 122 df<0000C018000000C018000000C018000001C038000001803000000180300000018030
000003807000000300600000030060000003006000000700E000000600C000000600C000000600
C000000E01C000000C018000FFFFFFFFC0FFFFFFFFC00018030000001803000000180300000038
0700000030060000003006000000300600000030060000FFFFFFFFC0FFFFFFFFC000600C000000
E01C000000C018000000C018000000C018000001C0380000018030000001803000000180300000
03807000000300600000030060000003006000000700E000000600C000000600C00000222D7DA2
29>35 D<007000E001C001C0038007000E000E001C001C00380038003800700070007000700060
00E000E000E000E000E000E000E000E000E000E000E000E000E000E00060007000700070007000
3800380038001C001C000E000E000700038001C001C000E000700C327DA413>40
D<E0007000380038001C000E00070007000380038001C001C001C000E000E000E000E000600070
0070007000700070007000700070007000700070007000700070006000E000E000E000E001C001
C001C003800380070007000E001C00380038007000E0000C327DA413>I<70F8FCFC7C0C0C0C1C
18183870E0E0060F7C840E>44 D<70F8F8F87005057C840E>46 D<018003800F80FF80F3800380
038003800380038003800380038003800380038003800380038003800380038003800380038003
8003800380038003800380FFFEFFFE0F217CA018>49 D<03F8000FFE003C3F00380F807007C060
07C0E003E0F803E0F803E0F801E0F801E07003E00003E00003C00007C00007C0000F80000F0000
1E00003C0000780000F00000E00001C0000380000700600E00601C00603800E07000C0FFFFC0FF
FFC0FFFFC013217EA018>I<03F8000FFE001E1F00380F807007C07807C07C07C07807C07807C0
0007C00007C0000780000F80001F00003E0003FC0003F800001E00000F000007800007C00003E0
0003E07003E0F803E0F803E0F803E0F803E0E007C07007C0780F803E1F000FFE0003F80013227E
A018>I<1801801E07801FFF801FFF001FFC001FF0001800001800001800001800001800001800
0019F8001FFE001F0F001E07801C03C01803C00001C00001E00001E00001E00001E07001E0F001
E0F001E0F001E0E003C0E003C0700780380F803E1F000FFC0007F00013227EA018>53
D<007E0001FF8003C3C00703C00E03C01E03C03C03C0380000780000780000780000702000F3FC
00F7FF00FE0F80FC0780F803C0F803C0F801E0F001E0F001E0F001E0F001E0F001E07001E07001
E07801E07801C03803C03C03801E07800F1F0007FE0003F80013227EA018>I<03F8000FFC001F
1E003C07003807807803807003C0F003C0F001C0F001C0F001E0F001E0F001E0F001E0F001E0F0
03E07803E07803E03C07E03E0FE01FFDE007F9E00081E00001C00003C00003C000038078078078
0700780F00781E00787C003FF8000FE00013227EA018>57 D<000FF030007FFC3000FC1E7003F0
077007C003F00F8001F01F0001F01F0000F03E0000F03C0000707C0000707C0000707C000030F8
000030F8000030F8000000F8000000F8000000F8000000F8000000F8000000F8000000F8000030
7C0000307C0000307C0000303E0000703E0000601F0000E01F0000C00F8001C007C0038003F007
0000FC1E00007FFC00000FF0001C247DA223>67 D<FFFFF000FFFFFE0007801F00078007C00780
03C0078001E0078000F0078000F8078000780780007C0780003C0780003C0780003C0780003E07
80003E0780003E0780003E0780003E0780003E0780003E0780003E0780003E0780003C0780003C
0780007C0780007807800078078000F0078001E0078003E0078007C007801F00FFFFFE00FFFFF8
001F227EA125>I<FFFCFFFC078007800780078007800780078007800780078007800780078007
800780078007800780078007800780078007800780078007800780078007800780FFFCFFFC0E22
7EA112>73 D<03FFF003FFF0000F00000F00000F00000F00000F00000F00000F00000F00000F00
000F00000F00000F00000F00000F00000F00000F00000F00000F00000F00000F00000F00000F00
000F00000F00F80F00F80F00F80F00F81F00F01E00703E00787C003FF8000FE00014237EA119>
I<FFFC07FF00FFFC07FF00078003F800078001E000078003C0000780078000078007000007800E
000007801C0000078038000007807000000780E000000781C000000783C000000787C00000078F
E00000079DF0000007BDF0000007F8F8000007F078000007E07C000007C03E000007801E000007
801F000007800F800007800F8000078007C000078003E000078003E000078001F000078001F000
078001FC00FFFC07FF80FFFC07FF8021227EA126>I<FFFFE00000FFFFF8000007803E00000780
0F00000780078000078007C000078003E000078003E000078003E000078003E000078003E00007
8003E000078007C000078007800007800F000007803E000007FFF8000007FFF000000780F80000
07803C000007801E000007801E000007800F000007800F000007800F000007800F800007800F80
0007800F800007800F800007800F818007800FC180078007C380FFFC07E700FFFC03FF00000000
FE0021237EA124>82 D<07F0600FFE601E1FE03807E07003E07001E0E000E0E000E0E00060E000
60F00060F00000F800007C00007F00003FF0001FFE000FFF8003FFC0007FC00007E00001E00001
F00000F00000F0C00070C00070C00070E00070E000F0F000E0F801E0FC01C0FF0780C7FF00C1FC
0014247DA21B>I<7FFFFFF87FFFFFF87C0780F8700780386007801860078018E007801CC00780
0CC007800CC007800CC007800CC007800C00078000000780000007800000078000000780000007
800000078000000780000007800000078000000780000007800000078000000780000007800000
0780000007800000078000000780000007800003FFFF0003FFFF001E227EA123>I<FFFC0FFFFF
FC0FFF078001F80780006007800060078000600780006007800060078000600780006007800060
078000600780006007800060078000600780006007800060078000600780006007800060078000
600780006007800060078000600780006007800060078000E003C000C003C001C001E0018001E0
038000F80700007C1E00001FFC000007F00020237EA125>I<1FF0003FFC003C3E003C0F003C0F
00000700000700000F0003FF001FFF003F07007C0700F80700F80700F00718F00718F00F18F81F
187C3FB83FF3F01FC3C015157E9418>97 D<0E0000FE0000FE00001E00000E00000E00000E0000
0E00000E00000E00000E00000E00000E00000E00000E3FC00EFFE00FE1F00F80780F003C0E003C
0E001E0E001E0E001E0E001E0E001E0E001E0E001E0E001E0E003C0E003C0F007C0F80F80FE1F0
0CFFE00C3F8017237FA21B>I<03FE000FFF801F07803E07803C0780780000780000F00000F000
00F00000F00000F00000F00000F000007800007800C03C01C03E01801F87800FFF0003FC001215
7E9416>I<0000E0000FE0000FE00001E00000E00000E00000E00000E00000E00000E00000E000
00E00000E00000E003F8E00FFEE01F0FE03E03E07C01E07800E07800E0F000E0F000E0F000E0F0
00E0F000E0F000E0F000E07000E07801E07801E03C03E01F0FF00FFEFE03F0FE17237EA21B>I<
01FC0007FF001F0F803E03C03C01C07801E07801E0FFFFE0FFFFE0F00000F00000F00000F00000
F000007800007800603C00E03E01C00F83C007FF0001FC0013157F9416>I<0000F003FBF807FF
B80F1F381E0F003C07803C07803C07803C07803C07803C07803C07801E0F001F1E001FFC001BF8
001800001800001C00001FFF000FFFC03FFFF07C01F0700078F00078E00038E00038E00038F000
787800F03F07E01FFFC003FE0015217F9518>103 D<0E0000FE0000FE00001E00000E00000E00
000E00000E00000E00000E00000E00000E00000E00000E00000E3F800EFFE00FE1E00F80F00F00
700F00700E00700E00700E00700E00700E00700E00700E00700E00700E00700E00700E00700E00
700E0070FFE7FFFFE7FF18237FA21B>I<1C003E003E003E001C00000000000000000000000000
000000000E00FE00FE001E000E000E000E000E000E000E000E000E000E000E000E000E000E000E
000E00FFC0FFC00A227FA10E>I<0E00FE00FE001E000E000E000E000E000E000E000E000E000E
000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E000E00
0E00FFE0FFE00B237FA20E>108 D<0E3FC0FF00FEFFF3FFC0FFE0F783C01F807E01E00F003C00
E00F003C00E00E003800E00E003800E00E003800E00E003800E00E003800E00E003800E00E0038
00E00E003800E00E003800E00E003800E00E003800E00E003800E00E003800E0FFE3FF8FFEFFE3
FF8FFE27157F942A>I<0E3F80FEFFE0FFE1E01F80F00F00700F00700E00700E00700E00700E00
700E00700E00700E00700E00700E00700E00700E00700E00700E0070FFE7FFFFE7FF18157F941B
>I<01FC0007FF000F07801C01C03800E07800F0700070F00078F00078F00078F00078F00078F0
0078F000787000707800F03800E01C01C00F078007FF0001FC0015157F9418>I<0E3FC0FEFFE0
FFE1F00F80F80F007C0E003C0E003E0E001E0E001E0E001E0E001E0E001E0E001E0E003E0E003C
0E003C0F007C0F80F80FE1F00EFFE00E3F800E00000E00000E00000E00000E00000E00000E0000
0E0000FFE000FFE000171F7F941B>I<0E7EFEFFFFEF1F8F0F0F0F000F000E000E000E000E000E
000E000E000E000E000E000E000E00FFF0FFF010157F9413>114 D<1FD83FF87878F038E018E0
18F018F8007F807FE01FF003F8007CC03CC01CE01CE01CF03CF878FFF0CFE00E157E9413>I<06
0006000600060006000E000E000E001E003E00FFF8FFF80E000E000E000E000E000E000E000E00
0E000E000E0C0E0C0E0C0E0C0E0C0F1C073807F803E00E1F7F9E13>I<0E0070FE07F0FE07F01E
00F00E00700E00700E00700E00700E00700E00700E00700E00700E00700E00700E00700E00F00E
00F00E01F00787F807FF7F01FC7F18157F941B>I<FFC3FEFFC3FE1E00F80E00700E00E00700C0
0700C00700C003818003818003C38001C30001C30000E60000E60000E600007C00007C00007C00
00380000380017157F941A>I<FFC3FEFFC3FE1E00F80E00700E00E00700C00700C00700C00381
8003818003C38001C30001C30000E60000E60000E600007C00007C00007C000038000038000030
00003000007000006000006000F0C000F1C000F380007F00003E0000171F7F941A>121
D E /Fo 21 122 df<FFFF80FFFF80FFFF8011037F9016>45 D<00003FE0030001FFFC030007F0
1E07001F800787003E0001CF00FC0000EF01F800007F03F000007F03E000003F07C000001F0FC0
00001F0F8000000F1F8000000F3F000000073F000000073E000000077E000000077E000000037E
000000037C00000003FC00000000FC00000000FC00000000FC00000000FC00000000FC00000000
FC00000000FC00000000FC00000000FC00000000FC000000007C000000007E000000037E000000
037E000000033E000000033F000000073F000000061F800000060F8000000E0FC000000C07C000
001C03E000001803F000003801F800007000FC0000E0003F0001C0001F8007800007F01F000001
FFFC0000003FE00028337CB130>67 D<FFFF807FFFC0FFFF807FFFC007F00003F80003E00001F0
0003E00001F00003E00001F00003E00001F00003E00001F00003E00001F00003E00001F00003E0
0001F00003E00001F00003E00001F00003E00001F00003E00001F00003E00001F00003E00001F0
0003E00001F00003E00001F00003E00001F00003E00001F00003E00001F00003E00001F00003FF
FFFFF00003FFFFFFF00003E00001F00003E00001F00003E00001F00003E00001F00003E00001F0
0003E00001F00003E00001F00003E00001F00003E00001F00003E00001F00003E00001F00003E0
0001F00003E00001F00003E00001F00003E00001F00003E00001F00003E00001F00003E00001F0
0003E00001F00003E00001F00003E00001F00007F00003F800FFFF807FFFC0FFFF807FFFC02A31
7CB032>72 D<FFF00000007FF8FFF8000000FFF807F8000000FF0003F8000000FE00037C000001
BE00037C000001BE00037C000001BE00033E0000033E00033E0000033E00033E0000033E00031F
0000063E00031F0000063E00031F0000063E00030F80000C3E00030F80000C3E00030F80000C3E
000307C000183E000307C000183E000307C000183E000303E000303E000303E000303E000303E0
00303E000301F000603E000301F000603E000301F000C03E000300F800C03E000300F800C03E00
03007C01803E0003007C01803E0003007C01803E0003003E03003E0003003E03003E0003003E03
003E0003001F06003E0003001F06003E0003001F06003E0003000F8C003E0003000F8C003E0003
000F8C003E00030007D8003E00030007D8003E00030007D8003E00030003F0003E00030003F000
3E00030003F0003E00078001E0003E000FC001E0007F00FFFC01E00FFFF8FFFC00C00FFFF83531
7CB03D>77 D<007F806003FFF06007C0F8E00F003CE01E000FE03C0007E03C0003E0780003E078
0001E0F00001E0F00000E0F00000E0F00000E0F0000060F8000060F8000060F80000007C000000
7E0000007F0000003FC000001FFC00001FFFC0000FFFF80003FFFE0000FFFF00001FFF800001FF
C000001FE0000007E0000003F0000001F0000001F8000000F8000000F8C0000078C0000078C000
0078C0000078E0000078E0000078E0000070F00000F0F00000F0F80001E0FC0001E0FF0003C0E7
800F80E3F01F00C0FFFC00C01FF0001D337CB125>83 D<FFFE003FFF8007FFC0FFFE003FFF8007
FFC00FE00003F80000FE0007E00001F800007C0007C00001F00000380003E00000F80000380003
E00000F80000300003E00000F80000300001F00001FC0000600001F00001FC0000600001F00001
FC0000600001F80001FC0000E00000F800033E0000C00000F800033E0000C00000F800033E0000
C000007C00061F00018000007C00061F00018000007C00061F00018000003E000E1F8003000000
3E000C0F80030000003E000C0F80030000003F000C0F80070000001F001807C0060000001F0018
07C0060000001F001807C0060000000F803003E00C0000000F803003E00C0000000F803003E00C
00000007C07003F01800000007C06001F01800000007C06001F01800000007E06001F038000000
03E0C000F83000000003E0C000F83000000003E0C000F83000000001F180007C6000000001F180
007C6000000001F180007C6000000000FB80007EC000000000FB00003EC000000000FB00003EC0
00000000FF00003FC0000000007E00001F80000000007E00001F80000000007E00001F80000000
003C00000F00000000003C00000F00000000003C00000F00000000001C00000E00000000001800
000600000042327FB044>87 D<03FF00000FFFC0001E03F0003E00F8003E007C003E003C003E00
3E001C001E0000001E0000001E0000001E0000001E000003FE00007FFE0003FF1E0007F01E001F
C01E003F001E007E001E007C001E00FC001E00F8001E0CF8001E0CF8001E0CF8003E0CFC007E0C
7C007E0C7E01FF1C3F87CFB81FFF07F003FC03C01E1F7D9E21>97 D<003FE001FFF803E03C07C0
3E0F003E1F003E3E003E3C001C7C00007C0000780000F80000F80000F80000F80000F80000F800
00F80000F80000F800007C00007C00007C00003E00033E00071F00060F800E07C01C03F07801FF
F0003F80181F7D9E1D>99 D<003F800001FFF00003E1F80007807C000F003E001E001E003E001F
003C000F007C000F807C000F8078000F80F8000780FFFFFF80FFFFFF80F8000000F8000000F800
0000F8000000F8000000F80000007C0000007C0000007C0000003E0001803E0003801F0003000F
80070007E00E0003F83C0000FFF800003FC000191F7E9E1D>101 D<000001F8007F07FC01FFCF
1C07E3FC3C0F80F81C0F0078001F007C001E003C003E003E003E003E003E003E003E003E003E00
3E003E003E003E003E001E003C001F007C000F0078000F80F8000FE3F0000DFFC0001C7F00001C
0000001C0000001C0000001E0000001F0000000FFFF8000FFFFF0007FFFFC00FFFFFE03E000FF0
7C0001F0780000F0F0000078E0000038E0000038E0000038E0000038F000007870000070780000
F03C0001E01F0007C00FE03F8003FFFE00007FF0001E2F7E9F21>103 D<0780000000FF800000
00FF800000000F8000000007800000000780000000078000000007800000000780000000078000
000007800000000780000000078000000007800000000780000000078000000007800000000780
00000007800000000781FE00000787FF8000079E0FC00007B803E00007F001E00007E001F00007
E000F00007C000F00007C000F000078000F000078000F000078000F000078000F000078000F000
078000F000078000F000078000F000078000F000078000F000078000F000078000F000078000F0
00078000F000078000F000078000F000078000F000078000F000078000F0000FC001F800FFFC1F
FF80FFFC1FFF8021327EB125>I<0F001F801F801F801F800F0000000000000000000000000000
0000000000000000000780FF80FF800F8007800780078007800780078007800780078007800780
07800780078007800780078007800780078007800780078007800FC0FFF8FFF80D307EAF12>I<
0781FE003FC000FF87FF80FFF000FF9E0FC3C1F8000FB803E7007C0007F001EE003C0007E001FC
003E0007E000FC001E0007C000F8001E0007C000F8001E00078000F0001E00078000F0001E0007
8000F0001E00078000F0001E00078000F0001E00078000F0001E00078000F0001E00078000F000
1E00078000F0001E00078000F0001E00078000F0001E00078000F0001E00078000F0001E000780
00F0001E00078000F0001E00078000F0001E00078000F0001E00078000F0001E00078000F0001E
000FC001F8003F00FFFC1FFF83FFF0FFFC1FFF83FFF0341F7E9E38>109
D<0781FE0000FF87FF8000FF9E0FC0000FB803E00007F001E00007E001F00007E000F00007C000
F00007C000F000078000F000078000F000078000F000078000F000078000F000078000F0000780
00F000078000F000078000F000078000F000078000F000078000F000078000F000078000F00007
8000F000078000F000078000F000078000F000078000F0000FC001F800FFFC1FFF80FFFC1FFF80
211F7E9E25>I<001FC00000FFF80001E03C0007800F000F0007801E0003C01E0003C03C0001E0
3C0001E0780000F0780000F0780000F0F80000F8F80000F8F80000F8F80000F8F80000F8F80000
F8F80000F8F80000F8780000F07C0001F03C0001E03C0001E01E0003C01E0003C00F00078007C0
1F0001F07C0000FFF800001FC0001D1F7E9E21>I<0787F0FF8FF8FFBC7C0FB87C07F07C07E07C
07E00007C00007C00007C000078000078000078000078000078000078000078000078000078000
0780000780000780000780000780000780000780000780000780000FC000FFFE00FFFE00161F7E
9E19>114 D<03FE300FFFF03E07F07801F07000F0E00070E00070E00030E00030F00030F80000
7F00007FF0003FFF000FFFC003FFE0003FF00003F80000F8C0007CC0003CE0001CE0001CE0001C
F0001CF80038F80038FC00F0EF03F0C7FFC0C1FF00161F7E9E1A>I<00C00000C00000C00000C0
0000C00001C00001C00001C00003C00003C00007C0000FC0001FC000FFFFE0FFFFE003C00003C0
0003C00003C00003C00003C00003C00003C00003C00003C00003C00003C00003C00003C00003C0
0003C00003C03003C03003C03003C03003C03003C03003C03003C07001E06001E0E000F9C000FF
C0003F00142C7FAB19>I<FFF07FF81FFCFFF07FF81FFC0FC007C007F00F8003C003C0078003C0
03C0078003C0018007C007C0038003C007E0030003C007E0030003C00CE0030001E00CF0060001
E00CF0060001E01870060000F018780C0000F018780C0000F030380C000078303C18000078303C
18000078601C1800003C601E3000003C601E3000003CC00E3000001EC00F6000001EC00F600000
1FC00F6000000F8007C000000F8007C000000F8007C00000070003800000070003800000070003
80002E1F7F9E30>119 D<FFF807FF00FFF807FF000FE003F80007E003E00003E003C00001E003
800000F00700000078060000007C0C0000003C1C0000001E380000000F300000000FE000000007
E000000003C000000003E000000003F000000007F00000000E780000000C7C000000183E000000
381E000000700F000000600F800000C007C00001C003C00003C001E00007C001F0001FC003F800
FFE007FFC0FFE007FFC0221F7F9E23>I<FFF803FF80FFF803FF800FC000FC0007800078000780
00700003C000700003C000600003E000E00001E000C00001E000C00000F001800000F001800000
F801800000780300000078030000007C070000003C060000003C060000001E0C0000001E0C0000
001F1C0000000F180000000F1800000007B000000007B000000007B000000003E000000003E000
000003E000000001C000000001C000000001800000000180000000038000000003000000000300
000000060000000006000000700E000000F80C000000F81C000000F83800000070700000003FE0
0000001F80000000212D7F9E23>I E end
%%EndProlog
%%BeginSetup
%%Feature: *Resolution 300
TeXDict begin 
%%EndSetup
%%Page: 0 1
bop 196 721 a Fo(W)-6 b(riting)23 b(Hygienic)e(Macros)h(in)f(Sc)n(heme)g
(with)g(Syn)n(tax-Case)806 877 y Fn(R.)15 b(Ken)o(t)h(Dyb)o(vig)770
933 y Fm(dyb@cs.indiana.e)n(du)441 1089 y Fn(Indiana)g(Univ)o(ersit)o(y)e
(Computer)h(Science)g(Departmen)o(t)727 1146 y(T)l(ec)o(hnical)g(Rep)q(ort)i
(#356)868 1302 y(June)f(1992)736 1358 y(\(Revised)f(July)h(3,)g(1992\))627
2645 y Fl(Cop)o(yrigh)o(t)853 2644 y(c)841 2645 y Fk(\015)e
Fl(1992)g(R.)g(Ken)o(t)i(Dyb)o(vig)p eop
%%Page: 1 2
bop 0 49 a Fj(1)69 b(Preface)0 151 y Fl(This)15 b(rep)q(ort)f(is)h(dedicated)
h(to)e(m)o(y)g(go)q(o)q(d)g(friend)i(and)f(colleague,)g(Bob)g(Hieb,)g(who)f
(w)o(as)g(killed)j(along)d(with)h(his)0 207 y(elev)o(en-y)o(ear)i(old)g
(daugh)o(ter)f(Iv)m(a)h(in)g(a)f(tragic)g(car)g(acciden)o(t)h(near)g(their)f
(home)h(on)f(April)i(30,)d(1992.)22 b(Bob)17 b(and)0 264 y(I)e(w)o(ork)o(ed)f
(on)h(the)g(macro)f(system)h(describ)q(ed)i(herein)f(for)e(sev)o(eral)h(y)o
(ears,)f(and)h(man)o(y)g(of)f(the)h(most)f(imp)q(ortan)o(t)0
320 y(concepts)i(and)f(algorithms)g(w)o(ere)g(dev)o(elop)q(ed)i(b)o(y)e(Bob,)
g(who)g(had)g(adopted)h(it)f(as)g(his)h(dissertation)f(pro)s(ject.)71
377 y(This)h(rep)q(ort)g(is)h(in)o(tended)g(not)f(to)f(justify)i(the)f(macro)
f(system,)h(but)g(to)f(help)j(p)q(oten)o(tial)f(users)f(learn)g(ho)o(w)0
433 y(to)g(write)h(macros)f(using)h(it.)25 b(A)16 b(companion)i(rep)q(ort,)e
(\\Syn)o(tactic)h(Abstraction)f(in)i(Sc)o(heme")f([4)o(],)f(whic)o(h)i(w)o
(as)0 489 y(mostly)13 b(written)h(b)q(efore)f(Bob's)g(death,)h(do)q(es)g
(attempt)e(to)h(justify)g(the)h(macro)e(system)h(and)h(to)f(place)h(it)g
(within)0 546 y(the)g(con)o(text)g(of)f(other)h(w)o(ork.)19
b(The)14 b(companion)h(rep)q(ort)f(also)g(con)o(tains)g(more)g(detail)h(on)f
(the)g(algorithms)g(used)0 602 y(b)o(y)h(our)g(implemen)o(tation)i(of)d(the)i
(macro)e(system.)71 659 y(A)k(complete)i(implemen)o(tation)f(of)g(the)f
(macro)g(system)g(is)i(a)o(v)m(ailable,)g(and)f(should)h(run)f(in)g(an)o(y)f
(Sc)o(heme)0 715 y(system)i(with)g(the)g(pro)o(vision)h(of)f(a)g(few)g
(implemen)o(tation-dep)q(enden)o(t)j(\\ho)q(oks.")34 b(It)20
b(can)g(b)q(e)h(obtained)g(via)0 772 y(\\anon)o(ymous)12 b(ftp")g(from)f
Fi(iuvax.cs.indiana.e)n(du)16 b Fl(in)d(the)g(directory)f Fi
(pub/scheme/syntax-c)n(ase)p Fl(.)19 b(If)13 b(y)o(ou)f(do)g(not)0
828 y(ha)o(v)o(e)f(ftp)h(access,)g(con)o(tact)f(me)h(and)g(I)h(will)g(get)f
(the)g(implemen)o(tation)h(to)e(y)o(ou)h(someho)o(w.)18 b(The)12
b(implemen)o(tation)0 885 y(is)17 b(based)g(on)f(an)h(earlier)g(implemen)o
(tation)h(b)o(y)e(Bob)h(and)g(m)o(yself)f(of)g(the)h(system)f(describ)q(ed)i
(in)g(an)e(app)q(endix)0 941 y(to)g(the)g(\\Revised)312 925
y Fh(4)348 941 y Fl(Rep)q(ort)f(on)i(the)f(Algorithmic)h(Language)f(Sc)o
(heme")h([2)o(].)22 b(The)17 b(presen)o(t)f(implemen)o(tation,)0
998 y(ho)o(w)o(ev)o(er,)e(is)i(more)e(robust)h(and)h(signi\014can)o(tly)g
(more)f(e\016cien)o(t.)71 1054 y(I)j(w)o(ould)g(lik)o(e)g(to)f(thank)h(Carl)f
(Bruggeman)h(for)f(his)h(detailed)h(and)f(though)o(tful)g(commen)o(ts)f(on)h
(drafts)e(of)0 1110 y(this)f(rep)q(ort,)e(and)i(also)f(for)g(the)g(use)g(of)g
(his)h(\\Sc)o(heme)g(T)l(eXer,")f(with)h(whic)o(h)g(the)f(examples)h(con)o
(tained)g(within)0 1167 y(this)g(rep)q(ort)g(w)o(ere)g(formatted.)k(I)c(w)o
(ould)g(lik)o(e)i(to)d(thank)h(Da)o(vid)g(Eb)o(y)l(,)g(George)f(Springer,)h
(and)h(Dan)e(F)l(riedman)0 1223 y(as)h(w)o(ell)h(for)f(their)g(helpful)j
(commen)o(ts.)0 1367 y Fj(2)69 b(In)n(tro)r(duction)0 1468
y Fl(This)13 b(do)q(cumen)o(t)g(describ)q(es)h(a)e(h)o(ygienic)i(macro)d
(system)h(for)g(Sc)o(heme)h(that)f(is)h(similar)g(to)f(the)h(one)f(do)q
(cumen)o(ted)0 1525 y(in)19 b(an)f(app)q(endix)i(to)d(the)h(\\Revised)637
1508 y Fh(4)676 1525 y Fl(Rep)q(ort)f(on)h(the)g(Algorithmic)h(Language)g(Sc)
o(heme")f([2)o(],)g(with)h(sev)o(eral)0 1581 y(imp)q(ortan)o(t)e
(di\013erences.)27 b(Most)17 b(imp)q(ortan)o(tly)l(,)h(there)f(is)h(no)f
(practical)i(distinction)g(in)f(this)g(system)f(b)q(et)o(w)o(een)0
1637 y(\\high)h(lev)o(el")g(and)f(\\lo)o(w)f(lev)o(el")j(macros.)24
b(Although)18 b(some)e(macros)h(will)h(not)f(tak)o(e)f(adv)m(an)o(tage)h(of)f
(the)h(more)0 1694 y(primitiv)o(e)k(op)q(erators,)e(there)g(is)h(no)g(p)q
(enalt)o(y)g(in)g(terms)f(of)g(loss)g(of)g(automatic)g(h)o(ygiene,)i(referen)
o(tial)f(trans-)0 1750 y(parency)l(,)14 b(or)e(ease-of-use)h(for)g(those)g
(macros)f(that)g(do.)19 b(In)14 b(particular,)g(the)f(same)f(pattern)h(matc)o
(hing)g(facilities)0 1807 y(that)i(w)o(ere)g(previously)i(a)o(v)m(ailable)g
(only)f(to)e(high-lev)o(el)k(macros)d(can)g(no)o(w)g(b)q(e)h(used)g(in)h(an)o
(y)e(con)o(text.)20 b(There)15 b(is)0 1863 y(nev)o(er)e(an)o(y)f(need)i(to)e
(completely)i(rewrite)f(a)g(macro)f(originally)i(written)f(in)g(a)g(high-lev)
o(el)i(st)o(yle)e(simply)h(b)q(ecause)0 1920 y(it)19 b(no)o(w)g(requires)g
(access)g(to)g(some)f(more)h(primitiv)o(e)h(feature.)31 b(F)l(urthermore,)19
b(there)g(is)g(nev)o(er)g(an)o(y)g(need)h(to)0 1976 y(explicitly)e
(manipulate)e(syn)o(tactic)g(en)o(vironmen)o(ts)f(of)g(an)o(y)g(kind.)71
2033 y(The)e(macro)f(system)g(consists)h(of)f(a)h(set)g(of)f(de\014ning)i
(forms,)e(a)h(set)f(of)h(forms)f(for)g(taking)h(apart)f(and)h(putting)0
2089 y(together)h(syn)o(tax,)f(and)i(a)f(set)h(of)f(primitiv)o(es)i(for)e
(manipulating)i(and)f(comparing)f(iden)o(ti\014ers.)22 b(The)14
b(system)g(is)0 2146 y(based)i(on)f(a)h(represen)o(tation)f(of)g(expressions)
i(as)e(abstract)f(ob)s(jects)h(that)g(are)g(di\013eren)o(t)h(from)f(the)h
(commonly)0 2202 y(used)e(Sc)o(heme)g Fk(h)p Fl(datum)p Fk(i)e
Fl(represen)o(tations.)19 b(Macro)12 b(transformers)g(tak)o(e)h(syn)o(tax)f
(ob)s(jects)h(as)f(input)j(and)e(return)0 2258 y(\(expanded\))g(syn)o(tax)e
(ob)s(jects)h(as)g(output.)19 b(Em)o(b)q(edded)13 b(within)h(eac)o(h)e(syn)o
(tax)g(ob)s(ject)g(is)h(su\016cien)o(t)g(information)0 2315
y(to)d(determine)i(the)f(bindings)i(of)d(all)i(iden)o(ti\014ers)h(con)o
(tained)e(within)h(the)f(syn)o(tax)f(ob)s(ject,)h(along)g(with)g(an)g(in)o
(ternal)0 2371 y(represen)o(tation)18 b(of)f(the)g(syn)o(tactic)h(form)f
(itself.)27 b(Other)18 b(implemen)o(tation-dep)q(ende)q(n)o(t)i(information)d
(ma)o(y)g(b)q(e)0 2428 y(con)o(tained)e(within)h(a)e(syn)o(tax)f(ob)s(ject;)h
(for)g(example,)h(the)f(p)q(osition)i(of)e(the)g(expression)i(in)f(the)f
(original)i(source)0 2484 y(co)q(de)g(ma)o(y)e(b)q(e)i(included)i(for)d
(debugging)h(purp)q(oses.)71 2541 y(The)k(next)h(section)g(of)f(this)g(do)q
(cumen)o(t)h(attempts)f(to)f(clearly)j(de\014ne)f(the)g(terminology)f(used)h
(and)g(the)0 2597 y(syn)o(tactic)16 b(forms)g(and)h(primitiv)o(e)h(op)q
(erators)d(supplied)k(b)o(y)e(the)f(macro)g(system)g(\(Section)h(3\).)23
b(The)17 b(follo)o(wing)0 2654 y(section)j(demonstrates)e(through)h(a)f
(series)i(of)f(examples)h(ho)o(w)e(easy)h(it)g(is)h(to)e(write)i(macros,)f
(ranging)g(from)964 2828 y(1)p eop
%%Page: 2 3
bop 0 49 a Fl(simple)22 b(to)f(complex,)h(using)g(this)f(system)g(\(Section)g
(4\).)37 b(Although)21 b(this)h(is)f(not)f(in)o(tended)j(to)d(serv)o(e)h(as)f
(a)0 106 y(complete)15 b(implemen)o(tors')f(guide,)h(a)f(theory)g(of)g(op)q
(eration)g(is)h(giv)o(en)g(to)e(help)j(macro)d(writers)h(understand)h(the)0
162 y(expansion)h(pro)q(cess)g(\(Section)f(5\).)71 219 y(In)20
b(order)g(to)g(fully)i(understand)e(the)h(examples)g(in)g(this)f(do)q(cumen)o
(t,)i(it)e(is)h(necessary)g(to)e(ha)o(v)o(e)h(a)g(go)q(o)q(d)0
275 y(understanding)13 b(of)f(Sc)o(heme,)h(and)f(helpful)i(but)f(not)e
(necessary)i(to)e(ha)o(v)o(e)h(studied)h(or)f(used)g Fg(extend-syn)o(tax)g
Fl([5)o(,)0 332 y(3])j(or)f(the)h(high-lev)o(el)j(system)d(do)q(cumen)o(ted)h
(in)g(the)f(Revised)1079 315 y Fh(4)1115 332 y Fl(Rep)q(ort.)71
388 y(This)20 b(do)q(cumen)o(t)g(is)h(in)o(tended)g(to)e(instruct)h(p)q(oten)
o(tial)h(macro-system)e(users)h(ho)o(w)f(to)h(use)g(the)g(system;)0
444 y(there)14 b(is)h(no)g(attempt)e(at)h(justi\014cation)h(or)f(comparison)g
(with)h(other)f(systems.)19 b(A)14 b(more)g(formal)g(treatmen)o(t)f(of)0
501 y(this)18 b(macro)e(system)h(and)g(its)g(implemen)o(tation,)i(along)e
(with)g(bac)o(kground)g(information)g(on)h(this)f(and)g(other)0
557 y(macro)d(systems)h(is)h(giv)o(en)g(in)g([4)o(].)0 701
y Fj(3)69 b(Syn)n(tactic)22 b(forms)h(and)h(primiti)o(v)n(es)0
802 y Fl(New)14 b(macros)g(are)g(de\014ned)i(to)d(extend)i(the)f(set)h(of)e
(syn)o(tactic)i(forms)e(a)o(v)m(ailable)j(within)g(a)e(program)f(or)h
(subpro-)0 858 y(gram.)19 b(All)d(extended)h(syn)o(tactic)e(forms,)f(also)h
(referred)g(to)g(as)g(\\macro)f(calls,")h(tak)o(e)g(the)g(form:)72
958 y(\()q Fi(keywor)n(d)h(.)g(subform)5 b Fl(\))0 1052 y(where)17
b Fi(keywor)n(d)23 b Fl(is)17 b(an)g(iden)o(ti\014er)i(that)e(names)g(a)g
(macro.)25 b(The)17 b(syn)o(tax)g(of)g Fi(subform)k Fl(is)c(determined)i(b)o
(y)e(the)0 1108 y(macro)k(and)g(can)h(v)m(ary)f(signi\014can)o(tly)i(from)e
(macro)g(to)f(macro.)38 b(The)22 b(mec)o(hanisms)g(for)f(establishing)i(new)0
1165 y(k)o(eyw)o(ord)14 b(bindings)j(and)e(for)f(writing)h(macros)f(are)h
(describ)q(ed)h(in)g(the)f(remainder)h(of)e(this)h(section.)20
b(Extensiv)o(e)0 1221 y(examples)e(demonstrating)f(the)h(use)g(of)f(eac)o(h)g
(of)g(the)h(features)f(describ)q(ed)i(in)g(this)e(section)h(are)g(giv)o(en)g
(in)g(the)0 1278 y(follo)o(wing)e(section.)71 1334 y(Macros)j(de\014ned)j
(using)g(these)f(facilities)h(are)f(automatically)g Fi(hygienic)i
Fl([6)o(].)36 b(If)21 b(a)f(macro)g(transformer)0 1391 y(inserts)f(a)g
(binding)i(for)d(an)h(iden)o(ti\014er)h(\(v)m(ariable)g(or)e(k)o(eyw)o
(ord\),)h(the)g(new)g(binding)h(will)h(not)d(capture)h(other)0
1447 y(iden)o(ti\014ers)e(\(ev)o(en)e(of)g(the)g(same)g(name\))g(in)o(tro)q
(duced)h(elsewhere.)22 b(Macros)14 b(de\014ned)j(using)e(these)h(facilities)h
(are)0 1504 y(also)c Fi(r)n(efer)n(ential)r(ly)g(tr)n(ansp)n(ar)n(ent)k
Fl([1)o(].)i(If)13 b(a)g(macro)g(transformer)f(inserts)h(a)g(free)g
(reference)h(to)f(an)g(iden)o(ti\014er,)i(the)0 1560 y(reference)d(refers)f
(to)f(the)h(binding)i(that)e(w)o(as)f(visible)j(where)f(the)f(transformer)e
(w)o(as)i(sp)q(eci\014ed,)i(regardless)f(of)e(an)o(y)0 1616
y(lo)q(cal)16 b(bindings)h(that)d(ma)o(y)g(surround)h(the)g(use)g(of)g(the)f
(macro.)20 b(In)15 b(order)g(to)f(main)o(tain)h(these)g(t)o(w)o(o)f(prop)q
(erties,)0 1673 y(b)q(ound)i(iden)o(ti\014ers)g(in)o(tro)q(duced)g(b)o(y)f
(macros)f(are)g(renamed,)h(at)f(least)h(in)g(e\013ect,)f(to)h(a)o(v)o(oid)f
(p)q(oten)o(tial)i(con\015icts.)71 1729 y(Although)11 b(this)h(is)g(almost)e
(alw)o(a)o(ys)h(the)g(desired)h(b)q(eha)o(vior,)g(it)g(is)f(sometimes)h
(desirable)g(to)f(insert)g(iden)o(ti\014ers)0 1786 y(in)o(to)i(the)h(output)f
(of)g(a)g(macro)g(that)g(b)q(eha)o(v)o(e)h(as)f(if)h(they)f(had)h(b)q(een)g
(presen)o(t)g(in)g(the)g(original)g(expression.)21 b(That)0
1842 y(is,)g(it)e(is)h(sometimes)f(desirable)i(for)e(inserted)h(iden)o
(ti\014ers)h(to)e(b)q(e)h(b)q(ound)g(\(captured\))f(b)o(y)h(existing)g
(bindings)0 1899 y(or)f(for)g(inserted)i(bindings)g(to)e(bind)i(\(capture\))f
(existing)g(references.)34 b(A)20 b(mec)o(hanism)g(for)f(doing)i(this)f(in)g
(a)0 1955 y(con)o(trolled,)c(h)o(ygiene-preserving)h(manner)e(is)h(describ)q
(ed)h(at)d(the)i(end)g(of)e(this)i(section.)71 2012 y(New)e(syn)o(tactic)g
(forms)f(are)g(de\014ned)j(b)o(y)d(asso)q(ciating)i(an)f(iden)o(ti\014er,)h
(or)f Fi(keywor)n(d)5 b Fl(,)13 b(with)i(a)e(transformation)0
2068 y(pro)q(cedure,)j(or)e Fi(tr)n(ansformer)5 b Fl(.)20 b(A)o(t)15
b(top)g(lev)o(el,)h(syn)o(tactic)f(de\014nitions)i(tak)o(e)d(the)i(form)e
(of:)72 2168 y(\()q Fg(de\014ne-syn)o(tax)j Fi(keywor)n(d)f(tr)n
(ansformer-expr)n(ession)5 b Fl(\))0 2262 y(The)21 b Fi(tr)n(ansformer-expr)n
(ession)g Fl(m)o(ust)f(b)q(e)i(an)f(expression)i(that)d(ev)m(aluates)i(to)f
(a)g(transformer.)36 b(When)22 b(the)0 2318 y(expander)13 b(encoun)o(ters)g
(an)g(expression)h(of)e(the)h(form)g(\()q Fi(keywor)n(d)k(.)f(subform)5
b Fl(\))q(,)13 b(the)g(expression)g(is)h(passed)f(to)f(the)0
2374 y(asso)q(ciated)18 b(transformer)e(for)h(pro)q(cessing.)27
b(The)18 b(scop)q(e)g(of)f(syn)o(tactic)g(de\014nitions)j(can)d(b)q(e)h
(limited)i(b)o(y)d(using)0 2431 y(one)e(of)g(the)g(lexical)j(binding)f
(forms:)964 2828 y(2)p eop
%%Page: 3 4
bop 72 49 a Fl(\()q Fg(let-syn)o(tax)18 b Fl(\()r(\()q Fi(keywor)n(d)f(tr)n
(ansformer-expr)n(ession)5 b Fl(\))22 b Ff(:)8 b(:)g(:)f Fl(\))122
106 y Fi(b)n(o)n(dy)e Fl(\))72 219 y(\()q Fg(letrec-syn)o(tax)18
b Fl(\()r(\()q Fi(keywor)n(d)f(tr)n(ansformer-expr)n(ession)5
b Fl(\))22 b Ff(:)8 b(:)g(:)f Fl(\))122 275 y Fi(b)n(o)n(dy)e
Fl(\))0 369 y(In)17 b(b)q(oth)g(of)e(these)i(forms)f(the)g
Fi(keywor)n(d)h Fl(denotes)f(new)h(syn)o(tax)f(in)h Fi(b)n(o)n(dy)p
Fl(;)f(in)i(the)e(case)g(of)g Fg(letrec-syn)o(tax)h Fl(the)0
425 y(binding)g(scop)q(e)f(also)f(includes)j(eac)o(h)d Fi(tr)n
(ansformer-expr)n(ession)o Fl(.)71 482 y(Lexical)h(macro)f(k)o(eyw)o(ord)f
(bindings,)j(ordinary)e(lexical)j(v)m(ariable)e(bindings,)h(and)e(pattern)g
(v)m(ariable)h(bind-)0 538 y(ings)d(\(in)o(tro)q(duced)g(b)q(elo)o(w\))f(can)
h(shado)o(w)e(eac)o(h)i(other,)f(and)g(an)o(y)g(lexical)i(binding)g(shado)o
(ws)e(a)g(top-lev)o(el)h(binding)0 595 y(for)i(the)h(same)f(iden)o(ti\014er.)
23 b(An)o(y)16 b Fg(de\014ne-syn)o(tax)f Fl(forms)g(app)q(earing)i(within)g
(the)e(de\014nitions)j(at)d(the)h(fron)o(t)e(of)0 651 y(a)h
Fg(lam)o(b)q(da)h Fl(b)q(o)q(dy)g(\(or)e(other)h(similar)h(b)q(o)q(dy\))g
(are)f(treated)g(as)f Fg(letrec-syn)o(tax)i Fl(bindings.)71
708 y(Macro)i(transformers)f(are)i(pro)q(cedures)h(of)f(one)g(argumen)o(t.)31
b(The)19 b(argumen)o(t)g(to)f(a)h(macro)f(transformer)0 764
y(is)i(a)e Fi(syntax)i(obje)n(ct)t Fl(,)f(whic)o(h)h(con)o(tains)f(con)o
(textual)g(information)h(ab)q(out)e(an)h(expression)h(in)g(addition)g(to)f
(its)0 821 y(structure.)j(This)17 b(con)o(textual)f(information)g(enables)h
(the)f(macro)g(system)f(to)h(determine,)h(for)e(eac)o(h)h(iden)o(ti\014er)0
877 y(con)o(tained)e(within)g(the)f(expression,)h(to)f(whic)o(h)h(binding)h
(the)e(iden)o(ti\014er)h(refers.)19 b(This)14 b(information)f(is)h(required)0
933 y(to)h(main)o(tain)h(h)o(ygiene)h(and)f(referen)o(tial)g(transparency)l
(.)21 b(This)c(same)e(information)h(also)g(allo)o(ws)f(macro)g(trans-)0
990 y(formers)f(to)g(compare)h(iden)o(ti\014ers)i(according)e(to)f(their)i
(in)o(tended)g(use)f(as)g(free)g(iden)o(ti\014ers,)h(b)q(ound)g(iden)o
(ti\014ers,)0 1046 y(or)c(data.)19 b(Syn)o(tax)12 b(ob)s(jects)g(ma)o(y)g
(con)o(tain)g(other)h(syn)o(tactic)f(information)h(that)f(is)h(not)g(of)f
(direct)h(in)o(terest)g(to)f(the)0 1103 y(macro)h(writer.)19
b(F)l(or)13 b(example,)h(syn)o(tax)f(ob)s(jects)g(can)h(con)o(tain)g(source)f
(annotations)g(that)g(allo)o(w)h(the)g(ev)m(aluator)0 1159
y(to)h(correlate)g(the)g(\014nal)h(ob)s(ject)f(co)q(de)g(with)h(the)f(source)
g(co)q(de)h(that)f(pro)q(duced)h(it.)71 1216 y(The)e(output)g(from)g(a)g
(transformer)f(ma)o(y)h(itself)h(b)q(e)g(a)f(macro)g(call)h(or)f(con)o(tain)h
(macro)e(calls,)j(in)f(whic)o(h)g(case)0 1272 y(further)g(expansion)h(is)g(p)
q(erformed)f(un)o(til)i(no)e(macro)f(calls)i(remain.)71 1329
y(T)l(ransformers)11 b(decomp)q(ose)i(their)g(input)g(using)h
Fg(syn)o(tax-case)e Fl(and)g(rebuild)j(their)e(output)f(using)h
Fg(syn)o(tax)o Fl(.)0 1385 y(A)i Fg(syn)o(tax-case)g Fl(expression)h(tak)o
(es)f(the)g(follo)o(wing)h(form:)72 1485 y(\()q Fg(syn)o(tax-case)h
Fi(input-expr)n(ession)f Fl(\()q Fi(liter)n(al)23 b Ff(:)8
b(:)g(:)f Fl(\))16 b Fi(clause)24 b Ff(:)8 b(:)g(:)e Fl(\))0
1579 y(Eac)o(h)15 b Fi(clause)j Fl(tak)o(es)d(one)g(of)g(the)g(follo)o(wing)h
(t)o(w)o(o)e(forms:)72 1678 y(\()q Fi(p)n(attern)i(output-expr)n(ession)5
b Fl(\))72 1735 y(\()q Fi(p)n(attern)16 b(fender)g(output-expr)n(ession)5
b Fl(\))0 1828 y Fg(syn)o(tax-case)15 b Fl(\014rst)f(ev)m(aluates)i
Fi(input-expr)n(ession)p Fl(,)e(then)h(attempts)f(to)h(matc)o(h)f(the)h
(resulting)h(v)m(alue)h(with)e(the)0 1885 y(pattern)g(from)f(the)i(\014rst)f
Fi(clause)p Fl(.)k(This)d(v)m(alue)h(is)e(usually)i(a)e(syn)o(tax)f(ob)s
(ject,)h(but)g(it)h(ma)o(y)e(b)q(e)i(an)o(y)f(Sc)o(heme)h(list)0
1941 y(structure.)28 b(If)18 b(the)g(v)m(alue)h(matc)o(hes)f(the)g(pattern,)g
(and)g(there)g(is)h(no)f Fi(fender)k Fl(presen)o(t,)c Fi(output-expr)n
(ession)k Fl(is)0 1998 y(ev)m(aluated)16 b(and)e(its)h(v)m(alue)h(returned)f
(as)f(the)h(v)m(alue)h(of)e(the)g Fg(syn)o(tax-case)h Fl(expression.)20
b(If)15 b(the)g(v)m(alue)g(do)q(es)g(not)0 2054 y(matc)o(h)g(the)h(pattern,)f
(the)h(v)m(alue)h(is)f(compared)g(against)f(the)h(next)g(clause,)g(and)g(so)g
(on.)21 b(An)16 b(error)f(is)i(signaled)0 2111 y(if)f(the)f(v)m(alue)h(do)q
(es)g(not)f(matc)o(h)f(an)o(y)h(of)g(the)g(patterns.)71 2167
y(P)o(atterns)h(consist)i(of)f(list)h(structures,)g(iden)o(ti\014ers,)h(and)f
(constan)o(ts.)26 b(Eac)o(h)17 b(iden)o(ti\014er)i(within)g(a)e(pattern)0
2224 y(is)f(either)f(a)g Fi(liter)n(al)p Fl(,)f(a)h Fi(p)n(attern)h(variable)
p Fl(,)e(or)h(the)g(sp)q(ecial)i(iden)o(ti\014er)24 b Ff(:)8
b(:)g(:)e Fl(,)14 b(whic)o(h)i(represen)o(ts)f(an)g(ellipsis.)23
b(An)o(y)0 2280 y(iden)o(ti\014er)13 b(other)f(than)19 b Ff(:)8
b(:)g(:)18 b Fl(is)12 b(a)g(literal)h(if)f(it)g(app)q(ears)g(in)h(the)f(list)
h(of)e(literals)i(\()p Fi(liter)n(al)i Ff(:)8 b(:)g(:)e Fl(\))12
b(in)g(the)g Fg(syn)o(tax-case)0 2337 y Fl(expression;)k(otherwise)g(it)g(is)
g(a)g(pattern)f(v)m(ariable.)22 b(Literals)17 b(serv)o(e)e(as)h(auxiliary)h
(k)o(eyw)o(ords,)d(suc)o(h)i(as)f Fg(else)h Fl(in)0 2393 y
Fg(case)h Fl(and)g Fg(cond)g Fl(expressions.)25 b(List)17 b(structure)f
(within)i(a)f(pattern)f(sp)q(eci\014es)i(the)f(basic)g(structure)g(required)0
2449 y(of)i(the)h(input,)h(pattern)e(v)m(ariables)h(sp)q(ecify)h(arbitrary)e
(substructure,)h(and)g(literals)h(and)e(constan)o(ts)g(sp)q(ecify)0
2506 y(atomic)f(pieces)h(that)f(m)o(ust)g(matc)o(h)f(exactly)l(.)29
b(Ellipses)21 b(sp)q(ecify)e(rep)q(eated)g(o)q(ccurrences)g(of)f(the)g
(subpatterns)0 2562 y(they)d(follo)o(w.)71 2619 y(An)g(input)h(form)f
Ff(F)21 b Fl(matc)o(hes)15 b(a)g(pattern)g Ff(P)21 b Fl(if)16
b(and)f(only)h(if:)68 2688 y Fk(\017)23 b Ff(P)e Fl(is)16 b(a)f(pattern)g(v)m
(ariable;)h(or)964 2828 y(3)p eop
%%Page: 4 5
bop 68 49 a Fk(\017)23 b Ff(P)e Fl(is)16 b(a)f(literal)h(iden)o(ti\014er)h
(and)e Ff(F)22 b Fl(is)16 b(an)f(iden)o(ti\014er)i(with)e(the)h(same)e
(binding;)j(or)68 106 y Fk(\017)23 b Ff(P)17 b Fl(is)12 b(a)e(pattern)h(list)
h(\()p Ff(P)512 113 y Fh(1)542 106 y Ff(:)c(:)g(:)h(P)635 113
y Fe(n)659 106 y Fl(\))i(and)g Ff(F)17 b Fl(is)12 b(a)e(list)i(of)f
Ff(n)g Fl(forms)f(that)h(matc)o(h)f Ff(P)1429 113 y Fh(1)1460
106 y Fl(through)h Ff(P)1657 113 y Fe(n)1680 106 y Fl(,)h(resp)q(ectiv)o
(ely;)114 162 y(or)68 219 y Fk(\017)23 b Ff(P)g Fl(is)18 b(an)f(improp)q(er)h
(pattern)e(list)i(\()p Ff(P)765 226 y Fh(1)802 219 y Ff(P)831
226 y Fh(2)868 219 y Ff(:)8 b(:)g(:)15 b(P)967 226 y Fe(n)1008
219 y Fl(.)h Ff(P)1066 226 y Fe(n)p Fh(+1)1135 219 y Fl(\))h(and)g
Ff(F)24 b Fl(is)17 b(a)g(list)h(or)f(improp)q(er)h(list)f(of)g
Ff(n)g Fl(or)114 275 y(more)d(forms)h(that)f(matc)o(h)h Ff(P)618
282 y Fh(1)653 275 y Fl(through)g Ff(P)854 282 y Fe(n)877 275
y Fl(,)g(resp)q(ectiv)o(ely)l(,)i(and)e(whose)g Ff(n)p Fl(th)h(\\cdr")f(matc)
o(hes)f Ff(P)1798 282 y Fe(n)p Fh(+1)1867 275 y Fl(;)h(or)68
332 y Fk(\017)23 b Ff(P)d Fl(is)13 b(of)g(the)h(form)f(\()p
Ff(P)486 339 y Fh(1)519 332 y Ff(:)8 b(:)g(:)j(P)614 339 y
Fe(n)651 332 y Ff(P)680 339 y Fe(n)p Fh(+1)762 332 y Fi(el)r(lipsis)t
Fl(\))h(where)h Fi(el)r(lipsis)j Fl(is)e(the)g(iden)o(ti\014er)22
b Ff(:)8 b(:)g(:)19 b Fl(and)14 b Ff(F)20 b Fl(is)14 b(a)f(prop)q(er)114
388 y(list)k(of)f(at)g(least)h Ff(n)f Fl(elemen)o(ts,)h(the)g(\014rst)f
Ff(n)h Fl(of)f(whic)o(h)h(matc)o(h)f Ff(P)1223 395 y Fh(1)1260
388 y Fl(through)g Ff(P)1462 395 y Fe(n)1485 388 y Fl(,)h(resp)q(ectiv)o(ely)
l(,)h(and)f(eac)o(h)114 444 y(remaining)f(elemen)o(t)g(of)f
Ff(F)21 b Fl(matc)o(hes)15 b Ff(P)801 451 y Fe(n)p Fh(+1)870
444 y Fl(;)g(or)68 501 y Fk(\017)23 b Ff(P)e Fl(is)16 b(a)f(pattern)g(datum)g
(and)g Ff(F)22 b Fl(is)15 b(equal)h(to)f Ff(P)21 b Fl(in)c(the)e(sense)g(of)g
(the)h Fi(e)n(qual?)f Fl(pro)q(cedure.)71 570 y(If)f(the)g(optional)g
Fi(fender)19 b Fl(is)14 b(presen)o(t,)g(it)g(serv)o(es)g(as)f(an)h
(additional)i(constrain)o(t)d(on)h(acceptance)g(of)g(a)f(clause.)0
626 y(If)h(the)h(v)m(alue)g(of)f Fi(input-expr)n(ession)i Fl(matc)o(hes)e
(the)g(pattern)g(for)f(a)h(giv)o(en)h(clause,)g(the)f(corresp)q(onding)h
Fi(fender)j Fl(is)0 683 y(ev)m(aluated.)i(If)13 b Fi(fender)18
b Fl(ev)m(aluates)13 b(to)f(a)h(true)f(v)m(alue)i(the)f(clause)h(is)f
(accepted,)h(otherwise)f(the)g(clause)g(is)h(rejected)0 739
y(as)e(if)h(the)f(input)h(had)g(failed)g(to)f(matc)o(h)f(the)i(pattern.)18
b(F)l(enders)13 b(are)f(logically)i(a)e(part)g(of)f(the)i(matc)o(hing)f(pro)q
(cess,)0 796 y(i.e.,)j(they)g(sp)q(ecify)i(additional)f(matc)o(hing)g
(constrain)o(ts)e(b)q(ey)o(ond)i(the)f(basic)h(structure)f(of)g(an)g
(expression.)71 852 y(P)o(attern)f(v)m(ariables)k(con)o(tained)e(within)h(a)f
(clause's)g Fi(p)n(attern)g Fl(are)g(b)q(ound)h(to)e(the)h(corresp)q(onding)h
(pieces)g(of)0 909 y(the)j(input)g(v)m(alue)h(within)g(the)f(clause's)g
Fi(fender)f Fl(\(if)h(presen)o(t\))f(and)h Fi(output-expr)n(ession)p
Fl(.)33 b(Although)20 b(pattern)0 965 y(v)m(ariable)h(bindings)g(created)e(b)
o(y)g Fg(syn)o(tax-case)g Fl(can)h(shado)o(w)e(\(and)h(b)q(e)h(shado)o(w)o
(ed)f(b)o(y\))g(lexical)i(and)f(macro)0 1021 y(k)o(eyw)o(ord)f(bindings,)j
(pattern)d(v)m(ariables)h(can)g(b)q(e)g(referenced)h(only)f(within)g
Fg(syn)o(tax)f Fl(expressions.)33 b(Sc)o(heme)0 1078 y Fg(syn)o(tax)14
b Fl(expressions)i(ha)o(v)o(e)f(the)g(follo)o(wing)h(form:)72
1178 y(\()q Fg(syn)o(tax)g Fi(template)5 b Fl(\))0 1271 y(A)19
b Fg(syn)o(tax)f Fl(form)g(returns)h(a)g(Sc)o(heme)g(ob)s(ject)g(in)g(m)o(uc)
o(h)g(the)g(same)g(w)o(a)o(y)f(as)h Fg(quote)f Fl(or)h Fg(quasiquote)p
Fl(,)h(with)0 1328 y(t)o(w)o(o)c(imp)q(ortan)o(t)h(di\013erences:)25
b(the)17 b(v)m(alues)i(of)e(pattern)f(v)m(ariables)j(app)q(earing)f(within)h
Fi(template)e Fl(are)g(inserted)0 1384 y(in)o(to)f Fi(template)p
Fl(,)g(and)g(con)o(textual)f(syn)o(tactic)h(information)g(con)o(tained)g
(within)h Fi(template)f Fl(is)h(retained.)22 b(All)17 b(list)0
1441 y(structure)c(within)h Fi(template)f Fl(remains)g(ordinary)g(list)h
(structure)f(in)g(the)g(output,)g(and)g(all)h(other)f(items)g(\(includ-)0
1497 y(ing)h(iden)o(ti\014ers\))h(are)e(inserted)i(without)e(further)g(in)o
(terpretation.)20 b(Con)o(textual)13 b(information)h(asso)q(ciated)g(with)0
1554 y(the)h(v)m(alues)i(of)e(inserted)h(pattern)f(v)m(ariables)i(and)f(an)o
(y)f(nonlist)h(items)g(from)e(the)i(template)g(is)g(retained)g(in)g(the)0
1610 y(output.)71 1667 y(Within)e(a)f(template,)h(a)f(subtemplate)i(follo)o
(w)o(ed)e(b)o(y)h(an)f(ellipsis)k(expands)d(in)o(to)f(zero)h(or)f(more)g(o)q
(ccurrences)0 1723 y(of)20 b(the)g(subtemplate.)34 b(The)21
b(subtemplate)f(m)o(ust)g(con)o(tain)g(at)f(least)h(one)g(pattern)g(v)m
(ariable)h(that)e(w)o(as)g(in)i(a)0 1779 y(subpattern)14 b(follo)o(w)o(ed)h
(b)o(y)f(an)g(ellipsis)j(in)e(the)g(input.)20 b(\(Otherwise,)15
b(the)f(expander)h(could)g(not)f(determine)h(ho)o(w)0 1836
y(man)o(y)h(times)h(the)g(subform)g(should)h(b)q(e)f(rep)q(eated)g(in)h(the)f
(output.\))24 b(This)18 b(generalizes)g(in)f(a)g(natural)g(w)o(a)o(y)f(to)0
1892 y(nested)i(ellipses.)30 b(There)18 b(is)h(one)f(exception)h(to)e(this)h
(rule:)26 b(the)18 b(sp)q(ecial)h(template)h(\()8 b Ff(:)g(:)g(:)28
b(:)8 b(:)g(:)f Fl(\))19 b(expands)f(in)o(to)8 1949 y Ff(:)8
b(:)g(:)d Fl(.)20 b(This)c(is)g(used)f(b)o(y)g(macro-de\014ning)i(macros)d
(to)h(in)o(tro)q(duce)h(ellipses)h(in)o(to)e(the)h(de\014ned)g(macros.)71
2005 y(A)j(pattern)f(v)m(ariable)j(that)d(o)q(ccurs)i(in)g(a)e
Fg(syn)o(tax)h Fl(template)g(is)g(replaced)i(b)o(y)e(the)g(subform)g(it)g
(matc)o(hed)0 2062 y(in)f(the)g Fg(syn)o(tax-case)f Fl(expression)i(that)e
(established)i(the)f(pattern)f(v)m(ariable's)h(binding.)29
b(P)o(attern)17 b(v)m(ariables)0 2118 y(that)c(o)q(ccur)h(in)g(subpatterns)f
(follo)o(w)o(ed)h(b)o(y)g(one)f(or)g(more)g(ellipses)j(ma)o(y)d(o)q(ccur)h
(only)g(in)g(subtemplates)g(that)f(are)0 2175 y(follo)o(w)o(ed)h(b)o(y)f
(\(at)g(least\))g(as)g(man)o(y)g(ellipses)j(in)e(a)g Fg(syn)o(tax)e
Fl(template,)i(in)g(whic)o(h)h(case)e(they)h(are)f(replaced)i(in)f(the)0
2231 y(output)h(b)o(y)g(all)h(of)f(the)g(subforms)g(they)g(matc)o(hed)g(in)i
(the)e(input.)71 2288 y(It)g(is)h(an)f(error)g(for)f(a)h(transformer)f(to)h
(return)g(a)g(\\ra)o(w")f(sym)o(b)q(ol;)i(all)g(names)f(returned)h(b)o(y)f(a)
g(transformer)0 2344 y(m)o(ust)i(b)q(e)g(iden)o(ti\014ers)i(in)o(tro)q(duced)
g(b)o(y)e Fg(syn)o(tax)f Fl(expressions.)27 b(In)17 b(other)g(w)o(ords,)g(if)
g(a)g(transformer)f(returns)h(a)0 2400 y(sym)o(b)q(ol,)e(the)g(b)q(eha)o
(vior)h(is)g(unde\014ned.)71 2457 y(The)j(system)g(pro)o(vides)h(three)g
(predicates)g(for)f(recognizing)h(and)g(comparing)f(iden)o(ti\014ers)1673
2440 y Fh(1)1695 2457 y Fl(:)28 b Fi(identi\014er?)o Fl(,)0
2513 y Fi(fr)n(e)n(e-identi\014er=?)o Fl(,)17 b(and)h Fi(b)n
(ound-identi\014er=?)p Fl(.)26 b(The)17 b(predicate)i Fi(identi\014er?)d
Fl(returns)i(true)f(if)h(and)f(only)h(if)g(its)0 2570 y(argumen)o(t)c(is)i
(an)f(iden)o(ti\014er.)p 0 2609 780 2 v 52 2636 a Fd(1)69 2652
y Fc(The)e(term)g Fb(identi\014er)h Fc(is)g(used)f(throughout)i(as)e
(shorthand)i(for)e(\\syn)o(tax)h(ob)r(ject)f(represen)o(ting)i(an)e(iden)o
(ti\014er.")964 2828 y Fl(4)p eop
%%Page: 5 6
bop 71 49 a Fl(The)22 b(predicates)h Fi(fr)n(e)n(e-identi\014er=?)e
Fl(and)h Fi(b)n(ound-identi\014er=?)g Fl(are)g(used)g(to)g(determine)h
(whether)f(t)o(w)o(o)0 106 y(iden)o(ti\014ers)13 b(are)e(equal)h(based)g(on)f
(their)h Fi(intende)n(d)j Fl(use)d(as)f(free)g(or)g(b)q(ound)h(iden)o
(ti\014ers)h(in)f(the)g(output)f(of)g(a)g(macro.)0 162 y(When)16
b(it)h(is)f(necessary)g(to)g(determine)h(if)f(a)g(binding)i(in)o(tro)q(duced)
f(for)f(one)g(iden)o(ti\014er)i(w)o(ould)e(bind)h(references)0
219 y(to)d(another,)g(the)h(predicate)g Fi(b)n(ound-identi\014er=?)f
Fl(is)i(used.)k(Tw)o(o)14 b(iden)o(ti\014ers)i(are)e Fi(b)n
(ound-identi\014er=?)g Fl(only)h(if)0 275 y(b)q(oth)d(ha)o(v)o(e)g(the)g
(same)f(name)h(and)g(b)q(oth)g(w)o(ere)g(presen)o(t)g(in)h(the)f(original)h
(program)e(or)g(b)q(oth)h(w)o(ere)g(in)o(tro)q(duced)h(b)o(y)0
332 y(the)i(same)g(macro)f(application.)22 b(The)15 b(predicate)h
Fi(b)n(ound-identi\014er=?)e Fl(can)i(b)q(e)f(used)h(for)e(detecting)i
(duplicate)0 388 y(v)m(ariable)c(names)f(in)h(a)f(binding)i(construct,)e(or)g
(for)f(other)h(prepro)q(cessing)h(of)e(a)h(binding)i(construct)e(that)f
(requires)0 444 y(detecting)19 b(instances)h(of)e(the)h(b)q(ound)g(v)m
(ariables.)32 b(When)19 b(it)g(is)g(necessary)g(to)f(determine)h(if)h(t)o(w)o
(o)d(iden)o(ti\014ers,)0 501 y(inserted)f(as)f(free)g(references,)h(w)o(ould)
f(b)q(oth)g(refer)h(to)e(the)h(same)g(binding,)i(the)e(predicate)h
Fi(fr)n(e)n(e-identi\014er=?)e Fl(is)0 557 y(used.)29 b(Literal)19
b(iden)o(ti\014ers)h(app)q(earing)e(in)h Fg(syn)o(tax-case)f
Fl(patterns)g(\(suc)o(h)g(as)f Fg(else)h Fl(in)h Fg(cond)q
Fl(\))e(are)h(matc)o(hed)0 614 y(using)e Fi(fr)n(e)n(e-identi\014er=?)o
Fl(.)71 670 y(Tw)o(o)e(iden)o(ti\014ers)j(ma)o(y)d(b)q(e)i
Fi(fr)n(e)n(e-identi\014er=?)e Fl(if)i(they)f(are)g(not)g Fi(b)n
(ound-identi\014er=?)p Fl(,)g(but)g(the)g(con)o(v)o(erse)g(is)0
727 y(nev)o(er)h(true.)21 b(In)16 b(general,)g(when)g(t)o(w)o(o)f(iden)o
(ti\014ers)i(are)e(in)o(tro)q(duced)i(at)e(di\013eren)o(t)h(macro)f
(expansion)h(steps)g(but)0 783 y(b)q(oth)h(w)o(ould)h(refer)f(to)g(the)g
(same)g(binding)i(if)e(inserted)i(as)d(free)i(references,)g(they)f(are)g
Fi(fr)n(e)n(e-identi\014er=?)f Fl(but)0 840 y(not)f Fi(b)n
(ound-identi\014er=?)o Fl(.)71 896 y(On)22 b(rare)g(o)q(ccasions,)i(it)e(is)h
(necessary)f(to)f(compare)h(t)o(w)o(o)f(iden)o(ti\014ers)j(that)d(will)j(b)q
(e)e(inserted)h(as)f(sym-)0 953 y(b)q(olic)c(\(quoted\))e(data)g(in)h(the)f
(output)h(of)f(a)g(macro.)23 b(No)16 b(predicate)h(for)f(directly)i
(comparing)e(t)o(w)o(o)f(iden)o(ti\014ers)0 1009 y(that)20
b(will)i(b)q(e)f(used)g(as)g(sym)o(b)q(olic)g(data)f(is)h(pro)o(vided;)j(ho)o
(w)o(ev)o(er,)d(it)g(is)g(simple)h(to)e(de\014ne)h(one)g(in)g(terms)f(of)0
1065 y Fi(syntax-obje)n(ct)p Fk(\000)-8 b Ff(>)p Fi(datum)q
Fl(,)15 b(whic)o(h)h(extracts)e(the)i(\\ra)o(w")d(datum)i(from)g(an)o(y)g
(syn)o(tax)f(ob)s(ject:)72 1154 y(\()q Fg(de\014ne)j Fi(symb)n
(olic-identi\014er=?)123 1210 y Fl(\()q Fg(lam)o(b)q(da)j Fl(\()q
Fi(x)c(y)5 b Fl(\))175 1266 y(\()q Fi(e)n(q?)17 b Fl(\()q Fi(syntax-obje)n
(ct)p Fk(\000)-8 b Ff(>)p Fi(datum)16 b(x)7 b Fl(\))274 1323
y(\()q Fi(syntax-obje)n(ct)p Fk(\000)-8 b Ff(>)p Fi(datum)16
b(y)5 b Fl(\))r(\))r(\))r(\))71 1405 y(It)11 b(is)h(nev)o(er)f(necessary)h
(to)f(generate)g(a)g(single)i(unique)g(name)e(for)g(insertion)h(in)h(the)e
(output)g(of)g(a)g(macro,)g(as)g(is)0 1462 y(often)i(necessary)g(in)h(nonh)o
(ygienic)h(systems,)e(since)h(inserted)g(bindings)h(are,)e(in)h(e\013ect,)f
(renamed)g(as)g(necessary)l(.)0 1518 y(Ho)o(w)o(ev)o(er,)g(it)h(is)g
(sometimes)g(con)o(v)o(enien)o(t)h(to)e(b)q(e)i(able)f(to)g(create)f(a)h
(list)h(of)e(temp)q(orary)g(names.)20 b(The)14 b(pro)q(cedure)0
1574 y Fi(gener)n(ate-temp)n(or)n(aries)j Fl(is)h(used)g(for)f(this)h(purp)q
(ose.)27 b(This)18 b(pro)q(cedure)g(tak)o(es)f(a)g(list)h(as)f(input)h(and)g
(returns)f(a)0 1631 y(list)g(of)e(new)h(iden)o(ti\014ers,)h(one)f(for)f(eac)o
(h)g(elemen)o(t)i(in)f(the)g(input)h(list.)22 b(The)16 b(actual)g(elemen)o
(ts)g(of)g(the)f(input)i(list)0 1687 y(are)e(ignored.)21 b(T)o(ypically)l(,)c
(the)e(list)h(passed)g(to)f(generate-temp)q(oraries)g(is)h(a)f(list)h(of)f
(subforms)g(from)g(the)g(input)0 1744 y(to)i(a)h(macro)f(where)i(the)f(n)o
(um)o(b)q(er)g(of)g(subforms)f(determines)i(the)f(n)o(um)o(b)q(er)h(of)e
(temp)q(oraries)h(required.)30 b(\(See)0 1800 y(the)15 b Fg(letrec)h
Fl(example)g(in)g(the)f(next)h(section.\))71 1857 y(Occasionally)g(it)f(is)g
(useful)h(to)e(de\014ne)i(macros)d(that)h(in)o(tro)q(duce)i(visible)h
(bindings)f(for)e(iden)o(ti\014ers)i(that)e(are)0 1913 y(not)j(supplied)i
(explicitly)h(in)d(a)g(macro)f(call.)27 b(F)l(or)16 b(example,)i(w)o(e)f
(migh)o(t)g(wish)g(to)f(de\014ne)j(a)d Fg(lo)q(op)i Fl(macro)f(that)0
1970 y(binds)c(the)f(implicit)i(v)m(ariable)f Fi(exit)f Fl(to)f(an)h(escap)q
(e)h(pro)q(cedure)f(within)h(the)f(lo)q(op)h(b)q(o)q(dy)l(.)19
b(This)13 b(can)f(b)q(e)g(done)g(using)0 2026 y(the)j(pro)q(cedure)g
Fi(implicit-identi\014er)p Fl(.)k(The)c(pro)q(cedure)h Fi
(implicit-identi\014er)o Fl(,)f(giv)o(en)g(a)f Fi(template)i(identi\014er)j
Fl(and)0 2083 y(a)e Fi(symb)n(ol)k Fl(as)16 b(argumen)o(ts,)g(creates)h(an)g
(iden)o(ti\014er)h(named)g(b)o(y)f(the)g(sym)o(b)q(ol)g(that)f(b)q(eha)o(v)o
(es)h(as)g(if)g(it)h(had)f(b)q(een)0 2139 y(in)o(tro)q(duced)g(at)f(the)g
(same)g(time)g(and)h(place)g(as)e(the)i(template)f(iden)o(ti\014er.)24
b(The)17 b(template)f(iden)o(ti\014er)i(is)e(often)0 2195 y(the)i(macro)f(k)o
(eyw)o(ord)g(itself,)i(extracted)e(from)g(the)h(input,)h(and)f(the)g(sym)o(b)
q(ol)g(is)g(the)g(sym)o(b)q(olic)h(name)f(of)f(the)0 2252 y(iden)o(ti\014er)g
(to)d(b)q(e)i(constructed.)k(Section)c(4)f(presen)o(ts)g(sev)o(eral)h
(examples)g(using)g Fi(implicit-identi\014er)o Fl(.)71 2308
y(Man)o(y)22 b(syn)o(tax)h(errors)g(are)g(rep)q(orted)g(automatically)h(b)o
(y)g Fg(syn)o(tax-case)f Fl(when)h(none)g(of)f(the)g(clauses)0
2365 y(are)d(selected.)36 b(Sometimes,)21 b(ho)o(w)o(ev)o(er,)g(the)f(error)f
(messages)h(pro)q(duced)h(are)f(misleading)i(\(for)e(example,)h(if)0
2421 y Fg(syn)o(tax-case)g Fl(is)i(applied)g(to)e(only)h(a)g(p)q(ortion)g(of)
f(the)h(input\))g(or)f(less)i(informativ)o(e)f(than)f(desired.)41
b(The)0 2478 y(pro)q(cedure)20 b Fi(syntax-err)n(or)g Fl(can)f(b)q(e)h(used)g
(to)f(signal)h(an)f(error)f(explicitly)l(.)36 b(This)19 b(pro)q(cedure)i
(accepts)e(one)g(or)0 2534 y(more)f(argumen)o(ts:)24 b(the)19
b(\014rst)e(argumen)o(t)g(is)i(a)f(syn)o(tax)f(ob)s(ject)h(\(whic)o(h)g(is)h
(alw)o(a)o(ys)e(stripp)q(ed)i(of)f(all)h(syn)o(tactic)0 2591
y(information)f(for)f(readabilit)o(y\),)i(and)e(the)h(remaining)h(argumen)o
(ts)e(are)g(strings)g(describing)j(the)e(error.)26 b(If)18
b(no)0 2647 y(string)c(argumen)o(ts)f(are)g(supplied,)j(a)e(default)g
(message)f(suc)o(h)h(as)g(\\in)o(v)m(alid)h(syn)o(tax")e(is)h(prin)o(ted)h
(along)f(with)g(the)0 2704 y(stripp)q(ed)i(\014rst)f(argumen)o(t.)964
2828 y(5)p eop
%%Page: 6 7
bop 0 49 a Fj(4)69 b(Examples)0 151 y Fl(This)20 b(section)h(con)o(tains)e(a)
h(sequence)h(of)e(annotated)g(example)i(macro)e(de\014nitions,)j(b)q
(eginning)g(with)e(a)f(few)0 207 y(simple)13 b(macros)e(and)h(graduating)f
(to)g(more)h(complex)g(macros.)18 b(Eac)o(h)12 b(of)f(the)h(syn)o(tactic)f
(forms)g(and)h(pro)q(cedures)0 264 y(describ)q(ed)17 b(in)f(the)f(preceding)h
(section)f(are)g(demonstrated,)f(most)g(more)h(than)f(once.)21
b(Man)o(y)14 b(of)g(the)h(examples)0 320 y(de\014ne)j(standard)e(Revised)477
304 y Fh(4)513 320 y Fl(Rep)q(ort)g(deriv)o(ed)i(syn)o(tactic)e(forms)g
(under)h(the)f(assumption)h(that)f(the)g(reader)g(is)0 377
y(already)f(familiar)i(with)e(their)h(syn)o(tax)e(and)i(seman)o(tics.)71
433 y(Within)i(the)g(co)q(de,)g(syn)o(tactic)f(k)o(eyw)o(ords)g(app)q(ear)h
(in)g(b)q(oldface,)h(e.g.,)e Fg(lam)o(b)q(da)q Fl(;)h(lexical)h(v)m
(ariables,)g(top-)0 489 y(lev)o(el)d(v)m(ariables,)f(and)f(pattern)g(v)m
(ariables)i(app)q(ear)e(in)h(italics,)h(e.g.,)d Fi(x)p Fl(;)h(and)g(commen)o
(ts)g(and)g(constan)o(ts)g(app)q(ear)0 546 y(in)i(Roman,)e(e.g.,)g(\\ok)m(a)o
(y")o(.)71 602 y(The)g(\014rst)g(example)h(is)g(a)f(v)o(ery)g(simple)i(macro)
d(for)h(a)g(t)o(w)o(o-sub)q(expression)h(v)m(arian)o(t)f Fg(and2)h
Fl(of)f(the)g(standard)0 659 y(syn)o(tactic)h(form)g Fg(and)p
Fl(.)72 758 y(\()q Fg(de\014ne-syn)o(tax)i(and2)123 815 y Fl(\()q
Fg(lam)o(b)q(da)j Fl(\()q Fi(x)7 b Fl(\))175 871 y(\()q Fg(syn)o(tax-case)17
b Fi(x)h Fl(\()r(\))227 928 y(\()r(\()p 269 928 14 2 v 281
928 V 44 w Fi(x)f(y)5 b Fl(\))247 984 y(\()q Fg(syn)o(tax)17
b Fl(\()q Fg(if)h Fi(x)f(y)f Fl(#f)5 b(\))r(\))r(\))r(\))r(\))r(\))0
1078 y(The)16 b Fg(de\014ne-syn)o(tax)f Fl(expression)i(establishes)g(a)e
(binding)j(for)d(the)h Fg(and2)h Fl(k)o(eyw)o(ord)e(to)g(the)h(sp)q
(eci\014ed)h(trans-)0 1135 y(former.)31 b(The)19 b(syn)o(tax)g(ob)s(ject)f
(pro)o(vided)i(as)f(input)h(to)e(the)i(transformer)d(is)j(handed)g(to)f
Fg(syn)o(tax-case)o Fl(;)i(ul-)0 1191 y(timately)l(,)g(almost)e(nothing)g
(can)h(b)q(e)g(done)g(with)g(syn)o(tax)e(ob)s(jects)h(except)h(b)o(y)f(w)o(a)
o(y)g(of)g Fg(syn)o(tax-case)o Fl(.)33 b(The)0 1247 y Fg(syn)o(tax-case)19
b Fl(expression)g(con)o(tains)g(only)h(one)f(clause.)31 b(The)20
b(input)f(pattern,)h(\()p 1460 1247 V 1472 1247 V 45 w Fi(x)c(y)5
b Fl(\))q(,)20 b(sp)q(eci\014es)g(that,)f(in)0 1304 y(addition)c(to)e(the)h
(macro)f(k)o(eyw)o(ord,)g(this)h(form)f(requires)i(exactly)f(t)o(w)o(o)e(sub)
q(expressions)k(and)d(that)h(the)f(pattern)0 1360 y(v)m(ariables)j
Fi(x)f Fl(and)g Fi(y)g Fl(are)f(to)g(b)q(e)i(b)q(ound)g(to)e(the)h(corresp)q
(onding)g(pieces)h(of)f(the)g(input.)20 b(The)c(output)e(expression)0
1417 y(simply)i(returns)g(a)e(new)i(expression)g(de\014ned)g(in)h(terms)d(of)
h(these)g(pattern)g(v)m(ariable.)71 1473 y(There)i(are)g(three)h(things)g(w)o
(orth)e(noting)i(ev)o(en)g(in)g(this)g(simple)h(example.)28
b(First,)17 b(output)h(generated)f(b)o(y)0 1530 y(macros)11
b(is)h(generated,)h(directly)g(or)e(indirectly)l(,)k(b)o(y)d
Fg(syn)o(tax)f Fl(forms.)17 b(The)c Fg(syn)o(tax)d Fl(form)i(serv)o(es)f(t)o
(w)o(o)g(purp)q(oses:)0 1586 y(it)g(expands)h(pattern)f(v)m(ariables)h(in)o
(to)f(the)g(corresp)q(onding)i(subforms)d(of)h(the)g(input,)i(and)e(it)h
(retains)f(information)0 1643 y(regarding)k(lexical)h(v)m(ariable)g(bindings)
h(and)e(other)f(con)o(textual)g(information)h(with)g(the)g(output)f(form.)19
b(In)d(this)0 1699 y(example,)i(this)g(con)o(textual)g(information)f(helps)i
(determine)f(that)f(the)g Fg(if)h Fl(in)g(the)g(output)f(refers)g(to)g(the)g
(top-)0 1756 y(lev)o(el)g(binding)h(for)d Fg(if)i Fl(and)f(not)g(to)f(some)g
(other)h(binding)i(for)d Fg(if)q Fl(.)22 b(If,)16 b(on)g(the)g(other)f(hand,)
h(there)h(w)o(ere)e(a)h(lo)q(cal)0 1812 y(binding)i(for)d Fg(if)i
Fl(visible)h(where)f(this)f(macro)f(w)o(as)h(de\014ned,)h(the)f(con)o
(textual)g(information)h(w)o(ould)f(ensure)h(that)0 1868 y
Fg(if)f Fl(referred)f(to)g(that)f(lo)q(cal)i(binding)h(and)f(not)f(to)f(the)h
(top-lev)o(el)i(binding)g(\(or)d(an)o(y)h(other)g(binding\).)71
1925 y(Second,)20 b(the)f(pattern)f(v)m(ariable)i Fi(x)f Fl(app)q(earing)h
(in)g(the)f(input)g(pattern)g(shado)o(ws)f(the)h(lexical)i(v)m(ariable)f
Fi(x)0 1981 y Fl(b)q(ound)d(b)o(y)f(the)h(enclosing)g(lam)o(b)q(da)g
(expression.)24 b(If)16 b Fi(x)h Fl(w)o(ere)f(referenced)h(within)g(the)g
(output)f(expression)h(but)0 2038 y(outside)22 b(of)f(the)h
Fg(syn)o(tax)e Fl(form,)i(it)g(w)o(ould)f(b)q(e)h(an)g(error.)38
b(It)21 b(is)h(alw)o(a)o(ys)f(p)q(ossible)i(to)e(lo)q(cate)h(the)f(binding)0
2094 y(for)f(an)h(iden)o(ti\014er)h(b)o(y)f(tracing)g(out)o(w)o(ards)e(to)h
(\014nd)i(the)e(nearest)h(enclosing)h(binding)h(form)d(that)g(binds)i(the)0
2151 y(iden)o(ti\014er;)e(if)e(no)g(suc)o(h)g(form)f(exists,)h(the)g(iden)o
(ti\014er)h(refers)f(to)f(a)g(top-lev)o(el)i(binding.)30 b(Lo)q(cal)18
b(binding)i(forms)0 2207 y(include)15 b Fg(lam)o(b)q(da)q Fl(,)e
Fg(let)q Fl(,)f Fg(letrec)q Fl(,)h Fg(do)p Fl(,)g Fg(let-syn)o(tax)p
Fl(,)g Fg(letrec-syn)o(tax)p Fl(,)g(in)o(ternal)g Fg(de\014ne)g
Fl(and)g Fg(de\014ne-syn)o(tax)o Fl(,)0 2264 y Fg(syn)o(tax-case)p
Fl(,)i(and)g(an)o(y)g(macro)f(that)h(expands)h(in)o(to)f(one)g(of)g(these)g
(forms.)71 2320 y(Third,)f(the)f(pattern)g(v)m(ariable)i(underscore)f(\()p
875 2320 V 887 2320 V 54 w(\))f(is)h(used)g(in)g(this)g(example)g(and)g
(throughout)e(most)h(of)g(the)0 2377 y(examples)i(where)g(the)g(macro)f(k)o
(eyw)o(ord)f(will)k(app)q(ear)d(in)i(the)f(input)g(expression.)21
b(This)15 b(is)g(a)f(con)o(v)o(en)o(tion)h(only;)0 2433 y(an)o(y)j(pattern)f
(v)m(ariable)j(ma)o(y)d(b)q(e)i(used)g(here,)f(includin)q(g)i(the)e(name)h
(of)e(the)h(macro)g(itself.)29 b(This)19 b(con)o(v)o(en)o(tion)0
2489 y(helps)d(to)f(remind)h(the)f(macro)g(writer)g(and)g(an)o(y)o(one)g(who)
g(reads)g(the)h(co)q(de)f(that)g(the)g(k)o(eyw)o(ord)g(p)q(osition)h(nev)o
(er)0 2546 y(fails)k(to)e(con)o(tain)h(the)h(exp)q(ected)g(k)o(eyw)o(ord)e
(and)h(need)h(not)f(b)q(e)g(matc)o(hed.)32 b(This)19 b(con)o(v)o(en)o(tion)g
(can)h(also)f(help)0 2602 y(a)o(v)o(oid)d(confusion)g(when)h(de\014ning)g(lo)
q(cal)g(macros)e(with)h Fg(let-syn)o(tax)q Fl(.)22 b(\(See)16
b(the)g(discussion)h(surrounding)g(the)0 2659 y(lo)q(cal)f
Fg(if)g Fl(examples)g(that)e(app)q(ear)i(later)f(in)h(this)g(section.\))964
2828 y(6)p eop
%%Page: 7 8
bop 71 49 a Fl(The)18 b(next)h(t)o(w)o(o)e(examples,)j(de\014ning)g(the)e
Fg(when)g Fl(and)h Fg(unless)f Fl(forms)g(found)h(in)g(man)o(y)f(Sc)o(heme)h
(imple-)0 106 y(men)o(tations,)14 b(demonstrate)h(the)g(use)h(of)f(ellipses)i
(for)e(sp)q(ecifying)i(m)o(ultiple)g(subforms:)72 205 y(\()q
Fg(de\014ne-syn)o(tax)g(when)123 262 y Fl(\()q Fg(lam)o(b)q(da)j
Fl(\()q Fi(x)7 b Fl(\))175 318 y(\()q Fg(syn)o(tax-case)17
b Fi(x)h Fl(\()r(\))227 374 y(\()r(\()p 269 374 14 2 v 281
374 V 44 w Fi(e0)f(e1)f(e2)24 b Ff(:)8 b(:)g(:)f Fl(\))17 b(\()q
Fg(syn)o(tax)h Fl(\()q Fg(if)f Fi(e0)h Fl(\()q Fg(b)q(egin)g
Fi(e1)f(e2)24 b Ff(:)8 b(:)g(:)e Fl(\))r(\))r(\))r(\))r(\))r(\))r(\))72
487 y(\()q Fg(de\014ne-syn)o(tax)17 b(unless)123 544 y Fl(\()q
Fg(lam)o(b)q(da)j Fl(\()q Fi(x)7 b Fl(\))175 600 y(\()q Fg(syn)o(tax-case)17
b Fi(x)h Fl(\()r(\))227 657 y(\()r(\()p 269 657 V 281 657 V
44 w Fi(e0)f(e1)f(e2)24 b Ff(:)8 b(:)g(:)f Fl(\))17 b(\()q
Fg(syn)o(tax)h Fl(\()q Fg(when)g Fl(\()q Fi(not)e(e0)7 b Fl(\))16
b Fi(e1)h(e2)24 b Ff(:)8 b(:)g(:)e Fl(\))r(\))r(\))r(\))r(\))r(\))0
750 y(In)21 b(b)q(oth)g(cases,)g(the)g(expansions)g(clearly)h(sho)o(w)e(what)
g Fg(when)g Fl(and)h Fg(unless)f Fl(are)g(in)o(tended)i(to)e(do:)30
b Fg(when)0 807 y Fl(ev)m(aluates)20 b(the)f(test)g(expression)h
Fi(e0)f Fl(and,)h(if)g(it)f(ev)m(aluates)h(to)e(true,)i(returns)f(the)g
(result)h(of)e(ev)m(aluating)j(the)0 863 y(remaining)c(subforms)g(in)g
(sequence.)25 b(The)16 b(sense)h(of)f(the)h(test)f(is)h(rev)o(ersed)f(in)h
(the)g Fg(unless)f Fl(form,)g(whic)o(h)h(also)0 920 y(demonstrates)j(that)g
(the)g(output)g(of)h(one)f(macro)g(ma)o(y)g(b)q(e)h(de\014ned)h(in)f(terms)f
(of)g(another.)36 b(Both)20 b(require)0 976 y(at)e(least)h(one)f(sub)q
(expression,)j Fi(e1)p Fl(,)e(follo)o(wing)g(the)g(test)f(expression,)i(and)f
(zero)f(or)g(more)g(additional)i(forms,)0 1033 y Fi(e2)k Ff(:)8
b(:)g(:)e Fl(.)71 1089 y(A)12 b Fg(when)h Fl(form)f(expands)h(in)o(to)g
(references)g(to)f(the)h(macro)f(k)o(eyw)o(ords)g Fg(if)h Fl(and)g
Fg(b)q(egin)q Fl(,)g(and)g(an)f Fg(unless)h Fl(form)0 1145
y(expands)20 b(in)o(to)f(references)h(to)f(the)g(macro)g(k)o(eyw)o(ord)f
Fg(when)h Fl(and)h(to)e(the)i(v)m(ariable)g Fi(not)p Fl(.)32
b(In)20 b(a)f(nonh)o(ygienic)0 1202 y(system,)e(lo)q(cal)i(bindings)g(for)d
(an)o(y)h(of)g(these)h(iden)o(ti\014ers)h(in)f(the)f(con)o(text)g(of)g(a)g
Fg(when)g Fl(or)g Fg(unless)g Fl(expression)0 1258 y(could)22
b(alter)g(the)f(seman)o(tics)h(of)f(the)g(construct.)38 b(With)22
b(the)f(de\014nitions)j(ab)q(o)o(v)o(e,)e(ho)o(w)o(ev)o(er,)g(this)f(is)h
(not)f(a)0 1315 y(problem,)16 b(so)e(the)i(follo)o(wing)g(expressions)g(b)q
(oth)f(prin)o(t)g(\\win")h(as)e(desired:)72 1414 y(\()q Fg(let)19
b Fl(\()r(\()q Fi(b)n(e)n(gin)14 b(list)5 b Fl(\))r(\))123
1471 y(\()q Fg(when)17 b Fl(#t)f(\()q Fi(write)h Fl(\\win")q(\))g(\()q
Fi(new)r(line)5 b Fl(\))r(\))r(\))72 1584 y(\()q Fg(let)19
b Fl(\()r(\()q Fi(not)e Fl(\()q Fg(lam)o(b)q(da)i Fl(\()q Fi(x)7
b Fl(\))16 b Fi(x)7 b Fl(\))r(\))17 b(\()q Fi(when)e Fl('nev)o(er)q(\))r(\))
123 1640 y(\()q Fg(unless)j Fl(#f)e(\()q Fi(write)g Fl(\\win")q(\))h(\()q
Fi(new)r(line)5 b Fl(\))r(\))r(\))0 1734 y(Either)16 b(of)e(these)i(macros)e
(migh)o(t)h(just)g(as)g(easily)i(ha)o(v)o(e)d(b)q(een)j(de\014ned)f(as)f(lo)q
(cal)i(macros)d(using)i Fg(let-syn)o(tax)f Fl(or)0 1790 y Fg(letrec-syn)o
(tax)p Fl(.)20 b(F)l(or)14 b(example:)72 1889 y(\()q Fg(let-syn)o(tax)k
Fl(\()r(\()q Fg(when)h Fl(\()q Fg(lam)o(b)q(da)g Fl(\()q Fi(x)7
b Fl(\))563 1946 y(\()q Fg(syn)o(tax-case)17 b Fi(x)h Fl(\()r(\))615
2002 y(\()r(\()p 657 2002 V 669 2002 V 45 w Fi(e0)e(e1)g(e2)24
b Ff(:)8 b(:)g(:)f Fl(\))635 2059 y(\()q Fg(syn)o(tax)18 b
Fl(\()q Fg(if)f Fi(e0)h Fl(\()q Fg(b)q(egin)g Fi(e1)f(e2)24
b Ff(:)8 b(:)g(:)e Fl(\))r(\))r(\))r(\))r(\))r(\))r(\))r(\))123
2115 y(\()q Fg(when)17 b Fl(#t)f(\()q Fi(write)h Fl('hi)q(\))g(\()q
Fi(new)r(line)5 b Fl(\))15 b('mom!)q(\))r(\))0 2209 y(In)k(this)g(case,)h(it)
f(do)q(es)g(not)f(matter)f(whic)o(h)j(of)e Fg(let-syn)o(tax)h
Fl(or)f Fg(letrec-syn)o(tax)h Fl(is)g(used,)h(since)g(the)f(macro)0
2265 y(k)o(eyw)o(ord)14 b Fg(when)g Fl(do)q(es)h(not)g(app)q(ear)g(within)h
(the)e(transformer)g(expression.)20 b(The)15 b(c)o(hoice)h(is)f(imp)q(ortan)o
(t)f(in)i(the)0 2322 y(follo)o(wing)g(recursiv)o(ely-de\014ned)i(macro)c(for)
h Fg(and)h Fl(generalized)h(to)d(zero)h(or)g(more)g(subforms:)72
2421 y(\()q Fg(letrec-syn)o(tax)j Fl(\()r(\()q Fg(and)h Fl(\()q
Fg(lam)o(b)q(da)g Fl(\()q Fi(x)7 b Fl(\))596 2477 y(\()q Fg(syn)o(tax-case)17
b Fi(x)g Fl(\()r(\))647 2534 y(\()r(\()p 689 2534 V 701 2534
V 31 w(\))g(\()q Fg(syn)o(tax)f Fl(#t)q(\))r(\))647 2590 y(\()r(\()p
689 2590 V 701 2590 V 45 w Fi(e)5 b Fl(\))17 b(\()q Fg(syn)o(tax)f
Fi(e)5 b Fl(\))r(\))647 2647 y(\()r(\()p 689 2647 V 701 2647
V 45 w Fi(e1)16 b(e2)h(e3)24 b Ff(:)8 b(:)g(:)f Fl(\))667 2703
y(\()q Fg(syn)o(tax)18 b Fl(\()q Fg(if)g Fi(e1)f Fl(\()q Fg(and)h
Fi(e2)e(e3)24 b Ff(:)8 b(:)g(:)f Fl(\))16 b(#f)5 b(\))r(\))r(\))r(\))r(\))r
(\))r(\))964 2828 y(7)p eop
%%Page: 8 9
bop 123 49 a Fl(\()q Fg(let)20 b Fl(\()r(\()q Fi(x)c Fl(')q(\()q(a)e(b)i(c)f
(d)q(\))r(\))r(\))175 106 y(\()q Fg(and)k Fl(\()q Fi(p)n(air?)e(x)7
b Fl(\))16 b(\()q Fi(p)n(air?)i Fl(\()q Fi(c)n(ddr)e(x)7 b
Fl(\))r(\))17 b(\()q Fi(p)n(air?)h Fl(\()q Fi(c)n(dddr)e(x)7
b Fl(\))r(\))17 b(\()q Fi(c)n(adddr)g(x)7 b Fl(\))r(\))r(\))r(\))0
200 y(The)15 b(second)g(clause)g(de\014nes)g(the)g(base)f(case)h(for)f(the)g
(recursion)h(\(one)g(sub)q(expression\),)g(and)g(the)f(third)h(clause)0
256 y(de\014nes)k(the)g(recursiv)o(e)g(case)f(\(t)o(w)o(o)f(or)h(more)g(sub)q
(expressions\).)30 b(The)19 b(\014rst)f(clause)h(sp)q(eci\014es)h(what)e
(happ)q(ens)0 312 y(when)d(there)g(are)g(no)f(sub)q(expressions.)22
b(During)15 b(the)g(expansion)g(for)h(\()q Fg(and)h Fi(x)g(y)f(z)7
b Fl(\))15 b(w)o(e)f(w)o(ould)i(exp)q(ect)f(to)f(ha)o(v)o(e)0
369 y(the)h(follo)o(wing)h(in)o(termediate)g(and)g(\014nal)g(forms:)72
469 y(\()q Fg(if)h Fi(x)h Fl(\()q Fg(and)g Fi(y)e(z)7 b Fl(\))15
b(#f)5 b(\))72 525 y(\()q Fg(if)17 b Fi(x)h Fl(\()q Fg(if)g
Fi(y)f Fl(\()q Fg(and)h Fi(z)7 b Fl(\))15 b(#f)5 b(\))16 b(#f)5
b(\))72 581 y(\()q Fg(if)17 b Fi(x)h Fl(\()q Fg(if)g Fi(y)e(z)g
Fl(#f)5 b(\))15 b(#f)5 b(\))71 675 y(Since)14 b(the)f(macro)f(for)g
Fg(and)h Fl(is)h(recursiv)o(e,)g(it)f(m)o(ust)f(b)q(e)h(de\014ned)i(using)e
Fg(de\014ne-syn)o(tax)g Fl(or)f Fg(letrec-syn)o(tax)0 732 y
Fl(but)18 b(not)f Fg(let-syn)o(tax)p Fl(.)27 b(With)18 b Fg(let-syn)o(tax)q
Fl(,)f(the)h Fg(and)g Fl(in)h(the)e(output)h(of)f(the)g(third)i(clause)f(w)o
(ould)g(refer)g(to)0 788 y(the)c(top-lev)o(el)i(de\014nition)g(for)d
Fg(and)q Fl(.)19 b(\(Of)c(course,)f(if)g(y)o(ou)g(try)g(this)h(in)g(y)o(our)e
(Sc)o(heme)i(system,)f(it)g(will)i(probably)0 845 y(app)q(ear)c(to)f(w)o(ork)
g(since)i Fg(and)g Fl(is)f(de\014ned)i(at)d(top-lev)o(el)i(to)e(do)h(exactly)
g(the)g(same)g(thing.)19 b(T)l(ry)12 b(using)h Fg(let-syn)o(tax)0
901 y Fl(but)i(with)h(a)f(di\013eren)o(t)g(name,)g(sa)o(y)g
Fg(m)o(y)o(and)n Fl(,)g(to)g(see)g(what)g(happ)q(ens.\))71
958 y(The)h(macros)f(de\014ned)j(so)e(far)f(ha)o(v)o(e)h(not)g(in)o(tro)q
(duced)h(an)o(y)f(new)h(bindings.)24 b(The)17 b(follo)o(wing)g(de\014nition)h
(for)0 1014 y Fg(or)d Fl(do)q(es:)72 1114 y(\()q Fg(de\014ne-syn)o(tax)i(or)
123 1170 y Fl(\()q Fg(lam)o(b)q(da)j Fl(\()q Fi(x)7 b Fl(\))175
1227 y(\()q Fg(syn)o(tax-case)17 b Fi(x)h Fl(\()r(\))227 1283
y(\()r(\()p 269 1283 14 2 v 281 1283 V 30 w(\))g(\()q Fg(syn)o(tax)e
Fl(#f)5 b(\))r(\))227 1339 y(\()r(\()p 269 1339 V 281 1339
V 44 w Fi(e)g Fl(\))17 b(\()q Fg(syn)o(tax)f Fi(e)5 b Fl(\))r(\))227
1396 y(\()r(\()p 269 1396 V 281 1396 V 44 w Fi(e1)17 b(e2)f(e3)24
b Ff(:)8 b(:)g(:)f Fl(\))247 1452 y(\()q Fg(syn)o(tax)17 b
Fl(\()q Fg(let)j Fl(\()r(\()q Fi(t)c(e1)7 b Fl(\))r(\))17 b(\()q
Fg(if)h Fi(t)e(t)i Fl(\()q Fg(or)f Fi(e2)f(e3)24 b Ff(:)8 b(:)g(:)f
Fl(\))r(\))r(\))r(\))r(\))r(\))r(\))r(\))0 1546 y(An)13 b Fg(or)f
Fl(expression)h(m)o(ust)e(return)i(the)f(v)m(alue)i(of)d(the)i(\014rst)f(sub)
q(expression)i(that)d(ev)m(aluates)i(to)f(a)g(true)g(\(nonfalse\))0
1603 y(v)m(alue,)j(or)e(#f)g(if)h(none)g(ev)m(aluate)g(to)f(true)g(\(or)g(if)
h(there)g(are)f(none\).)19 b(If)14 b(there)g(is)g(more)f(than)g(one)h(sub)q
(expression,)0 1659 y(it)e(m)o(ust)f(b)q(oth)g(test)g(the)h(v)m(alue)h(of)e
(the)h(\014rst)f(sub)q(expression)i(b)o(y)e(placing)i(it)f(in)g(the)g(test)f
(part)g(of)g(an)g Fg(if)h Fl(expression,)0 1716 y(and)j(return)g(its)g(v)m
(alue)i(if)e(it)h(do)q(es)f(ev)m(aluate)h(to)e(a)h(true)g(v)m(alue.)21
b(In)16 b(order)e(to)h(a)o(v)o(oid)g(ev)m(aluating)h(the)f(expression)0
1772 y(t)o(wice,)h(a)g(temp)q(orary)f(v)m(ariable)j Fi(t)e
Fl(is)g(in)o(tro)q(duced.)24 b(Because)17 b(the)f(system)f(main)o(tains)i(h)o
(ygiene)g(automatically)l(,)0 1828 y(this)f(binding)h(is)g(visible)g(only)f
(to)f(co)q(de)h(in)o(tro)q(duced)h(b)o(y)f(the)f(macro)g(and)h(not)f(to)g(co)
q(de)h(con)o(tained)g(within)h(the)0 1885 y(input)e(to)e(the)h(macro.)k(Th)o
(us,)c(the)g(follo)o(wing)g(correctly)g(ev)m(aluates)g(to)f(\\ok)m(a)o(y")o
(,)h(although)g(without)g(automatic)0 1941 y(h)o(ygiene)22
b(it)f(w)o(ould)h(ev)m(aluate)g(to)e(#f)h(since)i(the)e(reference)h(to)e
Fi(t)h Fl(in)h(the)f(second)h(sub)q(expression)h(w)o(ould)e(b)q(e)0
1998 y(captured)16 b(b)o(y)f(the)g(in)o(tro)q(duced)h(binding)h(for)e
Fi(t)p Fl(.)72 2097 y(\()q Fg(let)k Fl(\()r(\()q Fi(t)d Fl(\\ok)m(a)o(y")q
(\))r(\))123 2154 y(\()q Fg(or)h Fl(#f)e Fi(t)5 b Fl(\))r(\))0
2248 y(It)14 b(is)g(useful)h(to)f(think)g(of)g(the)g(b)q(ound)g(v)m(ariable)i
(as)d(b)q(eing)i(automatically)g(renamed)f(to)f(a)o(v)o(oid)h(con\015icts,)g
(whic)o(h)0 2304 y(is)21 b(in)g(fact)e(ho)o(w)h(some)g(implemen)o(tations)h
(w)o(ork.)34 b(Th)o(us,)21 b(the)g(\014nal)g(output)f(of)f(the)i(expander)g
(migh)o(t)f(lo)q(ok)0 2361 y(something)15 b(lik)o(e:)964 2828
y(8)p eop
%%Page: 9 10
bop 72 49 a Fl(\()r(\()q Fg(lam)o(b)q(da)19 b Fl(\()q Fi(g0001)7
b Fl(\))143 106 y(\()r(\()q Fg(lam)o(b)q(da)20 b Fl(\()q Fi(g0002)7
b Fl(\))215 162 y(\()q Fg(if)18 b Fi(g0002)f(g0002)g(g0001)7
b Fl(\))r(\))162 219 y(#f)e(\))r(\))91 275 y(\\ok)m(a)o(y")q(\))0
366 y(where)18 b Fi(g0001)g Fl(and)f Fi(g0002)i Fl(are)e(generated)g(names.)
26 b(\(F)l(or)17 b(debugging)h(purp)q(oses,)g(the)g(actual)f(output)h(w)o
(ould)0 423 y(lik)o(ely)h(include)g(the)e(original)h(names)e(as)h(w)o(ell,)h
(or)e(these)h(migh)o(t)g(b)q(e)g(recorded)g(in)h(a)f(separate)f(table)h(pro)o
(vided)0 479 y(to)f(the)h(compiler)h(or)e(system)g(debugger.\))24
b(See)17 b(Section)h(5)e(for)g(more)g(information)h(on)g(and)f(examples)i(of)
e(the)0 536 y(expansion)g(pro)q(cess.)71 592 y(Iden)o(ti\014ers)e(b)q(ound)g
(b)o(y)f(in)o(tro)q(duced)i(bindings)g(need)f(not)f(b)q(e)h(new)f(iden)o
(ti\014ers)i(inserted)f(b)o(y)f(the)g(macro,)g(but)0 649 y(ma)o(y)h(b)q(e)i
(iden)o(ti\014ers)g(extracted)e(from)h(the)f(input)i(to)e(the)h(macro.)k(F)l
(or)c(example,)g(if)g(\(unnamed\))g Fg(let)h Fl(w)o(ere)e(not)0
705 y(pro)o(vided)i(b)o(y)f(the)g(system,)g(it)g(could)h(b)q(e)g(de\014ned)h
(simply)f(as)f(follo)o(ws:)72 802 y(\()q Fg(de\014ne-syn)o(tax)i(let)468
809 y Fh(1)123 859 y Fl(\()q Fg(lam)o(b)q(da)j Fl(\()q Fi(x)7
b Fl(\))175 915 y(\()q Fg(syn)o(tax-case)17 b Fi(x)h Fl(\()r(\))227
972 y(\()r(\()p 269 972 14 2 v 281 972 V 46 w(\()r(\()q Fi(i)e(v)6
b Fl(\))23 b Ff(:)8 b(:)g(:)f Fl(\))16 b Fi(e1)g(e2)24 b Ff(:)8
b(:)g(:)f Fl(\))247 1028 y(\()q Fg(syn)o(tax)17 b Fl(\()r(\()q
Fg(lam)o(b)q(da)j Fl(\()q Fi(i)j Ff(:)8 b(:)g(:)f Fl(\))16
b Fi(e1)g(e2)24 b Ff(:)8 b(:)g(:)f Fl(\))16 b Fi(v)24 b Ff(:)8
b(:)g(:)f Fl(\))r(\))r(\))r(\))r(\))r(\))0 1119 y(\(This)13
b(is)h(the)f(\014rst)g(in)h(a)f(series)g(of)g Fg(let)h Fl(de\014nitions,)h
(hence)f(the)f(subscript.\))20 b(This)14 b(example)g(also)f(demonstrates)0
1176 y(that)h(patterns)h(can)g(con)o(tain)h(more)f(than)g(one)g(ellipsis)j
(and)d(that)g(the)g(subpattern)g(preceding)i(an)e(ellipsis)j(can)0
1232 y(b)q(e)d(a)f(structured)g(pattern)g(con)o(taining)h(one)g(or)e(more)h
(pattern)g(v)m(ariables.)21 b(It)14 b(also)h(sho)o(ws)e(that)h(pieces)i(of)e
(suc)o(h)0 1289 y(a)k(pattern)g(can)g(b)q(e)h(split)g(up)g(in)g(the)f
(output,)h(as)e(are)h Fi(i)g Fl(and)h Fi(v)p Fl(,)f(whic)o(h)h(app)q(ear)g
(together)e(in)i(the)g(input)g(and)0 1345 y(separate)c(in)h(the)f(output.)71
1402 y(A)g(de\014nition)i(for)d Fg(let)i Fl(that)f(includes)i(named)f
Fg(let)g Fl(is)f(giv)o(en)h(b)q(elo)o(w:)72 1499 y(\()q Fg(de\014ne-syn)o
(tax)h(let)468 1506 y Fh(2)123 1555 y Fl(\()q Fg(lam)o(b)q(da)j
Fl(\()q Fi(x)7 b Fl(\))175 1612 y(\()q Fg(syn)o(tax-case)17
b Fi(x)h Fl(\()r(\))227 1668 y(\()r(\()p 269 1668 V 281 1668
V 46 w(\()r(\()q Fi(i)e(v)6 b Fl(\))23 b Ff(:)8 b(:)g(:)f Fl(\))16
b Fi(e1)g(e2)24 b Ff(:)8 b(:)g(:)f Fl(\))247 1724 y(\()q Fg(syn)o(tax)17
b Fl(\()r(\()q Fg(lam)o(b)q(da)j Fl(\()q Fi(i)j Ff(:)8 b(:)g(:)f
Fl(\))16 b Fi(e1)g(e2)24 b Ff(:)8 b(:)g(:)f Fl(\))16 b Fi(v)24
b Ff(:)8 b(:)g(:)f Fl(\))r(\))r(\))227 1781 y(\()r(\()p 269
1781 V 281 1781 V 44 w Fi(name)18 b Fl(\()r(\()q Fi(i)e(v)6
b Fl(\))23 b Ff(:)8 b(:)g(:)f Fl(\))16 b Fi(e1)g(e2)24 b Ff(:)8
b(:)g(:)f Fl(\))247 1837 y(\()q Fg(syn)o(tax)17 b Fl(\()r(\()q
Fg(letrec)i Fl(\()r(\()q Fi(name)e Fl(\()q Fg(lam)o(b)q(da)j
Fl(\()q Fi(i)j Ff(:)8 b(:)g(:)f Fl(\))16 b Fi(e1)g(e2)24 b
Ff(:)8 b(:)g(:)f Fl(\))r(\))r(\))16 b Fi(name)5 b Fl(\))452
1894 y Fi(v)24 b Ff(:)8 b(:)g(:)f Fl(\))r(\))r(\))r(\))r(\))r(\))0
1985 y(The)20 b(\014rst)f(clause)h(is)g(iden)o(tical)i(to)c(the)i(v)o(ersion)
g(ab)q(o)o(v)o(e;)h(the)e(second)h(clause)h(de\014nes)f(the)g(named)f
Fg(let)i Fl(form)0 2042 y(in)f(terms)e(of)h Fg(letrec)p Fl(.)32
b(The)19 b(order)g(of)f(the)h(t)o(w)o(o)f(clauses)i(is)g(imp)q(ortan)o(t.)30
b(A)20 b(named)f Fg(let)h Fl(cannot)e(matc)o(h)h(the)0 2098
y(\014rst)g(clause)i(since)h(\()r(\()q Fi(i)16 b(v)6 b Fl(\))24
b Ff(:)8 b(:)g(:)f Fl(\))20 b(cannot)g(matc)o(h)f(an)h(iden)o(ti\014er.)35
b(Ho)o(w)o(ev)o(er,)20 b(if)g(the)g(clauses)h(w)o(ere)e(rev)o(ersed,)0
2155 y(some)14 b(unnamed)h Fg(let)f Fl(expressions)h(w)o(ould)f(matc)o(h)g
(the)g(named)g Fg(let)h Fl(clause,)g(since)g(the)f(pattern)g(v)m(ariable)h
Fi(name)0 2211 y Fl(matc)o(hes)g(an)o(ything.)71 2267 y(T)l(o)f(a)o(v)o(oid)h
(this)h(problem,)g(w)o(e)f(could)h(in)o(tro)q(duce)g(a)f(fender)h(to)e
(\\fend)i(o\013)t(")d(un)o(w)o(an)o(ted)i(matc)o(hes:)72 2365
y(\()q Fg(de\014ne-syn)o(tax)i(let)468 2372 y Fh(3)123 2421
y Fl(\()q Fg(lam)o(b)q(da)j Fl(\()q Fi(x)7 b Fl(\))175 2477
y(\()q Fg(syn)o(tax-case)17 b Fi(x)h Fl(\()r(\))227 2534 y(\()r(\()p
269 2534 V 281 2534 V 44 w Fi(name)g Fl(\()r(\()q Fi(i)e(v)6
b Fl(\))23 b Ff(:)8 b(:)g(:)f Fl(\))16 b Fi(e1)g(e2)24 b Ff(:)8
b(:)g(:)f Fl(\))247 2590 y(\()q Fi(identi\014er?)17 b Fl(\()q
Fg(syn)o(tax)f Fi(name)5 b Fl(\))r(\))247 2647 y(\()q Fg(syn)o(tax)17
b Fl(\()r(\()q Fg(letrec)i Fl(\()r(\()q Fi(name)e Fl(\()q Fg(lam)o(b)q(da)j
Fl(\()q Fi(i)j Ff(:)8 b(:)g(:)f Fl(\))16 b Fi(e1)g(e2)24 b
Ff(:)8 b(:)g(:)f Fl(\))r(\))r(\))16 b Fi(name)5 b Fl(\))452
2703 y Fi(v)24 b Ff(:)8 b(:)g(:)f Fl(\))r(\))r(\))964 2828
y(9)p eop
%%Page: 10 11
bop 227 49 a Fl(\()r(\()p 269 49 14 2 v 281 49 V 46 w(\()r(\()q
Fi(i)16 b(v)6 b Fl(\))23 b Ff(:)8 b(:)g(:)f Fl(\))16 b Fi(e1)g(e2)24
b Ff(:)8 b(:)g(:)f Fl(\))247 106 y(\()q Fg(syn)o(tax)17 b Fl(\()r(\()q
Fg(lam)o(b)q(da)j Fl(\()q Fi(i)j Ff(:)8 b(:)g(:)f Fl(\))16
b Fi(e1)g(e2)24 b Ff(:)8 b(:)g(:)f Fl(\))16 b Fi(v)24 b Ff(:)8
b(:)g(:)f Fl(\))r(\))r(\))r(\))r(\))r(\))0 200 y(The)19 b(fender)g(here)f
(uses)h(the)f Fi(identi\014er?)g Fl(predicate)i(to)d(ensure)i(that)f
Fi(name)g Fl(is)h(an)f(iden)o(ti\014er.)31 b(The)19 b Fg(syn)o(tax)0
256 y Fl(wrapp)q(ed)e(around)f Fi(name)g Fl(is)h(necessary)f(ev)o(en)g(in)h
(a)f(fender,)h(as)f(it)g(is)h(an)o(ywhere)f(pattern)g(v)m(ariables)h(are)f
(refer-)0 312 y(enced,)g(and)g(arbitrary)f Fg(syn)o(tax)g Fl(forms)g(ma)o(y)g
(b)q(e)h(used)g(within)h(the)f(fender,)g(just)f(as)g(they)h(can)g(b)q(e)g
(within)h(the)0 369 y(output)e(expression.)71 425 y(The)h(de\014nitions)i(ab)
q(o)o(v)o(e)e(pro)q(duce)i(correct)e(output)g(when)h(handed)g(correct)f
(input,)h(and)g(they)g(automati-)0 482 y(cally)d(c)o(hec)o(k)g(\(via)f
Fg(syn)o(tax-case)p Fl(\))g(for)g(basic)h(structural)f(errors)g(in)h(the)f
(input.)20 b(Ho)o(w)o(ev)o(er,)13 b(they)g(do)g(not)g(ensure)0
538 y(that)k(the)g(b)q(ound)i(iden)o(ti\014ers)f(are)g(indeed)h(iden)o
(ti\014ers.)28 b(The)17 b(follo)o(wing)i(v)o(ersion)e(uses)h(a)f(lo)q(cal)h
(help)h(function)0 595 y(called)e(from)d(within)j(the)e(fenders)h(to)e(p)q
(erform)h(this)h(c)o(hec)o(k:)72 694 y(\()q Fg(de\014ne-syn)o(tax)h(let)468
701 y Fh(4)123 751 y Fl(\()q Fg(letrec)i Fl(\()r(\()q Fi(al)r(l-ids?)328
807 y Fl(\()q Fg(lam)o(b)q(da)h Fl(\()q Fi(ls)5 b Fl(\))380
864 y(\()q Fg(or)18 b Fl(\()q Fi(nul)r(l?)e(ls)5 b Fl(\))465
920 y(\()q Fg(and)19 b Fl(\()q Fi(identi\014er?)e Fl(\()q Fi(c)n(ar)f(ls)5
b Fl(\))r(\))586 977 y(\()q Fi(al)r(l-ids?)17 b Fl(\()q Fi(c)n(dr)f(ls)5
b Fl(\))r(\))r(\))r(\))r(\))r(\))r(\))175 1033 y(\()q Fg(lam)o(b)q(da)20
b Fl(\()q Fi(x)7 b Fl(\))227 1090 y(\()q Fg(syn)o(tax-case)17
b Fi(x)h Fl(\()r(\))279 1146 y(\()r(\()p 321 1146 V 332 1146
V 45 w(\()r(\()q Fi(i)e(v)6 b Fl(\))24 b Ff(:)8 b(:)g(:)f Fl(\))16
b Fi(e1)g(e2)24 b Ff(:)8 b(:)g(:)f Fl(\))299 1202 y(\()q Fi(al)r(l-ids?)17
b Fl(\()q Fg(syn)o(tax)g Fl(\()q Fi(i)24 b Ff(:)8 b(:)g(:)f
Fl(\))r(\))r(\))299 1259 y(\()q Fg(syn)o(tax)17 b Fl(\()r(\()q
Fg(lam)o(b)q(da)j Fl(\()q Fi(i)j Ff(:)8 b(:)g(:)f Fl(\))16
b Fi(e1)g(e2)24 b Ff(:)8 b(:)g(:)f Fl(\))16 b Fi(v)24 b Ff(:)8
b(:)g(:)e Fl(\))r(\))r(\))279 1315 y(\()r(\()p 321 1315 V 332
1315 V 44 w Fi(name)18 b Fl(\()r(\()q Fi(i)d(v)6 b Fl(\))24
b Ff(:)8 b(:)g(:)f Fl(\))16 b Fi(e1)g(e2)24 b Ff(:)8 b(:)g(:)f
Fl(\))299 1372 y(\()q Fi(al)r(l-ids?)17 b Fl(\()q Fg(syn)o(tax)g
Fl(\()q Fi(name)f(i)24 b Ff(:)8 b(:)g(:)f Fl(\))r(\))r(\))299
1428 y(\()q Fg(syn)o(tax)17 b Fl(\()r(\()q Fg(letrec)i Fl(\()r(\()q
Fi(name)e Fl(\()q Fg(lam)o(b)q(da)i Fl(\()q Fi(i)24 b Ff(:)8
b(:)g(:)f Fl(\))16 b Fi(e1)g(e2)24 b Ff(:)8 b(:)g(:)f Fl(\))r(\))r(\))16
b Fi(name)5 b Fl(\))504 1485 y Fi(v)24 b Ff(:)8 b(:)g(:)f Fl(\))r(\))r(\))r
(\))r(\))r(\))r(\))71 1579 y(These)16 b(fenders)h(successfully)i(reject)d
(input)h(expressions)g(that)f(do)g(not)g(ha)o(v)o(e)g(iden)o(ti\014ers)i
(where)f(they)f(are)0 1635 y(exp)q(ected,)e(but)f(the)g(resulting)i(error)d
(message)g(rep)q(orted)i(will)g(not)f(sa)o(y)f(wh)o(y)h(the)g(input)h(w)o(as)
e(rejected.)20 b(W)l(e)13 b(can)0 1691 y(re\014ne)18 b(the)g(macro)e(to)h(do)
g(so)h(b)o(y)f(mo)o(ving)g(the)h(test)f(in)o(to)g(the)g(output)h(expression)g
(and)g(calling)h Fi(syntax-err)n(or)0 1748 y Fl(directly:)72
1848 y(\()q Fg(de\014ne-syn)o(tax)e(let)468 1855 y Fh(5)123
1904 y Fl(\()q Fg(lam)o(b)q(da)j Fl(\()q Fi(x)7 b Fl(\))175
1960 y(\()q Fg(de\014ne)18 b Fi(al)r(l-ids?)227 2017 y Fl(\()q
Fg(lam)o(b)q(da)h Fl(\()q Fi(ls)5 b Fl(\))279 2073 y(\()q Fg(or)18
b Fl(\()q Fi(nul)r(l?)e(ls)5 b Fl(\))364 2130 y(\()q Fg(and)19
b Fl(\()q Fi(identi\014er?)d Fl(\()q Fi(c)n(ar)g(ls)5 b Fl(\))r(\))485
2186 y(\()q Fi(al)r(l-ids?)17 b Fl(\()q Fi(c)n(dr)f(ls)5 b
Fl(\))r(\))r(\))r(\))r(\))r(\))175 2243 y(\()q Fg(syn)o(tax-case)17
b Fi(x)h Fl(\()r(\))227 2299 y(\()r(\()p 269 2299 V 281 2299
V 46 w(\()r(\()q Fi(i)e(v)6 b Fl(\))23 b Ff(:)8 b(:)g(:)f Fl(\))16
b Fi(e1)g(e2)24 b Ff(:)8 b(:)g(:)f Fl(\))247 2356 y(\()q Fg(if)19
b Fl(\()q Fi(al)r(l-ids?)e Fl(\()q Fg(syn)o(tax)h Fl(\()q Fi(i)23
b Ff(:)8 b(:)g(:)f Fl(\))r(\))r(\))315 2412 y(\()q Fg(syn)o(tax)17
b Fl(\()r(\()q Fg(lam)o(b)q(da)j Fl(\()q Fi(i)j Ff(:)8 b(:)g(:)f
Fl(\))16 b Fi(e1)g(e2)24 b Ff(:)8 b(:)g(:)f Fl(\))16 b Fi(v)24
b Ff(:)8 b(:)g(:)e Fl(\))r(\))315 2469 y(\()q Fi(syntax-err)n(or)16
b(x)g Fl(\\non-iden)o(ti\014er)h(found")q(\))r(\))r(\))227
2525 y(\()r(\()p 269 2525 V 281 2525 V 44 w Fi(name)h Fl(\()r(\()q
Fi(i)e(v)6 b Fl(\))23 b Ff(:)8 b(:)g(:)f Fl(\))16 b Fi(e1)g(e2)24
b Ff(:)8 b(:)g(:)f Fl(\))247 2581 y(\()q Fi(identi\014er?)17
b Fl(\()q Fg(syn)o(tax)f Fi(name)5 b Fl(\))r(\))247 2638 y(\()q
Fg(if)19 b Fl(\()q Fi(al)r(l-ids?)e Fl(\()q Fg(syn)o(tax)h
Fl(\()q Fi(i)23 b Ff(:)8 b(:)g(:)f Fl(\))r(\))r(\))315 2694
y(\()q Fg(syn)o(tax)17 b Fl(\()r(\()q Fg(letrec)i Fl(\()r(\()q
Fi(name)e Fl(\()q Fg(lam)o(b)q(da)j Fl(\()q Fi(i)j Ff(:)8 b(:)g(:)f
Fl(\))16 b Fi(e1)g(e2)24 b Ff(:)8 b(:)g(:)f Fl(\))r(\))r(\))16
b Fi(name)5 b Fl(\))952 2828 y(10)p eop
%%Page: 11 12
bop 520 49 a Fi(v)24 b Ff(:)8 b(:)g(:)f Fl(\))r(\))315 106
y(\()q Fi(syntax-err)n(or)16 b(x)g Fl(\\non-iden)o(ti\014er)h(found")q(\))r
(\))r(\))r(\))r(\))r(\))0 200 y(The)g(c)o(hec)o(k)g(to)f(mak)o(e)h(sure)g
Fi(name)f Fl(is)i(an)e(iden)o(ti\014er)j(is)e(left)g(as)g(a)f(fender)h(in)h
(the)f(last)g(clause,)h(since)f(failure)h(of)0 256 y(that)c(test)h(ma)o(y)g
(b)q(e)g(due)h(to)f(a)g(more)g(general)g(syn)o(tax)g(error,)f(e.g.:)72
356 y(\()q Fg(let)19 b Fl(\()r(\()q Fi(a)d Fl(3)q(\))h(\()q
Fi(b)f Fl(4)f(5)q(\))r(\))i(\()r(\()q Fi(a)f Fl(0)q(\))r(\))g
Fi(b)t Fl(\))0 449 y(No)o(w)f(supp)q(ose)g(w)o(e)g(are)g(handed)h(a)f(form)g
(con)o(taining)h(duplicate)h(b)q(ound)f(iden)o(ti\014ers:)72
549 y(\()q Fg(let)j Fl(\()r(\()q Fi(x)d Fl(3)q(\))h(\()q Fi(x)f
Fl(4)q(\))r(\))h(\()q(+)e Fi(x)i(y)5 b Fl(\))r(\))0 643 y(The)15
b(follo)o(wing)h(v)o(ersion)g(c)o(hec)o(ks)f(for)g(this)g(condition)i(as)e(w)
o(ell:)72 742 y(\()q Fg(de\014ne-syn)o(tax)i(let)468 749 y
Fh(6)123 799 y Fl(\()q Fg(lam)o(b)q(da)j Fl(\()q Fi(x)7 b Fl(\))175
855 y(\()q Fg(de\014ne)18 b Fi(unique-ids?)227 912 y Fl(\()q
Fg(lam)o(b)q(da)h Fl(\()q Fi(ls)5 b Fl(\))279 968 y(\()q Fg(and)19
b Fl(\()q Fg(let)f Fi(al)r(l-ids?)f Fl(\()r(\()q Fi(ls)e(ls)5
b Fl(\))r(\))451 1025 y(\()q Fg(or)18 b Fl(\()q Fi(nul)r(l?)e(ls)5
b Fl(\))536 1081 y(\()q Fg(and)19 b Fl(\()q Fi(identi\014er?)e
Fl(\()q Fi(c)n(ar)f(ls)5 b Fl(\))r(\))657 1138 y(\()q Fi(al)r(l-ids?)18
b Fl(\()q Fi(c)n(dr)e(ls)5 b Fl(\))r(\))r(\))r(\))r(\))400
1194 y(\()q Fg(let)18 b Fi(unique?)f Fl(\()r(\()q Fi(ls)f(ls)5
b Fl(\))r(\))451 1251 y(\()q Fg(or)18 b Fl(\()q Fi(nul)r(l?)e(ls)5
b Fl(\))536 1307 y(\()q Fg(and)19 b Fl(\()q Fg(let)f Fi(notmem?)g
Fl(\()r(\()q Fi(x)f Fl(\()q Fi(c)n(ar)f(ls)5 b Fl(\))r(\))17
b(\()q Fi(ls)f Fl(\()q Fi(c)n(dr)g(ls)5 b Fl(\))r(\))r(\))709
1363 y(\()q Fg(or)18 b Fl(\()q Fi(nul)r(l?)e(ls)5 b Fl(\))794
1420 y(\()q Fg(and)19 b Fl(\()q Fi(not)e Fl(\()q Fi(b)n(ound-identi\014er=?)f
(x)h Fl(\()q Fi(c)n(ar)f(ls)5 b Fl(\))r(\))r(\))915 1476 y(\()q
Fi(notmem?)16 b(x)i Fl(\()q Fi(c)n(dr)e(ls)5 b Fl(\))r(\))r(\))r(\))r(\))657
1533 y(\()q Fi(unique?)18 b Fl(\()q Fi(c)n(dr)e(ls)5 b Fl(\))r(\))r(\))r(\))r
(\))r(\))r(\))r(\))175 1589 y(\()q Fg(syn)o(tax-case)17 b Fi(x)h
Fl(\()r(\))227 1646 y(\()r(\()p 269 1646 14 2 v 281 1646 V
46 w(\()r(\()q Fi(i)e(v)6 b Fl(\))23 b Ff(:)8 b(:)g(:)f Fl(\))16
b Fi(e1)g(e2)24 b Ff(:)8 b(:)g(:)f Fl(\))247 1702 y(\()q Fg(if)19
b Fl(\()q Fi(unique-ids?)e Fl(\()q Fg(syn)o(tax)h Fl(\()q Fi(i)23
b Ff(:)8 b(:)g(:)f Fl(\))r(\))r(\))315 1759 y(\()q Fg(syn)o(tax)17
b Fl(\()r(\()q Fg(lam)o(b)q(da)j Fl(\()q Fi(i)j Ff(:)8 b(:)g(:)f
Fl(\))16 b Fi(e1)g(e2)24 b Ff(:)8 b(:)g(:)f Fl(\))16 b Fi(v)24
b Ff(:)8 b(:)g(:)e Fl(\))r(\))315 1815 y(\()q Fi(syntax-err)n(or)16
b(x)g Fl(\\non-iden)o(ti\014er)h(or)e(duplicate)i(iden)o(ti\014er)g(found")q
(\))r(\))r(\))227 1872 y(\()r(\()p 269 1872 V 281 1872 V 44
w Fi(name)h Fl(\()r(\()q Fi(i)e(v)6 b Fl(\))23 b Ff(:)8 b(:)g(:)f
Fl(\))16 b Fi(e1)g(e2)24 b Ff(:)8 b(:)g(:)f Fl(\))247 1928
y(\()q Fi(identi\014er?)17 b Fl(\()q Fg(syn)o(tax)f Fi(name)5
b Fl(\))r(\))247 1984 y(\()q Fg(if)19 b Fl(\()q Fi(unique-ids?)e
Fl(\()q Fg(syn)o(tax)h Fl(\()q Fi(i)23 b Ff(:)8 b(:)g(:)f Fl(\))r(\))r(\))315
2041 y(\()q Fg(syn)o(tax)17 b Fl(\()r(\()q Fg(letrec)i Fl(\()r(\()q
Fi(name)e Fl(\()q Fg(lam)o(b)q(da)j Fl(\()q Fi(i)j Ff(:)8 b(:)g(:)f
Fl(\))16 b Fi(e1)g(e2)24 b Ff(:)8 b(:)g(:)f Fl(\))r(\))r(\))16
b Fi(name)5 b Fl(\))520 2097 y Fi(v)24 b Ff(:)8 b(:)g(:)f Fl(\))r(\))315
2154 y(\()q Fi(syntax-err)n(or)16 b(x)g Fl(\\non-iden)o(ti\014er)h(or)e
(duplicate)i(iden)o(ti\014er)g(found")q(\))r(\))r(\))r(\))r(\))r(\))0
2248 y(Using)i Fi(b)n(ound-identi\014er=?)e Fl(allo)o(ws)i
Fg(let)g Fl(to)e(reject)h(only)h(those)f(forms)f(that)g(w)o(ould)i(result)f
(in)h(a)f(con\015ict.)30 b(If)0 2304 y(the)20 b(de\014nition)i(w)o(ere)e(to)g
(emplo)o(y)h Fi(fr)n(e)n(e-identi\014er=?)e Fl(instead,)i(the)g(follo)o(wing)
g(correct)f(program)f(w)o(ould)h(b)q(e)0 2361 y(rejected:)952
2828 y(11)p eop
%%Page: 12 13
bop 72 49 a Fl(\()q Fg(let-syn)o(tax)18 b Fl(\()r(\()q Fg(f)e
Fl(\()q Fg(lam)o(b)q(da)k Fl(\()q Fi(x)7 b Fl(\))457 106 y(\()q
Fg(syn)o(tax-case)17 b Fi(x)h Fl(\()r(\))509 162 y(\()r(\()p
551 162 14 2 v 563 162 V 44 w Fi(a)5 b Fl(\))17 b(\()q Fg(syn)o(tax)h
Fl(\()q Fg(let)h Fl(\()r(\()q Fi(a)d Fl(1)q(\))h(\()q Fi(b)f
Fl(2)q(\))r(\))h(\()q(+)f Fi(a)g(b)t Fl(\))r(\))r(\))r(\))r(\))r(\))r(\))r
(\))123 219 y(\()q Fg(f)f Fi(b)t Fl(\))r(\))0 312 y(Although)f(the)f(macro)g
(call)i(\()q Fg(f)g Fi(b)t Fl(\))f(apparen)o(tly)g(expands)g(in)o(to)g(\()q
Fg(let)19 b Fl(\()r(\()q Fi(b)d Fl(1)q(\))h(\()q Fi(b)f Fl(2)q(\))r(\))h(\()q
(+)e Fi(b)i(b)t Fl(\))r(\),)d(this)f(program)f(is)0 369 y(actually)h(correct)
e(b)q(ecause)i(the)f(in)o(tro)q(duced)h(iden)o(ti\014er)g Fi(b)f
Fl(is)g(renamed)g(to)g(a)o(v)o(oid)f(an)o(y)h(suc)o(h)g(con\015icts.)19
b(Ho)o(w)o(ev)o(er,)0 425 y(since)g(b)q(oth)f(o)q(ccurrences)h(of)f
Fi(b)p Fl(,)g(if)h(left)f(as)g(free)g(references,)h(w)o(ould)f(refer)g(to)g
(the)g(same)f(\(top-lev)o(el\))i(binding)0 482 y(for)14 b Fi(b)p
Fl(,)g Fi(fr)n(e)n(e-identi\014er=?)g Fl(w)o(ould)h(not)f(distinguish)i
(them.)k(Since)c(the)f(in)o(tended)h(use)f(in)g(this)g(case)g(is)g(as)f(b)q
(ound)0 538 y(v)m(ariables,)i(the)f(predicate)i Fi(b)n(ound-identi\014er=?)d
Fl(is)i(used)g(instead.)71 595 y(This)k(sequence)h(of)e Fg(let)i
Fl(de\014nitions)h(ends)e(with)g(the)g(follo)o(wing)h(v)o(ersion)f(of)f
Fg(let)i Fl(that)e(allo)o(ws)h(the)g(v)m(alue)0 651 y(expressions)c(to)f(b)q
(e)g(\\implicit)j(b)q(egin")e(expressions:)72 751 y(\()q Fg(de\014ne-syn)o
(tax)h(let)468 758 y Fh(7)123 807 y Fl(\()q Fg(lam)o(b)q(da)j
Fl(\()q Fi(x)7 b Fl(\))175 864 y(\()q Fg(syn)o(tax-case)17
b Fi(x)h Fl(\()r(\))227 920 y(\()r(\()p 269 920 V 281 920 V
46 w(\()r(\()q Fi(i)e(v1)g(v2)24 b Ff(:)8 b(:)g(:)f Fl(\))23
b Ff(:)8 b(:)g(:)f Fl(\))16 b Fi(e1)g(e2)24 b Ff(:)8 b(:)g(:)f
Fl(\))247 977 y(\()q Fg(syn)o(tax)17 b Fl(\()r(\()q Fg(lam)o(b)q(da)j
Fl(\()q Fi(i)j Ff(:)8 b(:)g(:)f Fl(\))16 b Fi(e1)g(e2)24 b
Ff(:)8 b(:)g(:)f Fl(\))453 1033 y(\()q Fg(b)q(egin)19 b Fi(v1)d(v2)24
b Ff(:)8 b(:)g(:)f Fl(\))460 1090 y Ff(:)h(:)g(:)f Fl(\))r(\))r(\))r(\))r(\))
r(\))0 1183 y(Although)16 b Fg(let)259 1190 y Fh(7)294 1183
y Fl(is)g(not)e(a)h(particularly)i(useful)f(construct)e(since)j(the)e(order)g
(of)f(ev)m(aluation)j(of)d Fg(lam)o(b)q(da)i Fl(argu-)0 1240
y(men)o(ts)i(\(and)g Fg(let)h Fl(v)m(alue)h(expressions\))f(is)g(unsp)q
(eci\014ed,)i(this)e(example)g(do)q(es)g(serv)o(e)f(to)g(illustrate)h(the)g
(use)f(of)0 1296 y(nested)e(ellipses.)71 1353 y(Sometimes)h(it)h(is)g(useful)
h(to)e(create)g(pattern)g(v)m(ariable)i(bindings)h(to)d(hold)h(in)o
(termediate)g(output)g(within)0 1409 y(the)h(b)q(o)q(dy)g(of)f(a)g(macro.)29
b(F)l(or)18 b(this)h(purp)q(ose,)h(w)o(e)e(can)h(de\014ne)g(a)f(lo)q(cal)i
(binding)h(op)q(erator)c(for)h(pattern)g(v)m(ari-)0 1466 y(ables)g(similar)h
(to)e Fg(let)h Fl(for)f(ordinary)h(v)m(ariables.)28 b(The)18
b Fg(with-syn)o(tax)g Fl(form)f(de\014ned)h(b)q(elo)o(w)h(expands)f(in)o(to)f
(a)0 1522 y Fg(syn)o(tax-case)e Fl(expression)h(with)g(a)e(single)j(clause:)
72 1622 y(\()q Fg(de\014ne-syn)o(tax)g(with-syn)o(tax)123 1678
y Fl(\()q Fg(lam)o(b)q(da)j Fl(\()q Fi(x)7 b Fl(\))175 1735
y(\()q Fg(syn)o(tax-case)17 b Fi(x)h Fl(\()r(\))227 1791 y(\()r(\()p
269 1791 V 281 1791 V 46 w(\()r(\()q Fi(p)e(e0)7 b Fl(\))24
b Ff(:)8 b(:)g(:)f Fl(\))16 b Fi(e1)g(e2)24 b Ff(:)8 b(:)g(:)f
Fl(\))247 1848 y(\()q Fg(syn)o(tax)17 b Fl(\()q Fg(syn)o(tax-case)i
Fl(\()q Fi(list)c(e0)24 b Ff(:)8 b(:)g(:)f Fl(\))17 b(\()r(\))485
1904 y(\()r(\()q Fi(p)24 b Ff(:)8 b(:)g(:)f Fl(\))17 b(\()q
Fg(b)q(egin)h Fi(e1)f(e2)24 b Ff(:)8 b(:)g(:)e Fl(\))r(\))r(\))r(\))r(\))r
(\))r(\))r(\))0 1998 y(The)13 b(follo)o(wing)g(de\014nition)h(for)d
Fg(or)h Fl(uses)h Fg(with-syn)o(tax)f Fl(in)i(its)e(third)h(clause)g(to)f
(build)i(up)f(a)f(piece)i(of)e(its)g(output)0 2054 y(separately)j(from)g(the)
g(whole:)72 2154 y(\()q Fg(de\014ne-syn)o(tax)i(or)123 2210
y Fl(\()q Fg(lam)o(b)q(da)j Fl(\()q Fi(x)7 b Fl(\))175 2267
y(\()q Fg(syn)o(tax-case)17 b Fi(x)h Fl(\()r(\))227 2323 y(\()r(\()p
269 2323 V 281 2323 V 30 w(\))g(\()q Fg(syn)o(tax)e Fl(#f)5
b(\))r(\))227 2380 y(\()r(\()p 269 2380 V 281 2380 V 44 w Fi(e)g
Fl(\))17 b(\()q Fg(syn)o(tax)f Fi(e)5 b Fl(\))r(\))227 2436
y(\()r(\()p 269 2436 V 281 2436 V 44 w Fi(e1)17 b(e2)f(e3)24
b Ff(:)8 b(:)g(:)f Fl(\))247 2493 y(\()q Fg(with-syn)o(tax)19
b Fl(\()r(\()q Fi(r)n(est)d Fl(\()q Fg(syn)o(tax)i Fl(\()q
Fg(or)f Fi(e2)f(e3)24 b Ff(:)8 b(:)g(:)f Fl(\))r(\))r(\))r(\))299
2549 y(\()q Fg(syn)o(tax)17 b Fl(\()q Fg(let)i Fl(\()r(\()q
Fi(t)e(e1)7 b Fl(\))r(\))17 b(\()q Fg(if)h Fi(t)e(t)g(r)n(est)5
b Fl(\))r(\))r(\))r(\))r(\))r(\))r(\))r(\))0 2643 y(The)15
b(de\014nition)i(for)e Fg(do)g Fl(b)q(elo)o(w)h(sho)o(ws)f(a)g(more)f
(realistic)j(use)e(for)g Fg(with-syn)o(tax)p Fl(:)952 2828
y(12)p eop
%%Page: 13 14
bop 72 49 a Fl(\()q Fg(de\014ne-syn)o(tax)17 b(do)123 106 y
Fl(\()q Fg(lam)o(b)q(da)j Fl(\()q Fi(orig-x)7 b Fl(\))175 162
y(\()q Fg(syn)o(tax-case)17 b Fi(orig-x)h Fl(\()r(\))227 219
y(\()r(\()p 269 219 14 2 v 281 219 V 46 w(\()r(\()q Fi(var)e(init)g(.)g(step)
t Fl(\))23 b Ff(:)8 b(:)g(:)f Fl(\))17 b(\()q Fi(e0)f(e1)24
b Ff(:)8 b(:)g(:)f Fl(\))16 b Fi(c)24 b Ff(:)8 b(:)g(:)f Fl(\))247
275 y(\()q Fg(with-syn)o(tax)19 b Fl(\()r(\()r(\()q Fi(step)k
Ff(:)8 b(:)g(:)f Fl(\))592 332 y(\()q Fi(map)18 b Fl(\()q Fg(lam)o(b)q(da)i
Fl(\()q Fi(v)c(s)5 b Fl(\))764 388 y(\()q Fg(syn)o(tax-case)17
b Fi(s)g Fl(\()r(\))816 444 y(\()r(\()r(\))f Fi(v)6 b Fl(\))816
501 y(\()r(\()q Fi(e)f Fl(\))16 b(\()q Fg(syn)o(tax)g Fi(e)5
b Fl(\))r(\))816 557 y(\()p 838 557 V 850 557 V 45 w(\()q Fi(syntax-err)n(or)
17 b(orig-x)7 b Fl(\))r(\))r(\))r(\))712 614 y(\()q Fg(syn)o(tax)18
b Fl(\()q Fi(var)24 b Ff(:)8 b(:)g(:)e Fl(\))r(\))712 670 y(\()q
Fg(syn)o(tax)18 b Fl(\()q Fi(step)23 b Ff(:)8 b(:)g(:)f Fl(\))r(\))r(\))r(\))
r(\))299 727 y(\()q Fg(syn)o(tax-case)18 b Fl(\()q Fg(syn)o(tax)f
Fl(\()q Fi(e1)24 b Ff(:)8 b(:)g(:)f Fl(\))r(\))17 b(\()r(\))350
783 y(\()r(\()r(\))g(\()q Fg(syn)o(tax)h Fl(\()q Fg(let)g Fi(dolo)n(op)g
Fl(\()r(\()q Fi(var)e(init)5 b Fl(\))24 b Ff(:)8 b(:)g(:)e
Fl(\))664 840 y(\()q Fg(if)19 b Fl(\()q Fi(not)d(e0)7 b Fl(\))732
896 y(\()q Fg(b)q(egin)18 b Fi(c)24 b Ff(:)8 b(:)g(:)23 b Fl(\()q
Fi(dolo)n(op)16 b(step)24 b Ff(:)8 b(:)g(:)f Fl(\))r(\))r(\))r(\))r(\))r(\))
350 953 y(\()r(\()q Fi(e1)17 b(e2)24 b Ff(:)8 b(:)g(:)e Fl(\))370
1009 y(\()q Fg(syn)o(tax)18 b Fl(\()q Fg(let)g Fi(dolo)n(op)g
Fl(\()r(\()q Fi(var)e(init)5 b Fl(\))24 b Ff(:)8 b(:)g(:)e
Fl(\))609 1065 y(\()q Fg(if)17 b Fi(e0)677 1122 y Fl(\()q Fg(b)q(egin)h
Fi(e1)e(e2)24 b Ff(:)8 b(:)g(:)f Fl(\))677 1178 y(\()q Fg(b)q(egin)18
b Fi(c)24 b Ff(:)8 b(:)g(:)23 b Fl(\()q Fi(dolo)n(op)16 b(step)24
b Ff(:)8 b(:)g(:)f Fl(\))r(\))r(\))r(\))r(\))r(\))r(\))r(\))r(\))r(\))r(\))r
(\))0 1272 y(This)19 b(de\014nition)g(is)g(ungraceful,)g(but)f(then)g(so)g
(is)g Fg(do)g Fl(with)g(its)h(optional)f(steps)g(and)g(optional)h(return-v)m
(alue)0 1329 y(expressions.)71 1385 y(The)11 b Fg(with-syn)o(tax)h
Fl(form)e(can)i(also)f(b)q(e)h(used)g(to)e(bind)j(pattern)e(v)m(ariables)i
(to)d(output)h(from)g(help)i(functions,)0 1442 y(as)i(in)h(the)f
(de\014nition)i(for)e Fg(letrec)g Fl(b)q(elo)o(w:)72 1541 y(\()q
Fg(de\014ne-syn)o(tax)i(letrec)123 1598 y Fl(\()q Fg(lam)o(b)q(da)j
Fl(\()q Fi(x)7 b Fl(\))175 1654 y(\()q Fg(syn)o(tax-case)17
b Fi(x)h Fl(\()r(\))227 1711 y(\()r(\()p 269 1711 V 281 1711
V 46 w(\()r(\()q Fi(i)e(v)6 b Fl(\))23 b Ff(:)8 b(:)g(:)f Fl(\))16
b Fi(e1)g(e2)24 b Ff(:)8 b(:)g(:)f Fl(\))247 1767 y(\()q Fg(with-syn)o(tax)19
b Fl(\()r(\()r(\()q Fi(t)k Ff(:)8 b(:)g(:)f Fl(\))17 b(\()q
Fi(gener)n(ate-temp)n(or)n(aries)g Fl(\()q Fg(syn)o(tax)g Fl(\()q
Fi(i)24 b Ff(:)8 b(:)g(:)f Fl(\))r(\))r(\))r(\))r(\))299 1823
y(\()q Fg(syn)o(tax)17 b Fl(\()q Fg(let)i Fl(\()r(\()q Fi(i)d
Fl(#f)5 b(\))23 b Ff(:)8 b(:)g(:)f Fl(\))537 1880 y(\()q Fg(let)19
b Fl(\()r(\()q Fi(t)d(v)6 b Fl(\))24 b Ff(:)8 b(:)g(:)f Fl(\))589
1936 y(\()q Fg(set!)17 b Fi(i)f(t)5 b Fl(\))24 b Ff(:)8 b(:)g(:)588
1993 y Fi(e1)16 b(e2)24 b Ff(:)8 b(:)g(:)f Fl(\))r(\))r(\))r(\))r(\))r(\))r
(\))r(\))71 2087 y(The)19 b Fg(cond)h Fl(syn)o(tactic)g(form)f(is)h(one)g(of)
f(the)h(most)e(complex)j(built-in)h(forms,)d(y)o(et)h(to)f(come)g(up)h(with)g
(a)0 2143 y(macro)12 b(for)h(cond)h(that)e(w)o(orks)g(is)i(not)f(terribly)h
(di\016cult.)21 b(W)l(e)13 b(sho)o(w)f(here)i(a)f(series)h(of)f
(de\014nitions)i(of)d(cond)i(eac)o(h)0 2200 y(with)i(di\013eren)o(t)f(prop)q
(erties.)71 2256 y(Here)g(is)h(the)f(\014rst)g(and)g(simplest)h(de\014nition)
h(in)g(the)e(series:)72 2356 y(\()q Fg(de\014ne-syn)o(tax)i(cond)517
2363 y Fh(1)123 2412 y Fl(\()q Fg(lam)o(b)q(da)j Fl(\()q Fi(x)7
b Fl(\))175 2469 y(\()q Fg(syn)o(tax-case)17 b Fi(x)h Fl(\()q
Fg(else)f Fl(=)-8 b Ff(>)q Fl(\))227 2525 y(\()r(\()p 269 2525
V 281 2525 V 46 w(\()q Fg(else)17 b Fi(e1)f(e2)24 b Ff(:)8
b(:)g(:)f Fl(\))r(\))247 2581 y(\()q Fg(syn)o(tax)17 b Fl(\()q
Fg(b)q(egin)i Fi(e1)d(e2)24 b Ff(:)8 b(:)g(:)f Fl(\))r(\))r(\))227
2638 y(\()r(\()p 269 2638 V 281 2638 V 46 w(\()q Fi(e0)g Fl(\))r(\))247
2694 y(\()q Fg(syn)o(tax)17 b Fl(\()q Fg(let)j Fl(\()r(\()q
Fi(t)c(e0)7 b Fl(\))r(\))17 b(\()q Fg(if)h Fi(t)e(t)5 b Fl(\))r(\))r(\))r(\))
952 2828 y(13)p eop
%%Page: 14 15
bop 227 49 a Fl(\()r(\()p 269 49 14 2 v 281 49 V 46 w(\()q
Fi(e0)7 b Fl(\))16 b Fi(c1)g(c2)24 b Ff(:)8 b(:)g(:)f Fl(\))247
106 y(\()q Fg(syn)o(tax)17 b Fl(\()q Fg(let)j Fl(\()r(\()q
Fi(t)c(e0)7 b Fl(\))r(\))17 b(\()q Fg(if)h Fi(t)e(t)i Fl(\()q
Fg(cond)963 113 y Fh(1)1000 106 y Fi(c1)f(c2)24 b Ff(:)8 b(:)g(:)e
Fl(\))r(\))r(\))r(\))r(\))227 162 y(\()r(\()p 269 162 V 281
162 V 46 w(\()q Fi(e0)16 b Fl(=)-8 b Ff(>)17 b Fi(e1)7 b Fl(\))r(\))17
b(\()q Fg(syn)o(tax)g Fl(\()q Fg(let)j Fl(\()r(\()q Fi(t)c(e0)7
b Fl(\))r(\))17 b(\()q Fg(if)h Fi(t)g Fl(\()q Fi(e1)e(t)5 b
Fl(\))r(\))r(\))r(\))r(\))227 219 y(\()r(\()p 269 219 V 281
219 V 46 w(\()q Fi(e0)16 b Fl(=)-8 b Ff(>)17 b Fi(e1)7 b Fl(\))16
b Fi(c1)g(c2)24 b Ff(:)8 b(:)g(:)f Fl(\))247 275 y(\()q Fg(syn)o(tax)17
b Fl(\()q Fg(let)j Fl(\()r(\()q Fi(t)c(e0)7 b Fl(\))r(\))17
b(\()q Fg(if)h Fi(t)f Fl(\()q Fi(e1)g(t)5 b Fl(\))17 b(\()q
Fg(cond)1066 282 y Fh(1)1104 275 y Fi(c1)f(c2)24 b Ff(:)8 b(:)g(:)f
Fl(\))r(\))r(\))r(\))r(\))227 332 y(\()r(\()p 269 332 V 281
332 V 46 w(\()q Fi(e0)16 b(e1)g(e2)24 b Ff(:)8 b(:)g(:)f Fl(\))r(\))17
b(\()q Fg(syn)o(tax)h Fl(\()q Fg(if)f Fi(e0)h Fl(\()q Fg(b)q(egin)g
Fi(e1)f(e2)24 b Ff(:)8 b(:)g(:)e Fl(\))r(\))r(\))r(\))227 388
y(\()r(\()p 269 388 V 281 388 V 46 w(\()q Fi(e0)16 b(e1)g(e2)24
b Ff(:)8 b(:)g(:)f Fl(\))16 b Fi(c1)g(c2)24 b Ff(:)8 b(:)g(:)f
Fl(\))247 444 y(\()q Fg(syn)o(tax)17 b Fl(\()q Fg(if)h Fi(e0)g
Fl(\()q Fg(b)q(egin)g Fi(e1)f(e2)23 b Ff(:)8 b(:)g(:)f Fl(\))17
b(\()q Fg(cond)1073 451 y Fh(1)1111 444 y Fi(c1)f(c2)24 b Ff(:)8
b(:)g(:)f Fl(\))r(\))r(\))r(\))r(\))r(\))r(\))0 536 y(Notice)19
b(the)g(app)q(earance)g(of)f Fg(else)g Fl(and)h(=)-8 b Ff(>)19
b Fl(in)g(the)g(literals)g(list.)31 b(This)19 b(informs)f Fg(syn)o(tax-case)h
Fl(that)e(when)0 592 y(these)d(iden)o(ti\014ers)i(app)q(ear)e(in)g(the)g
(pattern,)g(they)g(are)f(literals)i(rather)f(than)f(pattern)h(v)m(ariables.)
21 b(The)14 b(order)f(of)0 648 y(the)h(clauses)g(in)g(this)g(de\014nition)h
(is)f(imp)q(ortan)o(t,)f(although)h(some)f(rearrangemen)o(t)f(could)j(b)q(e)f
(done.)20 b(In)14 b(general,)0 705 y(more)i(sp)q(eci\014c)i(patterns)e(m)o
(ust)f(app)q(ear)i(b)q(efore)f(more)g(general)h(patterns)e(that)h(migh)o(t)g
(also)g(matc)o(h)g(the)g(same)0 761 y(input,)e(so)f(the)h(\()p
285 761 V 297 761 V 46 w(\()q Fg(else)j Fi(e1)f(e2)24 b Ff(:)8
b(:)g(:)f Fl(\))24 b Ff(:)8 b(:)g(:)e Fl(\))14 b(pattern)f(m)o(ust)f(app)q
(ear)h(b)q(efore)h(the)g(\()p 1423 761 V 1435 761 V 46 w(\()q
Fi(e0)i(e1)g(e2)7 b Fl(\))24 b Ff(:)8 b(:)g(:)f Fl(\))14 b(pattern,)0
818 y(and)h(the)h(patterns)e(that)h(c)o(hec)o(k)g(for)g(=)-8
b Ff(>)15 b Fl(m)o(ust)g(app)q(ear)g(b)q(efore)h(the)f(last)g(t)o(w)o(o)f
(patterns.)71 874 y(The)h(output)g(of)g(the)g(second)h(clause)g(could)g
(simply)h(b)q(e)g(\()q Fg(syn)o(tax)f Fi(e0)7 b Fl(\))q(:)72
972 y(\()r(\()p 114 972 V 125 972 V 45 w(\()q Fi(e0)g Fl(\))r(\))18
b(\()q Fg(syn)o(tax)e Fi(e0)7 b Fl(\))r(\))0 1063 y(Ho)o(w)o(ev)o(er,)14
b(w)o(e)h(c)o(ho)q(ose)h(to)f(use)g(the)h(more)f(complicated)i(form)d(to)h(a)
o(v)o(oid)g(sp)q(ecifying)j(a)d(return)g(result)h(when)g Fi(e0)0
1120 y Fl(ev)m(aluates)g(to)f(false.)21 b(Instead,)16 b(the)g(\(implemen)o
(tation-dep)q(enden)o(t\))i(v)m(alue)e(is)g(determined)h(b)o(y)f(the)f
(else-less)j Fg(if)0 1176 y Fl(expression.)71 1233 y(The)d(output)f(of)h(the)
g(third)g(clause)h(ab)q(o)o(v)o(e)f(could)h(b)q(e)f(written)g(in)h(terms)e
(of)h Fg(or)o Fl(,)g(though)g(w)o(e)f(c)o(ho)q(ose)h(not)g(to)0
1289 y(for)g(consistency)h(with)f(the)h(preceding)g(clause.)72
1386 y(\()r(\()p 114 1386 V 125 1386 V 45 w(\()q Fi(e0)7 b
Fl(\))17 b Fi(c1)f(c2)24 b Ff(:)8 b(:)g(:)f Fl(\))92 1443 y(\()q
Fg(syn)o(tax)17 b Fl(\()q Fg(or)g Fi(e0)h Fl(\()q Fg(cond)550
1450 y Fh(1)587 1443 y Fi(c1)e(c2)24 b Ff(:)8 b(:)g(:)f Fl(\))r(\))r(\))r(\))
71 1534 y(The)k(next)h(v)o(ersion)g(of)f Fg(cond)h Fl(sho)o(ws)f(ho)o(w)g
Fi(fr)n(e)n(e-identi\014er=?)f Fl(could)j(b)q(e)f(used)g(in)h(place)f(of)g
(the)f Fg(syn)o(tax-case)0 1590 y Fl(literals)16 b(list.)21
b(It)15 b(also)g(pro)o(vides)h(a)f(go)q(o)q(d)g(example)h(of)f(the)g(use)h
(of)f(fenders:)72 1687 y(\()q Fg(de\014ne-syn)o(tax)i(cond)517
1694 y Fh(2)123 1744 y Fl(\()q Fg(lam)o(b)q(da)j Fl(\()q Fi(x)7
b Fl(\))175 1800 y(\()q Fg(syn)o(tax-case)17 b Fi(x)h Fl(\()r(\))227
1856 y(\()r(\()p 269 1856 V 281 1856 V 46 w(\()q Fi(x)e(e1)g(e2)24
b Ff(:)8 b(:)g(:)f Fl(\))r(\))247 1913 y(\()q Fg(and)19 b Fl(\()q
Fi(identi\014er?)e Fl(\()q Fg(syn)o(tax)f Fi(x)7 b Fl(\))r(\))368
1969 y(\()q Fi(fr)n(e)n(e-identi\014er=?)16 b Fl(\()q Fg(syn)o(tax)g
Fi(x)7 b Fl(\))17 b(\()q Fg(syn)o(tax)f(else)q Fl(\))r(\))r(\))247
2026 y(\()q Fg(syn)o(tax)h Fl(\()q Fg(b)q(egin)i Fi(e1)d(e2)24
b Ff(:)8 b(:)g(:)f Fl(\))r(\))r(\))227 2082 y(\()r(\()p 269
2082 V 281 2082 V 46 w(\()q Fi(e0)g Fl(\))r(\))247 2139 y(\()q
Fg(syn)o(tax)17 b Fl(\()q Fg(let)j Fl(\()r(\()q Fi(t)c(e0)7
b Fl(\))r(\))17 b(\()q Fg(if)h Fi(t)e(t)5 b Fl(\))r(\))r(\))r(\))227
2195 y(\()r(\()p 269 2195 V 281 2195 V 46 w(\()q Fi(e0)i Fl(\))16
b Fi(c1)g(c2)24 b Ff(:)8 b(:)g(:)f Fl(\))247 2252 y(\()q Fg(syn)o(tax)17
b Fl(\()q Fg(let)j Fl(\()r(\()q Fi(t)c(e0)7 b Fl(\))r(\))17
b(\()q Fg(if)h Fi(t)e(t)i Fl(\()q Fg(cond)963 2259 y Fh(2)1000
2252 y Fi(c1)f(c2)24 b Ff(:)8 b(:)g(:)e Fl(\))r(\))r(\))r(\))r(\))227
2308 y(\()r(\()p 269 2308 V 281 2308 V 46 w(\()q Fi(e0)16 b(x)g(e1)7
b Fl(\))r(\))247 2365 y(\()q Fg(and)19 b Fl(\()q Fi(identi\014er?)e
Fl(\()q Fg(syn)o(tax)f Fi(x)7 b Fl(\))r(\))368 2421 y(\()q
Fi(fr)n(e)n(e-identi\014er=?)16 b Fl(\()q Fg(syn)o(tax)g Fi(x)7
b Fl(\))17 b(\()q Fg(syn)o(tax)f Fl(=)-8 b Ff(>)q Fl(\))r(\))r(\))247
2477 y(\()q Fg(syn)o(tax)17 b Fl(\()q Fg(let)j Fl(\()r(\()q
Fi(t)c(e0)7 b Fl(\))r(\))17 b(\()q Fg(if)h Fi(t)f Fl(\()q Fi(e1)g(t)5
b Fl(\))r(\))r(\))r(\))r(\))227 2534 y(\()r(\()p 269 2534 V
281 2534 V 46 w(\()q Fi(e0)16 b(x)g(e1)7 b Fl(\))17 b Fi(c1)f(c2)24
b Ff(:)8 b(:)g(:)f Fl(\))247 2590 y(\()q Fg(and)19 b Fl(\()q
Fi(identi\014er?)e Fl(\()q Fg(syn)o(tax)f Fi(x)7 b Fl(\))r(\))368
2647 y(\()q Fi(fr)n(e)n(e-identi\014er=?)16 b Fl(\()q Fg(syn)o(tax)g
Fi(x)7 b Fl(\))17 b(\()q Fg(syn)o(tax)f Fl(=)-8 b Ff(>)q Fl(\))r(\))r(\))247
2703 y(\()q Fg(syn)o(tax)17 b Fl(\()q Fg(let)j Fl(\()r(\()q
Fi(t)c(e0)7 b Fl(\))r(\))17 b(\()q Fg(if)h Fi(t)f Fl(\()q Fi(e1)g(t)5
b Fl(\))17 b(\()q Fg(cond)1066 2710 y Fh(2)1104 2703 y Fi(c1)f(c2)24
b Ff(:)8 b(:)g(:)f Fl(\))r(\))r(\))r(\))r(\))952 2828 y(14)p
eop
%%Page: 15 16
bop 227 49 a Fl(\()r(\()p 269 49 14 2 v 281 49 V 46 w(\()q
Fi(e0)16 b(e1)g(e2)24 b Ff(:)8 b(:)g(:)f Fl(\))r(\))17 b(\()q
Fg(syn)o(tax)h Fl(\()q Fg(if)f Fi(e0)h Fl(\()q Fg(b)q(egin)g
Fi(e1)f(e2)24 b Ff(:)8 b(:)g(:)e Fl(\))r(\))r(\))r(\))227 106
y(\()r(\()p 269 106 V 281 106 V 46 w(\()q Fi(e0)16 b(e1)g(e2)24
b Ff(:)8 b(:)g(:)f Fl(\))16 b Fi(c1)g(c2)24 b Ff(:)8 b(:)g(:)f
Fl(\))247 162 y(\()q Fg(syn)o(tax)17 b Fl(\()q Fg(if)h Fi(e0)g
Fl(\()q Fg(b)q(egin)g Fi(e1)f(e2)23 b Ff(:)8 b(:)g(:)f Fl(\))17
b(\()q Fg(cond)1073 169 y Fh(2)1111 162 y Fi(c1)f(c2)24 b Ff(:)8
b(:)g(:)f Fl(\))r(\))r(\))r(\))r(\))r(\))r(\))71 256 y(There)19
b(is)g(nothing)g(wrong)g(with)g(the)g(output)f(from)h(either)g(of)g(the)g(t)o
(w)o(o)e(v)o(ersions)i(of)g Fg(cond)g Fl(ab)q(o)o(v)o(e,)g(but)0
312 y(b)q(ecause)e(of)g(their)g(recursiv)o(e)g(nature,)f(it)h(is)g(p)q
(ossible)h(to)e(get)g(a)g(sligh)o(tly)i(strange)d(error)h(message)g(when)h
(some)0 369 y(clause)e(other)g(than)f(the)h(\014rst)f(is)h(malformed.)k(F)l
(or)14 b(example,)h(the)g(syn)o(tax)f(error)g(rep)q(orted)g(when)h(the)g
(input)g(is)1 425 y(\()q Fg(cond)k Fl(\()q Fi(x)7 b Fl(\))17
b(\()q Fi(y)f(.)g(z)7 b Fl(\))r(\))15 b(migh)o(t)g(b)q(e:)610
532 y(Error:)k(in)o(v)m(alid)f(syn)o(tax)d(\()q Fg(cond)k Fl(\()q
Fi(y)d(.)h(z)7 b Fl(\))r(\))0 638 y(The)15 b(follo)o(wing)h(example)g(of)f
(cond)h(is)f(more)g(complex)h(than)f(the)h(previous)g(t)o(w)o(o)d(b)q(ecause)
k(it)e(recurs)g(in)o(ternally)0 694 y(so)i(that)f(it)i(alw)o(a)o(ys)e(has)h
(a)g(handle)h(on)f(the)h(original)g(input)g(expression.)27
b(It)17 b(also)g(con)o(tains)g(an)g(explicit)j(error)0 751
y(clause)c(in)g(whic)o(h)g(it)g(calls)g Fi(syntax-err)n(or)f
Fl(directly)l(.)22 b(It)15 b(uses)g Fg(with-syn)o(tax)q Fl(,)f(whic)o(h)i(w)o
(as)f(de\014ned)h(earlier.)72 850 y(\()q Fg(de\014ne-syn)o(tax)h(cond)517
857 y Fh(3)123 907 y Fl(\()q Fg(lam)o(b)q(da)j Fl(\()q Fi(orig-x)7
b Fl(\))175 963 y(\()q Fg(let)18 b Fi(do)n(c)n(ond)f Fl(\()r(\()q
Fi(x)g(orig-x)7 b Fl(\))r(\))227 1020 y(\()q Fg(syn)o(tax-case)17
b Fi(x)g Fl(\()q Fg(else)h Fl(=)-8 b Ff(>)q Fl(\))279 1076
y(\()r(\()p 321 1076 V 332 1076 V 45 w(\()q Fg(else)18 b Fi(e1)e(e2)24
b Ff(:)8 b(:)g(:)f Fl(\))r(\))17 b(\()q Fg(syn)o(tax)g Fl(\()q
Fg(b)q(egin)i Fi(e1)d(e2)24 b Ff(:)8 b(:)g(:)f Fl(\))r(\))r(\))279
1133 y(\()r(\()p 321 1133 V 332 1133 V 45 w(\()q Fi(e0)g Fl(\))r(\))299
1189 y(\()q Fg(syn)o(tax)17 b Fl(\()q Fg(let)i Fl(\()r(\()q
Fi(t)e(e0)7 b Fl(\))r(\))17 b(\()q Fg(if)h Fi(t)e(t)5 b Fl(\))r(\))r(\))r(\))
279 1246 y(\()r(\()p 321 1246 V 332 1246 V 45 w(\()q Fi(e0)i
Fl(\))17 b Fi(c1)f(c2)24 b Ff(:)8 b(:)g(:)f Fl(\))299 1302
y(\()q Fg(with-syn)o(tax)18 b Fl(\()r(\()q Fi(r)n(est)f Fl(\()q
Fi(do)n(c)n(ond)g Fl(\()q Fg(syn)o(tax)g Fl(\()q Fg(cond)1215
1309 y Fh(3)1253 1302 y Fi(c1)f(c2)24 b Ff(:)8 b(:)g(:)f Fl(\))r(\))r(\))r
(\))r(\))350 1359 y(\()q Fg(syn)o(tax)18 b Fl(\()q Fg(let)h
Fl(\()r(\()q Fi(t)d(e0)7 b Fl(\))r(\))18 b(\()q Fg(if)g Fi(t)e(t)g(r)n(est)5
b Fl(\))r(\))r(\))r(\))r(\))279 1415 y(\()r(\()p 321 1415 V
332 1415 V 45 w(\()q Fi(e0)17 b Fl(=)-8 b Ff(>)16 b Fi(e1)7
b Fl(\))r(\))299 1471 y(\()q Fg(syn)o(tax)17 b Fl(\()q Fg(let)i
Fl(\()r(\()q Fi(t)e(e0)7 b Fl(\))r(\))17 b(\()q Fg(if)h Fi(t)f
Fl(\()q Fi(e1)f(t)5 b Fl(\))r(\))r(\))r(\))r(\))279 1528 y(\()r(\()p
321 1528 V 332 1528 V 45 w(\()q Fi(e0)17 b Fl(=)-8 b Ff(>)16
b Fi(e1)7 b Fl(\))17 b Fi(c1)f(c2)24 b Ff(:)8 b(:)g(:)f Fl(\))299
1584 y(\()q Fg(with-syn)o(tax)18 b Fl(\()r(\()q Fi(r)n(est)f
Fl(\()q Fi(do)n(c)n(ond)g Fl(\()q Fg(syn)o(tax)g Fl(\()q Fg(cond)1215
1591 y Fh(3)1253 1584 y Fi(c1)f(c2)24 b Ff(:)8 b(:)g(:)f Fl(\))r(\))r(\))r
(\))r(\))350 1641 y(\()q Fg(syn)o(tax)18 b Fl(\()q Fg(let)h
Fl(\()r(\()q Fi(t)d(e0)7 b Fl(\))r(\))18 b(\()q Fg(if)g Fi(t)f
Fl(\()q Fi(e1)f(t)5 b Fl(\))17 b Fi(r)n(est)5 b Fl(\))r(\))r(\))r(\))r(\))279
1697 y(\()r(\()p 321 1697 V 332 1697 V 45 w(\()q Fi(e0)17 b(e1)f(e2)24
b Ff(:)8 b(:)g(:)f Fl(\))r(\))17 b(\()q Fg(syn)o(tax)g Fl(\()q
Fg(if)h Fi(e0)g Fl(\()q Fg(b)q(egin)g Fi(e1)e(e2)24 b Ff(:)8
b(:)g(:)f Fl(\))r(\))r(\))r(\))279 1754 y(\()r(\()p 321 1754
V 332 1754 V 45 w(\()q Fi(e0)17 b(e1)f(e2)24 b Ff(:)8 b(:)g(:)f
Fl(\))16 b Fi(c1)g(c2)24 b Ff(:)8 b(:)g(:)f Fl(\))299 1810
y(\()q Fg(with-syn)o(tax)18 b Fl(\()r(\()q Fi(r)n(est)f Fl(\()q
Fi(do)n(c)n(ond)g Fl(\()q Fg(syn)o(tax)g Fl(\()q Fg(cond)1215
1817 y Fh(3)1253 1810 y Fi(c1)f(c2)24 b Ff(:)8 b(:)g(:)f Fl(\))r(\))r(\))r
(\))r(\))350 1867 y(\()q Fg(syn)o(tax)18 b Fl(\()q Fg(if)g
Fi(e0)f Fl(\()q Fg(b)q(egin)i Fi(e1)d(e2)24 b Ff(:)8 b(:)g(:)f
Fl(\))16 b Fi(r)n(est)5 b Fl(\))r(\))r(\))r(\))279 1923 y(\()p
301 1923 V 313 1923 V 45 w(\()q Fi(syntax-err)n(or)17 b(orig-x)7
b Fl(\))r(\))r(\))r(\))r(\))r(\))71 2017 y(The)20 b(v)o(ersions)g(of)g
Fg(cond)h Fl(sho)o(wn)f(so)g(far)f(all)j(ha)o(v)o(e)d(t)o(w)o(o)g(cases)i
(for)e(most)h(of)f(the)i(t)o(yp)q(es)f(of)g(clauses,)i(one)0
2073 y(for)16 b(when)i(there)f(are)g(no)g(subsequen)o(t)g(clauses)h(and)f
(one)g(for)g(when)g(there)g(are)g(subsequen)o(t)h(clauses.)26
b(This)17 b(is)0 2130 y(necessary)c(since)h(the)f(ob)o(vious)h(\\base")e
(case)h(for)f(the)h(recursion,)i(\()q Fg(cond)q Fl(\))r(,)e(is)g(in)o(v)m
(alid)i(syn)o(tax.)k(The)13 b(next)g(three)0 2186 y(examples)18
b(commonize)g(the)f(v)m(arious)h(clauses)g(b)o(y)f(determining)i(the)e
(\\tail")g(of)g(the)g(generated)g Fg(if)h Fl(expression)0 2243
y(b)q(efore)d(constructing)g(the)g(output;)f(this)i(tail)f(is)g(either)h
(empt)o(y)e(or)h(con)o(tains)f(one)h(sub)q(expression,)h(so)f(that)f(the)0
2299 y(generated)h Fg(if)h Fl(expressions)g(con)o(tain)f(an)g(else)h(part)f
(only)h(if)f(there)h(are)f(more)f(clauses.)71 2356 y(The)g(\014rst)f(of)h
(this)g(set)g(of)f(de\014nitions)j(uses)e(a)f(lo)q(cal)i(help)g(function,)g
Fi(c)n(ond-if-tail)p Fl(,)f(to)f(construct)g(the)h Fg(if)h
Fl(tail:)72 2455 y(\()q Fg(de\014ne-syn)o(tax)i(cond)517 2462
y Fh(4)123 2512 y Fl(\()q Fg(let)j Fl(\()r(\()q Fi(c)n(ond-if-tail)260
2568 y Fl(\()q Fg(lam)o(b)q(da)f Fl(\()q Fi(clauses)5 b Fl(\))311
2625 y(\()q Fg(syn)o(tax-case)17 b Fi(clauses)g Fl(\()r(\))363
2681 y(\()r(\()r(\))g(\()q Fg(syn)o(tax)h Fl(\()s(\))r(\))r(\))952
2828 y(15)p eop
%%Page: 16 17
bop 363 49 a Fl(\()r(\()q Fi(c1)16 b(c2)24 b Ff(:)8 b(:)g(:)f
Fl(\))17 b(\()q Fg(syn)o(tax)h Fl(\()r(\()q Fg(cond)960 56
y Fh(4)997 49 y Fi(c1)e(c2)24 b Ff(:)8 b(:)g(:)f Fl(\))r(\))r(\))r(\))r(\))r
(\))r(\))r(\))175 106 y(\()q Fg(lam)o(b)q(da)20 b Fl(\()q Fi(x)7
b Fl(\))227 162 y(\()q Fg(syn)o(tax-case)17 b Fi(x)g Fl(\()q
Fg(else)h Fl(=)-8 b Ff(>)q Fl(\))279 219 y(\()r(\()p 321 219
14 2 v 332 219 V 45 w(\()q Fg(else)18 b Fi(e1)e(e2)24 b Ff(:)8
b(:)g(:)f Fl(\))r(\))17 b(\()q Fg(syn)o(tax)g Fl(\()q Fg(b)q(egin)i
Fi(e1)d(e2)24 b Ff(:)8 b(:)g(:)f Fl(\))r(\))r(\))279 275 y(\()r(\()p
321 275 V 332 275 V 45 w(\()q Fi(e0)g Fl(\))17 b Fi(c)23 b
Ff(:)8 b(:)g(:)f Fl(\))299 332 y(\()q Fg(with-syn)o(tax)18
b Fl(\()r(\()q Fi(tail)f Fl(\()q Fi(c)n(ond-if-tail)g Fl(\()q
Fg(syn)o(tax)h Fl(\()q Fi(c)23 b Ff(:)8 b(:)g(:)f Fl(\))r(\))r(\))r(\))r(\))
350 388 y(\()q Fg(syn)o(tax)18 b Fl(\()q Fg(let)h Fl(\()r(\()q
Fi(t)d(e0)7 b Fl(\))r(\))18 b(\()q Fg(if)g Fi(t)e(t)g(.)g(tail)6
b Fl(\))r(\))r(\))r(\))r(\))279 444 y(\()r(\()p 321 444 V 332
444 V 45 w(\()q Fi(e0)17 b Fl(=)-8 b Ff(>)16 b Fi(e1)7 b Fl(\))17
b Fi(c)23 b Ff(:)8 b(:)g(:)f Fl(\))299 501 y(\()q Fg(with-syn)o(tax)18
b Fl(\()r(\()q Fi(tail)f Fl(\()q Fi(c)n(ond-if-tail)g Fl(\()q
Fg(syn)o(tax)h Fl(\()q Fi(c)23 b Ff(:)8 b(:)g(:)f Fl(\))r(\))r(\))r(\))r(\))
350 557 y(\()q Fg(syn)o(tax)18 b Fl(\()q Fg(let)h Fl(\()r(\()q
Fi(t)d(e0)7 b Fl(\))r(\))18 b(\()q Fg(if)g Fi(t)f Fl(\()q Fi(e1)f(t)5
b Fl(\))17 b(.)e Fi(tail)6 b Fl(\))r(\))r(\))r(\))r(\))279
614 y(\()r(\()p 321 614 V 332 614 V 45 w(\()q Fi(e0)17 b(e1)f(e2)24
b Ff(:)8 b(:)g(:)f Fl(\))16 b Fi(c)23 b Ff(:)8 b(:)g(:)f Fl(\))299
670 y(\()q Fg(with-syn)o(tax)18 b Fl(\()r(\()q Fi(tail)f Fl(\()q
Fi(c)n(ond-if-tail)g Fl(\()q Fg(syn)o(tax)h Fl(\()q Fi(c)23
b Ff(:)8 b(:)g(:)f Fl(\))r(\))r(\))r(\))r(\))350 727 y(\()q
Fg(syn)o(tax)18 b Fl(\()q Fg(if)g Fi(e0)f Fl(\()q Fg(b)q(egin)i
Fi(e1)d(e2)24 b Ff(:)8 b(:)g(:)f Fl(\))16 b(.)f Fi(tail)6 b
Fl(\))r(\))r(\))r(\))r(\))r(\))r(\))r(\))71 821 y(The)11 b(next)g(v)o(ersion)
h(constructs)e(the)i(tail)f(b)q(efore)h(ev)o(en)f(lo)q(oking)h(at)f(the)g
(curren)o(t)g(clause,)i(and)e(uses)g(simpli\014ed)0 877 y(patterns)16
b(to)h(b)q(e)g(matc)o(hed)g(only)h(against)e(the)i(curren)o(t)e(clause.)27
b(Since)18 b(it)f(do)q(es)h(use)f(a)g(simpli\014ed)i(pattern,)e(it)0
933 y(m)o(ust)g(generate)g(an)h(error)f(explicitly)j(to)d(mak)o(e)g(it)h
(clear)g(that)f(the)g(error)g(is)h(caused)g(b)o(y)g(a)f(malformed)h
Fg(cond)0 990 y Fl(expression.)72 1090 y(\()q Fg(de\014ne-syn)o(tax)f(cond)
517 1097 y Fh(5)123 1146 y Fl(\()q Fg(lam)o(b)q(da)j Fl(\()q
Fi(orig-x)7 b Fl(\))175 1202 y(\()q Fg(syn)o(tax-case)17 b
Fi(orig-x)h Fl(\()r(\))227 1259 y(\()r(\()p 269 1259 V 281
1259 V 44 w Fi(c0)f(c1)24 b Ff(:)8 b(:)g(:)f Fl(\))247 1315
y(\()q Fg(with-syn)o(tax)19 b Fl(\()r(\()q Fi(tail)e Fl(\()q
Fg(syn)o(tax-case)h Fl(\()q Fg(syn)o(tax)f Fl(\()q Fi(c1)24
b Ff(:)8 b(:)g(:)f Fl(\))r(\))17 b(\()r(\))724 1372 y(\()r(\()r(\))g(\()q
Fg(syn)o(tax)h Fl(\()s(\))r(\))r(\))724 1428 y(\()r(\()q Fi(c1)e(c2)24
b Ff(:)8 b(:)g(:)f Fl(\))17 b(\()q Fg(syn)o(tax)h Fl(\()r(\()q
Fg(cond)1321 1435 y Fh(5)1358 1428 y Fi(c1)f(c2)24 b Ff(:)8
b(:)g(:)e Fl(\))r(\))r(\))r(\))r(\))r(\))r(\))299 1485 y(\()q
Fg(syn)o(tax-case)18 b Fl(\()q Fg(syn)o(tax)e Fi(c0)7 b Fl(\))18
b(\()q Fg(else)f Fl(=)-8 b Ff(>)q Fl(\))350 1541 y(\()r(\()q
Fg(else)18 b Fi(e1)e(e2)24 b Ff(:)8 b(:)g(:)f Fl(\))370 1598
y(\()q Fi(nul)r(l?)17 b Fl(\()q Fg(syn)o(tax)g Fi(tail)6 b
Fl(\))r(\))370 1654 y(\()q Fg(syn)o(tax)18 b Fl(\()q Fg(b)q(egin)g
Fi(e1)f(e2)24 b Ff(:)8 b(:)g(:)e Fl(\))r(\))r(\))350 1711 y(\()r(\()q
Fi(e0)h Fl(\))370 1767 y(\()q Fg(syn)o(tax)18 b Fl(\()q Fg(let)h
Fl(\()r(\()q Fi(t)d(e0)7 b Fl(\))r(\))18 b(\()q Fg(if)f Fi(t)g(t)f(.)g(tail)6
b Fl(\))r(\))r(\))r(\))350 1823 y(\()r(\()q Fi(e0)17 b Fl(=)-8
b Ff(>)16 b Fi(e1)7 b Fl(\))370 1880 y(\()q Fg(syn)o(tax)18
b Fl(\()q Fg(let)h Fl(\()r(\()q Fi(t)d(e0)7 b Fl(\))r(\))18
b(\()q Fg(if)f Fi(t)h Fl(\()q Fi(e1)e(t)5 b Fl(\))17 b(.)d
Fi(tail)6 b Fl(\))r(\))r(\))r(\))350 1936 y(\()r(\()q Fi(e0)17
b(e1)f(e2)24 b Ff(:)8 b(:)g(:)f Fl(\))370 1993 y(\()q Fg(syn)o(tax)18
b Fl(\()q Fg(if)g Fi(e0)f Fl(\()q Fg(b)q(egin)i Fi(e1)d(e2)24
b Ff(:)8 b(:)g(:)f Fl(\))16 b(.)e Fi(tail)6 b Fl(\))r(\))r(\))350
2049 y(\()p 372 2049 V 384 2049 V 46 w(\()q Fi(syntax-err)n(or)16
b(orig-x)7 b Fl(\))r(\))r(\))r(\))r(\))r(\))r(\))r(\))0 2143
y(If)13 b(the)g(explicit)i(error)d(clause)i(w)o(ere)e(omitted,)i(\()q
Fg(cond)19 b Fl(\()q Fi(x)7 b Fl(\))17 b(\()q Fi(y)f(.)g(z)7
b Fl(\))r(\))13 b(w)o(ould)g(cause)g(the)g(error)f(system)g(to)g(rep)q(ort)0
2200 y(an)j(error)g(something)g(lik)o(e:)693 2306 y(Error:)k(in)o(v)m(alid)e
(syn)o(tax)f(\()q Fi(y)g(.)g(z)7 b Fl(\))0 2412 y(Ho)o(w)o(ev)o(er,)17
b(just)g(as)h(in)g(the)g(\014rst)f(t)o(w)o(o)f(v)o(ersions)i(of)g
Fg(cond)p Fl(,)g(the)g(syn)o(tax)f(error)f(in)k(\()q Fg(cond)f
Fl(\()q Fi(x)7 b Fl(\))17 b(\()q Fi(y)f(.)g(z)7 b Fl(\))r(\))18
b(w)o(ould)0 2469 y(still)h(b)q(e)f(rep)q(orted)g(as)f(an)g(error)g(in)j(\()q
Fg(cond)e Fl(\()q Fi(y)f(.)f(z)7 b Fl(\))r(\).)27 b(The)17
b(v)o(ersion)h(b)q(elo)o(w)g(com)o(bines)g(the)g(tec)o(hniques)h(from)0
2525 y(the)c(preceding)i(v)o(ersion)e(and)h(the)f(earlier)h(v)o(ersion)g
(that)e(recurs)h(in)o(ternally)i(to)e(get)f(this)i(righ)o(t:)952
2828 y(16)p eop
%%Page: 17 18
bop 72 49 a Fl(\()q Fg(de\014ne-syn)o(tax)17 b(cond)517 56
y Fh(6)123 106 y Fl(\()q Fg(lam)o(b)q(da)j Fl(\()q Fi(orig-x)7
b Fl(\))175 162 y(\()q Fg(let)18 b Fi(do)n(c)n(ond)f Fl(\()r(\()q
Fi(x)g(orig-x)7 b Fl(\))r(\))227 219 y(\()q Fg(syn)o(tax-case)17
b Fi(x)h Fl(\()r(\))279 275 y(\()r(\()p 321 275 14 2 v 332
275 V 44 w Fi(c0)f(c1)24 b Ff(:)8 b(:)g(:)e Fl(\))299 332 y(\()q
Fg(with-syn)o(tax)350 388 y Fl(\()r(\()q Fi(tail)18 b Fl(\()q
Fg(syn)o(tax-case)g Fl(\()q Fg(syn)o(tax)f Fl(\()q Fi(c1)24
b Ff(:)8 b(:)g(:)f Fl(\))r(\))17 b(\()r(\))522 444 y(\()r(\()r(\))g(\()q
Fg(syn)o(tax)h Fl(\()s(\))r(\))r(\))522 501 y(\()r(\()q Fi(c1)e(c2)24
b Ff(:)8 b(:)g(:)f Fl(\))542 557 y(\()q Fg(with-syn)o(tax)19
b Fl(\()r(\()q Fi(e)e Fl(\()q Fi(do)n(c)n(ond)g Fl(\()q Fg(syn)o(tax)g
Fl(\()q Fg(cond)1408 564 y Fh(6)1446 557 y Fi(c1)f(c2)24 b
Ff(:)8 b(:)g(:)f Fl(\))r(\))r(\))r(\))r(\))594 614 y(\()q Fg(syn)o(tax)18
b Fl(\()q Fi(e)5 b Fl(\))r(\))r(\))r(\))r(\))r(\))r(\))350
670 y(\()q Fg(syn)o(tax-case)19 b Fl(\()q Fg(syn)o(tax)d Fi(c0)7
b Fl(\))18 b(\()q Fg(else)f Fl(=)-8 b Ff(>)q Fl(\))402 727
y(\()r(\()q Fg(else)17 b Fi(e1)g(e2)24 b Ff(:)8 b(:)g(:)f Fl(\))422
783 y(\()q Fi(nul)r(l?)17 b Fl(\()q Fg(syn)o(tax)g Fi(tail)6
b Fl(\))r(\))422 840 y(\()q Fg(syn)o(tax)18 b Fl(\()q Fg(b)q(egin)g
Fi(e1)e(e2)24 b Ff(:)8 b(:)g(:)f Fl(\))r(\))r(\))402 896 y(\()r(\()q
Fi(e0)g Fl(\))422 953 y(\()q Fg(syn)o(tax)18 b Fl(\()q Fg(let)h
Fl(\()r(\()q Fi(t)d(e0)7 b Fl(\))r(\))17 b(\()q Fg(if)h Fi(t)f(t)f(.)g(tail)6
b Fl(\))r(\))r(\))r(\))402 1009 y(\()r(\()q Fi(e0)16 b Fl(=)-8
b Ff(>)17 b Fi(e1)7 b Fl(\))422 1065 y(\()q Fg(syn)o(tax)18
b Fl(\()q Fg(let)h Fl(\()r(\()q Fi(t)d(e0)7 b Fl(\))r(\))17
b(\()q Fg(if)h Fi(t)g Fl(\()q Fi(e1)e(t)5 b Fl(\))16 b(.)f
Fi(tail)6 b Fl(\))r(\))r(\))r(\))402 1122 y(\()r(\()q Fi(e0)16
b(e1)h(e2)24 b Ff(:)8 b(:)g(:)f Fl(\))422 1178 y(\()q Fg(syn)o(tax)18
b Fl(\()q Fg(if)f Fi(e0)h Fl(\()q Fg(b)q(egin)g Fi(e1)f(e2)24
b Ff(:)8 b(:)g(:)e Fl(\))16 b(.)f Fi(tail)6 b Fl(\))r(\))r(\))402
1235 y(\()p 424 1235 V 436 1235 V 46 w(\()q Fi(syntax-err)n(or)16
b(orig-x)7 b Fl(\))r(\))r(\))r(\))r(\))r(\))r(\))r(\))r(\))71
1317 y(The)15 b(\014nal)h(de\014nition)h(of)e Fg(cond)h Fl(b)q(elo)o(w)g
(expands)g(in)o(to)f(a)g(pair)h(of)f(m)o(utually)h(recursiv)o(e)g(lo)q(cal)g
(macros)f(that)0 1373 y(p)q(erform)i(the)h(expansion.)27 b(Although)18
b(it)f(w)o(orks)g(and)g(ev)o(en)h(rep)q(orts)f(errors)g(in)h(terms)f(of)g
(the)g(original)i Fg(cond)0 1430 y Fl(expression,)f(it)f(is)g(not)f(as)h
(straigh)o(tforw)o(ard)e(as)h(the)h(previous)g(de\014nitions.)27
b(F)l(urthermore,)16 b(it)h(is)h(lik)o(ely)g(to)e(b)q(e)0 1486
y(m)o(uc)o(h)g(less)h(e\016cien)o(t)g(than)f(the)h(previous)g(v)o(ersions,)f
(since)h(it)g(requires)g(t)o(w)o(o)e(new)h(macro)g(transformers)f(to)g(b)q(e)
0 1543 y(constructed)k(and)g(ev)m(aluated)h(eac)o(h)f(time)g(a)g
Fg(cond)g Fl(expression)h(o)q(ccurs)f(in)h(a)f(program.)29
b(It)19 b(do)q(es,)h(ho)o(w)o(ev)o(er,)0 1599 y(demonstrate)d(ho)o(w)h(lo)q
(cal)h(macro)e(de\014nitions)i(ma)o(y)f(b)q(e)g(inserted)h(in)o(to)f(the)g
(output)g(of)f(a)h(macro)f(to)g(p)q(erform)0 1656 y(additional)g(complex)f
(pro)q(cessing)g(of)f(the)g(input.)72 1744 y(\()q Fg(de\014ne-syn)o(tax)i
(cond)517 1751 y Fh(7)123 1800 y Fl(\()q Fg(lam)o(b)q(da)j
Fl(\()q Fi(x)7 b Fl(\))175 1856 y(\()q Fg(syn)o(tax-case)17
b Fi(x)h Fl(\()r(\))227 1913 y(\()r(\()p 269 1913 V 281 1913
V 44 w Fi(xc1)f(xc2)24 b Ff(:)8 b(:)g(:)f Fl(\))247 1969 y(\()q
Fg(with-syn)o(tax)19 b Fl(\()r(\()q Fi(dots)e Fl(\()q Fg(syn)o(tax)g
Fl(\()9 b Ff(:)f(:)g(:)28 b(:)8 b(:)g(:)f Fl(\))r(\))r(\))r(\))299
2026 y(\()q Fg(syn)o(tax)17 b Fl(\()q Fg(letrec-syn)o(tax)537
2082 y Fl(\()r(\()q Fg(cond1)i Fl(\()q Fg(lam)o(b)q(da)g Fl(\()q
Fi(x)7 b Fl(\))780 2139 y(\()q Fg(syn)o(tax-case)17 b Fi(x)g
Fl(\()q Fg(else)g Fl(=)-8 b Ff(>)q Fl(\))831 2195 y(\()r(\()p
873 2195 V 885 2195 V 46 w(\()q Fg(else)17 b Fi(e1)g(e2)f(dots)5
b Fl(\))r(\))851 2252 y(\()q Fg(syn)o(tax)18 b Fl(\()q Fg(b)q(egin)g
Fi(e1)f(e2)f(dots)5 b Fl(\))r(\))r(\))831 2308 y(\()r(\()p
873 2308 V 885 2308 V 46 w(\()q Fi(e0)16 b Fl(=)-8 b Ff(>)17
b Fi(e1)7 b Fl(\))16 b Fi(c)h(dots)5 b Fl(\))851 2365 y(\()q
Fg(syn)o(tax)18 b Fl(\()q Fg(let)h Fl(\()r(\()q Fi(t)d(e0)7
b Fl(\))r(\))1090 2421 y(\()q Fg(cond2)17 b Fi(t)h Fl(\()q
Fi(e1)e(t)5 b Fl(\))17 b Fi(c)f(dots)5 b Fl(\))r(\))r(\))r(\))831
2477 y(\()r(\()p 873 2477 V 885 2477 V 46 w(\()q Fi(e0)16 b(e1)h(e2)f(dots)5
b Fl(\))16 b Fi(c)g(dots)5 b Fl(\))851 2534 y(\()q Fg(syn)o(tax)18
b Fl(\()q Fg(cond2)g Fi(e0)1209 2590 y Fl(\()q Fg(b)q(egin)g
Fi(e1)f(e2)f(dots)5 b Fl(\))1208 2647 y Fi(c)16 b(dots)5 b
Fl(\))r(\))r(\))831 2703 y(\()r(\()p 873 2703 V 885 2703 V
46 w(\()q Fi(e0)i Fl(\))16 b Fi(c)g(dots)5 b Fl(\))952 2828
y(17)p eop
%%Page: 18 19
bop 851 49 a Fl(\()q Fg(syn)o(tax)18 b Fl(\()q Fg(let)h Fl(\()r(\()q
Fi(t)d(e0)7 b Fl(\))r(\))1090 106 y(\()q Fg(cond2)17 b Fi(t)g(t)f(c)g(dots)5
b Fl(\))r(\))r(\))r(\))831 162 y(\()p 853 162 14 2 v 865 162
V 46 w(\()q Fi(syntax-err)n(or)947 219 y Fl(\()q Fg(syn)o(tax)17
b Fl(\()q Fg(cond)1259 226 y Fh(7)1297 219 y Fi(xc1)f(xc2)24
b Ff(:)8 b(:)g(:)f Fl(\))r(\))r(\))r(\))r(\))r(\))r(\))557
275 y(\()q Fg(cond2)19 b Fl(\()q Fg(lam)o(b)q(da)g Fl(\()q
Fi(x)7 b Fl(\))780 332 y(\()q Fg(syn)o(tax-case)17 b Fi(x)g
Fl(\()r(\))831 388 y(\()r(\()p 873 388 V 885 388 V 45 w Fi(e0)f(e1)7
b Fl(\))18 b(\()q Fg(syn)o(tax)f Fl(\()q Fg(if)h Fi(e0)e(e1)7
b Fl(\))r(\))r(\))831 444 y(\()r(\()p 873 444 V 885 444 V 45
w Fi(e0)16 b(e1)h(c1)f(c2)h(dots)5 b Fl(\))851 501 y(\()q Fg(syn)o(tax)18
b Fl(\()q Fg(if)g Fi(e0)1105 557 y(e1)1106 614 y Fl(\()q Fg(cond1)g
Fi(c1)e(c2)g(dots)5 b Fl(\))r(\))r(\))r(\))r(\))r(\))r(\))r(\))537
670 y(\()q Fg(cond1)18 b Fi(xc1)e(xc2)24 b Ff(:)8 b(:)g(:)f
Fl(\))r(\))r(\))r(\))r(\))r(\))r(\))r(\))0 764 y(The)14 b(\()8
b Ff(:)g(:)g(:)28 b(:)8 b(:)g(:)f Fl(\))13 b(\\escap)q(e")g(is)f(used)h(to)f
(in)o(tro)q(duce)h(ellipses)i(in)o(to)d(the)g(generated)h(macros.)18
b(The)12 b Fg(b)q(e-lik)o(e-b)q(egin)0 821 y Fl(macro)i(de\014nitions)j(sho)o
(wn)e(later)h(in)g(this)f(section)h(pro)o(vide)g(a)f(simpler)h(demonstration)
f(of)g(this)g(feature.)71 877 y(A)g(lo)q(cal)i(macro)e(ma)o(y)g(b)q(e)i
(written)e(in)i(terms)e(of)g(an)h(existing)h(syn)o(tactic)e(form)g(or)h(pro)q
(cedure)g(of)f(the)h(same)0 933 y(name)f(using)g Fg(let-syn)o(tax)q
Fl(,)f(although)h(it)g(is)g(somewhat)f(tric)o(ky)h(to)f(do)h(so)g(and)f(not)h
(usually)h(a)f(go)q(o)q(d)f(idea.)21 b(The)0 990 y(follo)o(wing)13
b(sho)o(ws)f(ho)o(w)g(one)h(migh)o(t)f(restrict)g Fg(if)h Fl(expressions)h
(within)f(a)f(giv)o(en)h(expression)h(to)e(require)h(the)g(\\else")0
1046 y(\(alternativ)o(e\))i(part:)72 1147 y(\()q Fg(let-syn)o(tax)j
Fl(\()r(\()q Fg(if)h Fl(\()q Fg(lam)o(b)q(da)h Fl(\()q Fi(x)7
b Fl(\))474 1203 y(\()q Fg(syn)o(tax-case)17 b Fi(x)h Fl(\()r(\))526
1260 y(\()r(\()p 568 1260 V 579 1260 V 44 w Fi(e1)f(e2)f(e3)7
b Fl(\))18 b(\()q Fg(syn)o(tax)f Fl(\()q Fg(if)h Fi(e1)e(e2)h(e3)7
b Fl(\))r(\))r(\))r(\))r(\))r(\))r(\))123 1316 y(\()q Fg(if)18
b Fl(1)d(2)g(3)q(\))r(\))0 1410 y(The)k(expression)h(ab)q(o)o(v)o(e)f(ev)m
(aluates)h(to)f(2)o(.)32 b(If,)20 b(ho)o(w)o(ev)o(er,)f(the)g(b)q(o)q(dy)h(w)
o(ere)g(\()q Fg(if)e Fl(1)d(2)q(\),)20 b(a)f(syn)o(tax)f(error)h(w)o(ould)0
1467 y(result.)71 1523 y(Although)14 b(the)g(de\014nition)i(ab)q(o)o(v)o(e)e
(lo)q(oks)h(simple)g(enough,)f(there)h(are)f(sev)o(eral)g(w)o(a)o(ys)f(in)i
(whic)o(h)g(an)f(attempt)0 1580 y(to)h(write)h(this)g(macro)f(could)h(easily)
h(ha)o(v)o(e)e(gone)h(wrong.)k(First,)15 b(it)h(w)o(ould)g(not)f(w)o(ork)g
(if)h Fg(letrec-syn)o(tax)f Fl(w)o(ere)0 1636 y(used)k(instead)h(of)e
Fg(let-syn)o(tax)p Fl(.)30 b(In)20 b(this)f(case,)g(the)g(iden)o(ti\014er)h
Fg(if)f Fl(inserted)g(in)o(to)g(the)g(lo)q(cal)h(macro's)d(output)0
1692 y(w)o(ould)c(refer)f(to)g(the)g(lo)q(cal)i Fg(if)q Fl(,)e(rather)g(than)
g(the)h(top-lev)o(el)g Fg(if)q Fl(,)g(and)f(expansion)i(w)o(ould)e(lo)q(op)h
(inde\014nitely)m(.)21 b(Next,)0 1749 y(if)16 b(the)f(de\014nition)i(w)o(ere)
e(sp)q(eci\014ed)i(as)e(in)h(the)f(follo)o(wing:)72 1849 y(\()q
Fg(let-syn)o(tax)j Fl(\()r(\()q Fg(if)h Fl(\()q Fg(lam)o(b)q(da)h
Fl(\()q Fi(x)7 b Fl(\))474 1905 y(\()q Fg(syn)o(tax-case)17
b Fi(x)h Fl(\()r(\))526 1961 y(\()r(\()q Fg(if)f Fi(e1)g(e2)f(e3)7
b Fl(\))18 b(\()q Fg(syn)o(tax)f Fl(\()q Fg(if)h Fi(e1)e(e2)h(e3)7
b Fl(\))r(\))r(\))r(\))r(\))r(\))r(\))123 2018 y(\()q Fg(if)18
b Fl(1)d(2)g(3)q(\))r(\))0 2112 y(expansion)e(w)o(ould)f(again)g(lo)q(op)h
(inde\014nitely)l(.)22 b(The)12 b(reason)g(is)g(that)f(the)h(iden)o(ti\014er)
i Fg(if)e Fl(app)q(earing)h(at)f(the)g(start)e(of)0 2168 y(the)k(pattern)g
(is)h(treated)f(as)g(a)g(pattern)g(v)m(ariable,)i(ev)o(en)e(though)h(it)f(is)
h(within)h(the)e(de\014nition)j(for)c(the)i(k)o(eyw)o(ord)0
2225 y Fg(if)p Fl(.)28 b(Th)o(us,)19 b(it)f(is)g(b)q(ound)h(to)e(the)h
(corresp)q(onding)h(iden)o(ti\014er)h Fg(if)e Fl(from)f(the)h(input)h
(expression,)g(whic)o(h)g(denotes)0 2281 y(the)c(lo)q(cal)g(binding)i(of)d
Fg(if)p Fl(.)20 b(Finally)l(,)c(placing)g Fg(if)f Fl(in)g(the)g(list)g(of)f
(literals)i(in)f(an)g(attempt)e(to)h(patc)o(h)h(up)g(the)f(latter)0
2338 y(v)o(ersion)h(w)o(ould)h(not)f(w)o(ork)f(either:)72 2437
y(\()q Fg(let-syn)o(tax)k Fl(\()r(\()q Fg(if)h Fl(\()q Fg(lam)o(b)q(da)h
Fl(\()q Fi(x)7 b Fl(\))474 2494 y(\()q Fg(syn)o(tax-case)17
b Fi(x)g Fl(\()q Fg(if)6 b Fl(\))526 2550 y(\()r(\()q Fg(if)17
b Fi(e1)g(e2)f(e3)7 b Fl(\))18 b(\()q Fg(syn)o(tax)f Fl(\()q
Fg(if)h Fi(e1)e(e2)h(e3)7 b Fl(\))r(\))r(\))r(\))r(\))r(\))r(\))123
2607 y(\()q Fg(if)18 b Fl(1)d(2)g(3)q(\))r(\))952 2828 y(18)p
eop
%%Page: 19 20
bop 0 49 a Fl(This)11 b(w)o(ould)g(cause)g Fg(syn)o(tax-case)f
Fl(to)g(compare)h(the)g(literal)g Fg(if)g Fl(in)h(the)f(pattern,)f(whic)o(h)i
(is)f(scop)q(ed)g(outside)h(of)e(the)0 106 y Fg(let-syn)o(tax)15
b Fl(expression,)h(with)f(the)g Fg(if)h Fl(in)f(the)h(input)g(expression,)f
(whic)o(h)h(is)f(scop)q(ed)h(inside)h(the)e Fg(let-syn)o(tax)p
Fl(.)0 162 y(Since)i(they)f(do)f(not)g(refer)h(to)f(the)g(same)h(binding,)h
(they)e(are)h(not)f Fi(fr)n(e)n(e-identi\014er=?)o Fl(.)21
b(The)15 b(result)h(is)g(a)g(syn)o(tax)0 219 y(error.)71 275
y(The)22 b(con)o(v)o(en)o(tional)g(use)h(of)p 587 275 14 2
v 599 275 V 72 w(in)f(place)h(of)f(the)g(macro)f(k)o(eyw)o(ord)g(helps)j(the)
e(macro)f(writer)h(to)f(a)o(v)o(oid)0 332 y(situations)16 b(lik)o(e)g(those)f
(ab)q(o)o(v)o(e)g(where)g(the)g(wrong)g(iden)o(ti\014er)i(is)e(matc)o(hed)g
(against)g(or)g(inserted)h(b)o(y)f(acciden)o(t.)71 388 y(What)g(if)h(a)f(lo)q
(cal)i(macro)e(m)o(ust)g(b)q(e)i(de\014ned)g(in)f(terms)g(of)f(an)h(existing)
g(binding)i(for)d(the)h(macro)f(k)o(eyw)o(ord,)0 444 y(but)f(the)f(lo)q(cal)h
(macro)f(m)o(ust)g(b)q(e)h(de\014ned)h(recursiv)o(ely?)21 b(This)14
b(could)g(b)q(e)g(done)g(b)o(y)g(using)g(an)f(in)o(ternal)h(recursion)0
501 y(similar)21 b(to)d(that)h(used)h(in)h(some)e(of)g(the)g
Fg(let)i Fl(and)e Fg(cond)h Fl(examples)g(ab)q(o)o(v)o(e.)33
b(But)19 b(it)h(can)g(also)f(b)q(e)h(done)g(b)o(y)0 557 y(observing)d(that)f
(the)h(problem)g(with)g(the)g(second)g Fg(if)g Fl(example)h(ab)q(o)o(v)o(e)e
(can)h(actually)g(b)q(e)h(used)f(to)f(adv)m(an)o(tage.)0 614
y(The)d(follo)o(wing)h(lo)q(cal)g(de\014nition)h(for)e Fg(if)g
Fl(is)h(a)e(more)h(general)g(form)g(that)f(allo)o(ws)h(zero)g(or)g(more)f
(test/consequen)o(t)0 670 y(pairs)j(p)q(ossibly)i(follo)o(w)o(ed)f(b)o(y)f
(an)g(alternativ)o(e:)72 770 y(\()q Fg(let-syn)o(tax)j Fl(\()r(\()q
Fg(if)h Fl(\()q Fg(lam)o(b)q(da)h Fl(\()q Fi(x)7 b Fl(\))474
826 y(\()q Fg(syn)o(tax-case)17 b Fi(x)h Fl(\()r(\))526 883
y(\()r(\()p 568 883 V 579 883 V 44 w Fi(e)5 b Fl(\))17 b(\()q
Fg(syn)o(tax)f Fi(e)5 b Fl(\))r(\))526 939 y(\()r(\()p 568
939 V 579 939 V 44 w Fi(e1)17 b(e2)7 b Fl(\))17 b(\()q Fg(syn)o(tax)h
Fl(\()q Fg(if)f Fi(e1)g(e2)7 b Fl(\))r(\))r(\))526 996 y(\()r(\()q
Fi(p)16 b(e1)g(e2)h(e3)f(e4)24 b Ff(:)8 b(:)g(:)f Fl(\))546
1052 y(\()q Fg(syn)o(tax)17 b Fl(\()q Fg(if)h Fi(e1)e(e2)i
Fl(\()q Fi(p)e(e3)h(e4)24 b Ff(:)8 b(:)g(:)e Fl(\))r(\))r(\))r(\))r(\))r(\))r
(\))r(\))123 1109 y(\()q Fi(list)17 b Fl(\()q Fg(if)h Fl(#f)d(1)f(#f)h(2)g
(#f)g(3)g(#f)g(4)g(5)q(\))219 1165 y(\()q Fg(if)j Fl(#f)d(1)f(#f)h(2)g(#t)g
(3)g(#f)g(4)g(5)q(\))219 1222 y(\()q Fg(if)j Fl(#t)c(1)h(#f)g(2)g(#f)g(3)g
(#f)g(4)g(5)q(\))r(\))r(\))0 1315 y(Here)g(w)o(e)g(use)g(a)g(pattern)f(v)m
(ariable)i Fi(p)g Fl(to)e(pic)o(k)i(up)f(the)g(iden)o(ti\014er)i
Fg(if)e Fl(from)f(the)h(input)h(that)e(carries)h(with)h(it)f(the)0
1372 y(lo)q(cal)k(binding)h(for)d Fg(if)h Fl(so)f(that)g(w)o(e)h(can)f(use)i
(it)f(in)g(the)g(recursion)g(step.)28 b(Th)o(us,)18 b(when)g(w)o(e)f(refer)h
(to)f Fg(if)h Fl(in)h(the)0 1428 y(output,)c(it)g(is)h(the)f(top-lev)o(el)h
Fg(if)q Fl(,)f(but)g(when)h(w)o(e)f(refer)g(to)f Fi(p)p Fl(,)h(it)h(is)f(the)
h(lo)q(cal)g Fg(if)p Fl(.)71 1485 y(Although)f(this)f(w)o(orks,)g(the)g(b)q
(est)h(solution)g(is)g(to)f(name)g(the)h(lo)q(cal)g(macro)f(something)h
(di\013eren)o(t)f(from)g(the)0 1541 y(top-lev)o(el)i(macro)f(and)g(to)g(use)g
Fg(letrec-syn)o(tax)h Fl(to)e(supp)q(ort)h(the)h(recursion.)71
1598 y(The)g(macro)f(app)q(endix)i(of)f(the)g(Revised)784 1581
y Fh(4)820 1598 y Fl(Rep)q(ort)f(on)h(Sc)o(heme)g(pro)o(vides)h(a)e
Fg(syn)o(tax-rules)g Fl(form)g(that)g(is)0 1654 y(a)g(restricted)g(v)m(arian)
o(t)h(of)e Fg(syn)o(tax-case)p Fl(.)20 b(Here)15 b(is)h(ho)o(w)f(it)g(can)h
(b)q(e)f(de\014ned)i(in)f(terms)f(of)f Fg(syn)o(tax-case)p
Fl(:)72 1754 y(\()q Fg(de\014ne-syn)o(tax)j(syn)o(tax-rules)123
1810 y Fl(\()q Fg(lam)o(b)q(da)j Fl(\()q Fi(x)7 b Fl(\))175
1867 y(\()q Fg(syn)o(tax-case)17 b Fi(x)h Fl(\()r(\))227 1923
y(\()r(\()p 269 1923 V 281 1923 V 46 w(\()q Fi(k)23 b Ff(:)8
b(:)g(:)f Fl(\))17 b(\()q Fi(p)n(attern)f(template)5 b Fl(\))23
b Ff(:)8 b(:)g(:)f Fl(\))247 1980 y(\()q Fg(syn)o(tax)17 b
Fl(\()q Fg(lam)o(b)q(da)j Fl(\()q Fi(x)7 b Fl(\))485 2036 y(\()q
Fg(syn)o(tax-case)17 b Fi(x)h Fl(\()q Fi(k)23 b Ff(:)8 b(:)g(:)f
Fl(\))537 2092 y(\()q Fi(p)n(attern)17 b Fl(\()q Fg(syn)o(tax)g
Fi(template)5 b Fl(\))r(\))543 2149 y Ff(:)j(:)g(:)f Fl(\))r(\))r(\))r(\))r
(\))r(\))r(\))0 2243 y Fg(syn)o(tax-rules)18 b Fl(di\013ers)g(from)g
Fg(syn)o(tax-case)g Fl(in)i(three)e(w)o(a)o(ys.)29 b(First,)18
b Fg(syn)o(tax-rules)g Fl(m)o(ust)g(itself)h(ev)m(aluate)0
2299 y(to)h(a)h(transformer)e(\(pro)q(cedure\),)j(so)f(it)g(expands)g(in)o
(to)g(a)g Fg(lam)o(b)q(da)g Fl(expression.)38 b(Second,)23
b Fg(syn)o(tax-rules)0 2356 y Fl(do)q(es)c(not)g(supp)q(ort)g(fenders.)31
b(Third,)21 b(the)e(output)f(part)h(of)f(a)h Fg(syn)o(tax-rules)f
Fl(clause)i(is)f(alw)o(a)o(ys)f(a)h Fg(syn)o(tax)0 2412 y Fl(template)i
(rather)f(than)g(an)g(arbitrary)g(expression,)i(so)e(it)h(expands)g(in)o(to)g
(a)f Fg(syn)o(tax)f Fl(form.)35 b(Man)o(y)20 b(of)g(the)0 2469
y(macros)g(ab)q(o)o(v)o(e)h(can)h(b)q(e)g(written)f(using)h
Fg(syn)o(tax-rules)e Fl(but)i(only)f(if)h(they)f(can)h(b)q(e)g(written)f
(with)g(simple)0 2525 y(input-pattern/output-template)16 b(clauses.)21
b(This)15 b(de\014nition)i(of)e Fg(or)g Fl(is)h(a)f(go)q(o)q(d)g(example:)952
2828 y(19)p eop
%%Page: 20 21
bop 72 49 a Fl(\()q Fg(de\014ne-syn)o(tax)17 b(or)123 106 y
Fl(\()q Fg(syn)o(tax-rules)h Fl(\()s(\))175 162 y(\()r(\()p
217 162 14 2 v 229 162 V 31 w(\))e(#f)5 b(\))175 219 y(\()r(\()p
217 219 V 229 219 V 45 w Fi(e)g Fl(\))15 b Fi(e)5 b Fl(\))175
275 y(\()r(\()p 217 275 V 229 275 V 45 w Fi(e1)16 b(e2)h(e3)24
b Ff(:)8 b(:)g(:)e Fl(\))195 332 y(\()q Fg(let)19 b Fl(\()r(\()q
Fi(t)d(e1)7 b Fl(\))r(\))18 b(\()q Fg(if)g Fi(t)e(t)i Fl(\()q
Fg(or)e Fi(e2)h(e3)24 b Ff(:)8 b(:)g(:)f Fl(\))r(\))r(\))r(\))r(\))r(\))0
425 y(Actually)l(,)15 b(to)f(b)q(e)g(completely)i(correct,)d(w)o(e)h(m)o(ust)
g(ignore)g(the)g(\014rst)g(p)q(osition)h(of)e(eac)o(h)i(pattern)e(as)h(sp)q
(eci\014ed)i(b)o(y)0 482 y(the)i(Revised)234 465 y Fh(4)272
482 y Fl(Rep)q(ort,)f(for)h(the)f(same)h(reasons)f(w)o(e)h(stated)f(earlier)i
(for)e(our)g(con)o(v)o(en)o(tion)h(of)f(using)p 1788 482 V
1800 482 V 65 w(in)i(the)0 538 y(\014rst)14 b(p)q(osition)h(of)f(patterns)g
(matc)o(hed)h(against)f(macro)f(calls.)21 b(W)l(e)15 b(do)f(so)g(in)h(the)g
(next)f(de\014nition)j(b)o(y)d(inserting)0 595 y(a)h(set)g(of)g(dumm)o(y)g
(pattern)f(v)m(ariables:)72 694 y(\()q Fg(de\014ne-syn)o(tax)j(syn)o
(tax-rules)123 751 y Fl(\()q Fg(lam)o(b)q(da)j Fl(\()q Fi(x)7
b Fl(\))175 807 y(\()q Fg(syn)o(tax-case)17 b Fi(x)h Fl(\()r(\))227
864 y(\()r(\()p 269 864 V 281 864 V 46 w(\()q Fi(k)23 b Ff(:)8
b(:)g(:)f Fl(\))17 b(\()r(\()q Fi(keywor)n(d)f(.)h(p)n(attern)5
b Fl(\))15 b Fi(template)5 b Fl(\))24 b Ff(:)8 b(:)g(:)e Fl(\))247
920 y(\()q Fg(with-syn)o(tax)19 b Fl(\()r(\()r(\()q Fi(dummy)24
b Ff(:)8 b(:)g(:)f Fl(\))592 977 y(\()q Fi(gener)n(ate-temp)n(or)n(aries)17
b Fl(\()q Fg(syn)o(tax)h Fl(\()q Fi(keywor)n(d)24 b Ff(:)8
b(:)g(:)f Fl(\))r(\))r(\))r(\))r(\))299 1033 y(\()q Fg(syn)o(tax)17
b Fl(\()q Fg(lam)o(b)q(da)j Fl(\()q Fi(x)7 b Fl(\))537 1090
y(\()q Fg(syn)o(tax-case)17 b Fi(x)g Fl(\()q Fi(k)24 b Ff(:)8
b(:)g(:)f Fl(\))589 1146 y(\()r(\()q Fi(dummy)17 b(.)f(p)n(attern)5
b Fl(\))17 b(\()q Fg(syn)o(tax)f Fi(template)5 b Fl(\))r(\))595
1202 y Ff(:)j(:)g(:)f Fl(\))r(\))r(\))r(\))r(\))r(\))r(\))r(\))71
1296 y(Man)o(y)15 b(v)o(ersions)i(of)f(Sc)o(heme)h(pro)o(vide)f(a)g(v)o
(ersion)h(of)f Fg(extend-syn)o(tax)g Fl([5)o(,)g(3],)f(whic)o(h)j(is)e(one)h
(of)f(the)g(fore-)0 1353 y(runners)g(to)f(the)h(system)f(describ)q(ed)j(in)e
(this)h(do)q(cumen)o(t.)k(It)16 b(to)q(o)f(can)h(b)q(e)g(de\014ned)h(in)g
(terms)e(of)g Fg(syn)o(tax-case)0 1409 y Fl(if)20 b(w)o(e)e(are)h(willing)j
(to)c(use)i Fg(syn)o(tax)e Fl(in)i(place)g(of)f Fg(quote)g
Fl(to)f(mark)h(pieces)h(of)f(fenders)h(and)f(\\with")g(clauses)0
1466 y(that)14 b(are)g(to)f(b)q(e)j(expanded)f(b)o(y)f(the)h(template)f
(expander.)21 b(The)14 b(\014rst)g(v)o(ersion)h(b)q(elo)o(w)g(sho)o(ws)f
Fg(extend-syn)o(tax)0 1522 y Fl(without)j Fg(with)g Fl(forms,)g(and)g(the)g
(second)g(allo)o(ws)g Fg(with)h Fl(forms)e(\(but)h(only)g(at)g(the)g(b)q
(eginning)i(of)d(the)h(output)0 1579 y(template\).)72 1679
y(\()q Fg(de\014ne-syn)o(tax)g(extend-syn)o(tax)123 1736 y
Fl(\()q Fg(lam)o(b)q(da)j Fl(\()q Fi(x)7 b Fl(\))175 1792 y(\()q
Fg(de\014ne)18 b Fi(exp)n(and-clause)227 1849 y Fl(\()q Fg(lam)o(b)q(da)h
Fl(\()q Fi(c)t Fl(\))279 1905 y(\()q Fg(syn)o(tax-case)e Fi(c)g
Fl(\()r(\))331 1961 y(\()r(\()q Fi(p)n(attern)f(fender)g(template)5
b Fl(\))350 2018 y(\()q Fg(syn)o(tax)18 b Fl(\()q Fi(p)n(attern)e(fender)h
Fl(\()q Fg(syn)o(tax)g Fi(template)5 b Fl(\))r(\))r(\))r(\))331
2074 y(\()r(\()q Fi(p)n(attern)16 b(template)5 b Fl(\))350
2131 y(\()q Fg(syn)o(tax)18 b Fl(\()q Fi(p)n(attern)f Fl(\()q
Fg(syn)o(tax)g Fi(template)5 b Fl(\))r(\))r(\))r(\))r(\))r(\))r(\))175
2187 y(\()q Fg(syn)o(tax-case)17 b Fi(x)h Fl(\()r(\))227 2244
y(\()r(\()p 269 2244 V 281 2244 V 46 w(\()q Fi(k0)e(k1)24 b
Ff(:)8 b(:)g(:)f Fl(\))16 b Fi(c)23 b Ff(:)8 b(:)g(:)f Fl(\))247
2300 y(\()q Fg(with-syn)o(tax)19 b Fl(\()r(\()r(\()q Fi(c)k
Ff(:)8 b(:)g(:)f Fl(\))17 b(\()q Fi(map)g(exp)n(and-clause)g
Fl(\()q Fg(syn)o(tax)g Fl(\()q Fi(c)24 b Ff(:)8 b(:)g(:)f Fl(\))r(\))r(\))r
(\))r(\))299 2357 y(\()q Fg(syn)o(tax)17 b Fl(\()q Fg(de\014ne-syn)o(tax)g
Fi(k0)537 2413 y Fl(\()q Fg(lam)o(b)q(da)i Fl(\()q Fi(x)7 b
Fl(\))589 2470 y(\()q Fg(syn)o(tax-case)17 b Fi(x)g Fl(\()q
Fi(k1)24 b Ff(:)8 b(:)g(:)f Fl(\))16 b Fi(c)23 b Ff(:)8 b(:)g(:)f
Fl(\))r(\))r(\))r(\))r(\))r(\))r(\))r(\))r(\))952 2828 y(20)p
eop
%%Page: 21 22
bop 72 49 a Fl(\()q Fg(de\014ne-syn)o(tax)17 b(extend-syn)o(tax)123
106 y Fl(\()q Fg(lam)o(b)q(da)j Fl(\()q Fi(x)7 b Fl(\))175
162 y(\()q Fg(de\014ne)18 b Fi(exp)n(and-template)227 219 y
Fl(\()q Fg(lam)o(b)q(da)h Fl(\()q Fi(t)5 b Fl(\))279 275 y(\()q
Fg(syn)o(tax-case)17 b Fi(t)g Fl(\()q Fg(with)q Fl(\))331 332
y(\()r(\()q Fg(with)i Fl(\()r(\()q Fi(p)n(attern)d(expr)n(ession)5
b Fl(\))22 b Ff(:)8 b(:)g(:)e Fl(\))16 b Fi(template)5 b Fl(\))350
388 y(\()q Fg(with-syn)o(tax)19 b Fl(\()r(\()q Fi(template)e
Fl(\()q Fi(exp)n(and-template)h Fl(\()q Fg(syn)o(tax)f Fi(template)5
b Fl(\))r(\))r(\))r(\))402 444 y(\()q Fg(syn)o(tax)18 b Fl(\()q
Fg(with-syn)o(tax)g Fl(\()r(\()q Fi(p)n(attern)e(expr)n(ession)5
b Fl(\))22 b Ff(:)8 b(:)g(:)f Fl(\))639 501 y Fi(template)e
Fl(\))r(\))r(\))r(\))331 557 y(\()q Fi(template)17 b Fl(\()q
Fg(syn)o(tax)h Fl(\()q Fg(syn)o(tax)e Fi(template)5 b Fl(\))r(\))r(\))r(\))r
(\))r(\))175 614 y(\()q Fg(de\014ne)18 b Fi(exp)n(and-clause)227
670 y Fl(\()q Fg(lam)o(b)q(da)h Fl(\()q Fi(c)t Fl(\))279 727
y(\()q Fg(syn)o(tax-case)e Fi(c)g Fl(\()r(\))331 783 y(\()r(\()q
Fi(p)n(attern)f(fender)g(template)5 b Fl(\))350 840 y(\()q
Fg(with-syn)o(tax)19 b Fl(\()r(\()q Fi(template)e Fl(\()q Fi(exp)n
(and-template)h Fl(\()q Fg(syn)o(tax)f Fi(template)5 b Fl(\))r(\))r(\))r(\))
402 896 y(\()q Fg(syn)o(tax)18 b Fl(\()q Fi(p)n(attern)e(fender)g(template)5
b Fl(\))r(\))r(\))r(\))331 953 y(\()r(\()q Fi(p)n(attern)16
b(template)5 b Fl(\))350 1009 y(\()q Fg(with-syn)o(tax)19 b
Fl(\()r(\()q Fi(template)e Fl(\()q Fi(exp)n(and-template)h
Fl(\()q Fg(syn)o(tax)f Fi(template)5 b Fl(\))r(\))r(\))r(\))402
1065 y(\()q Fg(syn)o(tax)18 b Fl(\()q Fi(p)n(attern)e(template)5
b Fl(\))r(\))r(\))r(\))r(\))r(\))r(\))175 1122 y(\()q Fg(syn)o(tax-case)17
b Fi(x)h Fl(\()r(\))227 1178 y(\()r(\()p 269 1178 14 2 v 281
1178 V 46 w(\()q Fi(k0)e(k1)24 b Ff(:)8 b(:)g(:)f Fl(\))16
b Fi(c)23 b Ff(:)8 b(:)g(:)f Fl(\))247 1235 y(\()q Fg(with-syn)o(tax)19
b Fl(\()r(\()r(\()q Fi(c)k Ff(:)8 b(:)g(:)f Fl(\))17 b(\()q
Fi(map)g(exp)n(and-clause)g Fl(\()q Fg(syn)o(tax)g Fl(\()q
Fi(c)24 b Ff(:)8 b(:)g(:)f Fl(\))r(\))r(\))r(\))r(\))299 1291
y(\()q Fg(syn)o(tax)17 b Fl(\()q Fg(de\014ne-syn)o(tax)g Fi(k0)537
1348 y Fl(\()q Fg(lam)o(b)q(da)i Fl(\()q Fi(x)7 b Fl(\))589
1404 y(\()q Fg(syn)o(tax-case)17 b Fi(x)g Fl(\()q Fi(k1)24
b Ff(:)8 b(:)g(:)f Fl(\))16 b Fi(c)23 b Ff(:)8 b(:)g(:)f Fl(\))r(\))r(\))r
(\))r(\))r(\))r(\))r(\))r(\))0 1470 y(Using)16 b(the)f(latter)g(v)o(ersion)g
(of)g Fg(extend-syn)o(tax)p Fl(,)f Fg(letrec)i Fl(can)f(b)q(e)h(de\014ned)h
(as)e(follo)o(ws:)72 1541 y(\()q Fg(extend-syn)o(tax)g Fl(\()q
Fg(letrec)q Fl(\))123 1598 y(\()r(\()p 165 1598 V 177 1598
V 46 w(\()r(\()q Fi(i)h(v)6 b Fl(\))24 b Ff(:)8 b(:)g(:)e Fl(\))16
b Fi(e1)h(e2)24 b Ff(:)8 b(:)g(:)e Fl(\))143 1654 y(\()q Fg(with)19
b Fl(\()r(\()r(\()q Fi(t)24 b Ff(:)8 b(:)g(:)f Fl(\))17 b(\()q
Fi(gener)n(ate-temp)n(or)n(aries)g Fl(\()q Fg(syn)o(tax)g Fl(\()q
Fi(i)24 b Ff(:)8 b(:)g(:)f Fl(\))r(\))r(\))r(\))r(\))195 1711
y(\()q Fg(let)19 b Fl(\()r(\()q Fi(i)d Fl(#f)5 b(\))23 b Ff(:)8
b(:)g(:)f Fl(\))247 1767 y(\()q Fg(let)19 b Fl(\()r(\()q Fi(t)d(v)6
b Fl(\))24 b Ff(:)8 b(:)g(:)e Fl(\))299 1823 y(\()q Fg(set!)17
b Fi(i)f(t)5 b Fl(\))24 b Ff(:)8 b(:)g(:)298 1880 y Fi(e1)16
b(e2)24 b Ff(:)8 b(:)g(:)f Fl(\))r(\))r(\))r(\))r(\))71 1946
y(Man)o(y)15 b(of)g(the)h(macro)f(de\014nitions)j(giv)o(en)e(earlier)h(w)o
(ould)f(b)q(e)g(shorter)f(using)i Fg(syn)o(tax-rules)o Fl(,)f(and)g(shorter)0
2002 y(still)h(using)f(extend-syn)o(tax.)j(Whic)o(h)d(to)f(use)g(is)h(really)
g(a)f(matter)f(of)h(taste.)71 2058 y(The)h(next)h(few)f(examples)h(in)o(v)o
(olv)o(e)g(the)f(insertion)i(of)e(implicit)i(iden)o(ti\014ers)g(in)o(to)f
(the)f(output)g(of)g(a)g(macro.)0 2115 y(The)k(\014rst)f(of)h(these)f
(de\014nes)i(a)f(lo)q(op)g(macro)f(that)g(implicitly)k(binds)e(the)e(v)m
(ariable)i Fi(exit)f Fl(to)f(a)h(con)o(tin)o(uation)0 2171
y(within)c(the)g(b)q(o)q(dy)g(of)e(the)i(lo)q(op:)72 2243 y(\()q
Fg(de\014ne-syn)o(tax)h(lo)q(op)123 2299 y Fl(\()q Fg(lam)o(b)q(da)j
Fl(\()q Fi(x)7 b Fl(\))175 2356 y(\()q Fg(syn)o(tax-case)17
b Fi(x)h Fl(\()r(\))227 2412 y(\()r(\()q Fi(k)e(e1)g(e2)24
b Ff(:)8 b(:)g(:)f Fl(\))247 2469 y(\()q Fg(with-syn)o(tax)19
b Fl(\()r(\()q Fi(exit-id)e Fl(\()q Fi(implicit-identi\014er)g
Fl(\()q Fg(syn)o(tax)f Fi(k)6 b Fl(\))16 b('exit)q(\))r(\))r(\))299
2525 y(\()q Fg(syn)o(tax)h Fl(\()q Fi(c)n(al)r(l-with-curr)n(ent-c)n
(ontinuation)537 2582 y Fl(\()q Fg(lam)o(b)q(da)i Fl(\()q Fi(exit-id)6
b Fl(\))589 2638 y(\()q Fg(let)18 b Fi(f)f Fl(\()r(\))h(\()q
Fg(b)q(egin)h Fi(e1)d(e2)24 b Ff(:)8 b(:)g(:)f Fl(\))17 b(\()q
Fi(f)11 b Fl(\))r(\))r(\))r(\))r(\))r(\))r(\))r(\))r(\))r(\))0
2704 y(Using)16 b(this)f(de\014nition,)i(the)e(expression)j(\()q
Fg(lo)q(op)g Fl(1)q(\))e(lo)q(ops)g(inde\014nitely)l(,)i(but:)952
2828 y(21)p eop
%%Page: 22 23
bop 72 49 a Fl(\()q Fg(let)19 b Fl(\()r(\()q Fi(x)d Fl(2)q(\))r(\))123
106 y(\()q Fg(lo)q(op)k Fl(\()q Fg(if)f Fl(\()q Fi(zer)n(o?)d(x)7
b Fl(\))17 b(\()q Fi(exit)f(x)7 b Fl(\))17 b(\()q Fg(set!)g
Fi(x)g Fl(\()q Fk(\000)e Fi(x)i Fl(1)q(\))r(\))r(\))r(\))r(\))0
200 y(terminates)e(on)g(the)h(third)f(iteration.)20 b(Also:)72
299 y(\()q Fg(let)f Fl(\()r(\()q Fi(exit)e Fl(\()q Fg(lam)o(b)q(da)i
Fl(\()q Fi(x)7 b Fl(\))16 b Fi(x)7 b Fl(\))r(\))r(\))123 356
y(\()q Fg(lo)q(op)20 b Fl(\()q Fi(exit)c Fl(0)q(\))r(\))r(\))0
449 y(terminates)f(and)h(returns)f(0)o(,)g(but:)72 549 y(\()q
Fg(lo)q(op)k Fl(\()q Fg(let)h Fl(\()r(\()q Fi(exit)d Fl(\()q
Fg(lam)o(b)q(da)i Fl(\()q Fi(x)7 b Fl(\))16 b Fi(x)7 b Fl(\))r(\))r(\))258
606 y(\()q Fi(exit)16 b Fl(0)q(\))r(\))r(\))0 699 y(do)q(es)g(not)e
(terminate.)71 756 y(In)d(order)g(to)g(create)g(a)g(binding)i(that)e
(captures)g(references)h(to)e Fi(exit)h Fl(within)i(the)e(lo)q(op,)h(w)o(e)f
(create)g(an)g(implicit)0 812 y(iden)o(ti\014er)17 b(using)f(the)g(macro's)e
(k)o(eyw)o(ord)g(as)h(a)h(template.)k(An)c(implicit)i(iden)o(ti\014er)f(is)f
(one)f(that)g(b)q(eha)o(v)o(es)g(as)g(if)0 869 y(it)i(had)g(b)q(een)h(in)o
(tro)q(duced)f(at)g(the)f(same)h(time)g(and)g(in)g(the)g(same)f(place)i(as)e
(the)h(template)g(iden)o(ti\014er,)h(in)g(this)0 925 y(case)e(the)h(k)o(eyw)o
(ord)f(in)h(the)f(macro)g(call.)25 b(It)16 b(is)h(as)f(if)h(the)g(implicit)h
(iden)o(ti\014er)g(had)f(b)q(een)h(part)d(of)h(the)h(original)0
982 y(macro)d(call)j(and)e(had)h(b)q(een)g(pluc)o(k)o(ed)g(from)f(the)g
(input)h(rather)f(than)g(syn)o(thesized)h(b)o(y)f Fi(implicit-identi\014er)p
Fl(.)71 1038 y(The)g(binding)i(in)o(tro)q(duced)g(for)d Fi(exit)h
Fl(migh)o(t)g(just)g(as)g(w)o(ell)h(b)q(e)g(a)f(macro)f(binding:)72
1138 y(\()q Fg(de\014ne-syn)o(tax)j(lo)q(op)123 1194 y Fl(\()q
Fg(lam)o(b)q(da)j Fl(\()q Fi(x)7 b Fl(\))175 1251 y(\()q Fg(syn)o(tax-case)17
b Fi(x)h Fl(\()r(\))227 1307 y(\()r(\()q Fi(k)e(e1)g(e2)24
b Ff(:)8 b(:)g(:)f Fl(\))247 1363 y(\()q Fg(with-syn)o(tax)19
b Fl(\()r(\()q Fi(exit-id)e Fl(\()q Fi(implicit-identi\014er)g
Fl(\()q Fg(syn)o(tax)f Fi(k)6 b Fl(\))16 b('exit)q(\))r(\))r(\))299
1420 y(\()q Fg(syn)o(tax)h Fl(\()q Fi(c)n(al)r(l-with-curr)n(ent-c)n
(ontinuation)537 1476 y Fl(\()q Fg(lam)o(b)q(da)i Fl(\()q Fi(t)5
b Fl(\))589 1533 y(\()q Fg(de\014ne-syn)o(tax)17 b Fi(exit-id)641
1589 y Fl(\()q Fg(lam)o(b)q(da)i Fl(\()q Fi(x)7 b Fl(\))692
1646 y(\()q Fg(syn)o(tax-case)17 b Fi(x)h Fl(\()r(\))744 1702
y(\()r(\()p 786 1702 14 2 v 798 1702 V 45 w Fi(e)5 b Fl(\))16
b(\()q Fg(syn)o(tax)i Fl(\()q Fi(t)e(e)5 b Fl(\))r(\))r(\))r(\))r(\))r(\))589
1759 y(\()q Fg(let)18 b Fi(f)f Fl(\()r(\))h(\()q Fg(b)q(egin)h
Fi(e1)d(e2)24 b Ff(:)8 b(:)g(:)f Fl(\))17 b(\()q Fi(f)11 b
Fl(\))r(\))r(\))r(\))r(\))r(\))r(\))r(\))r(\))r(\))0 1852 y(All)19
b(of)e(the)g(examples)i(giv)o(en)f(ab)q(o)o(v)o(e)f(b)q(eha)o(v)o(e)h(the)f
(same)g(with)h(either)g(de\014nition)i(of)d Fg(lo)q(op)q Fl(,)h(and)f(in)i
(fact,)e(the)0 1909 y(generated)e(co)q(de)h(w)o(ould)g(b)q(e)f(nearly)h(iden)
o(tical.)71 1965 y(Another)21 b(common)g(use)h(for)f(implicit)j(iden)o
(ti\014ers)f(is)g(in)f(the)g(de\014nition)h(of)e(structure)h(facilities.)41
b(The)0 2022 y(follo)o(wing)20 b(de\014nition)g(for)e Fg(de\014ne-structure)h
Fl(is)g(an)g(adaptation)g(of)f(one)h(that)f(app)q(eared)h(in)h
Fi(The)f(Scheme)0 2078 y(Pr)n(o)n(gr)n(amming)d(L)n(anguage)j
Fl([3)o(].)i(This)c(system)e(represen)o(ts)h(structures)f(as)h(v)o(ectors)f
(of)g(length)i Ff(n)11 b Fl(+)f(1,)16 b(where)g Ff(n)0 2135
y Fl(is)g(the)g(n)o(um)o(b)q(er)g(of)f(\014elds,)h(the)g(\014rst)f(elemen)o
(t)i(is)f(the)g(name)f(of)g(the)h(structure,)f(and)h(the)g(remaining)g
(elemen)o(ts)0 2191 y(con)o(tain)j(the)f(\014elds')i(v)m(alues.)31
b(A)19 b(structure)f(de\014nition)i(expands)g(in)o(to)e(a)g
Fg(b)q(egin)i Fl(con)o(taining)f(a)g(sequence)g(of)0 2248 y(pro)q(cedure)g
(de\014nitions)h(for)e(a)g(constructor,)g(a)f(structure)h(\\t)o(yp)q(e")g
(predicate,)i(and)e(access)h(and)f(assignmen)o(t)0 2304 y(pro)q(cedures)e
(for)f(eac)o(h)g(\014eld.)71 2361 y(The)20 b(names)h(for)f(these)g(pro)q
(cedures)i(are)e(constructed)h(as)f(implicit)j(iden)o(ti\014ers)f(from)d(the)
i(name)f(giv)o(en)0 2417 y(for)i(the)h(structure)f(and)h(the)g(\014eld)h
(names.)42 b(Most)21 b(of)i(the)f(w)o(ork)g(is)h(done)g(in)h(the)e(lo)q(cal)i
(help)g(pro)q(cedure)0 2473 y Fi(c)n(onstruct-name)p Fl(.)g(This)18
b(pro)q(cedure)f(tak)o(es)f(a)h(template)g(iden)o(ti\014er)h(and)f(a)g(list)g
(of)g(iden)o(ti\014ers)h(and)f(strings)g(to)0 2530 y(b)q(e)f(used)g(in)g
(forming)f(the)g(implicit)j(iden)o(ti\014er's)e(name.)952 2828
y(22)p eop
%%Page: 23 24
bop 72 49 a Fl(\()q Fg(de\014ne-syn)o(tax)17 b(de\014ne-structure)123
106 y Fl(\()q Fg(lam)o(b)q(da)j Fl(\()q Fi(x)7 b Fl(\))175
162 y(\()q Fg(de\014ne)18 b Fi(c)n(onstruct-name)227 219 y
Fl(\()q Fg(lam)o(b)q(da)h Fl(\()q Fi(template-identi\014er)d(.)g(ar)n(gs)5
b Fl(\))279 275 y(\()q Fi(implicit-identi\014er)329 332 y
(template-identi\014er)331 388 y Fl(\()q Fi(string)p Fk(\000)-8
b Ff(>)p Fi(symb)n(ol)382 444 y Fl(\()q Fi(apply)17 b(string-app)n(end)522
501 y Fl(\()q Fi(map)h Fl(\()q Fg(lam)o(b)q(da)h Fl(\()q Fi(x)7
b Fl(\))694 557 y(\()q Fg(if)18 b Fl(\()q Fi(string?)e(x)7
b Fl(\))760 614 y Fi(x)761 670 y Fl(\()q Fi(symb)n(ol)p Fk(\000)-8
b Ff(>)p Fi(string)15 b Fl(\()q Fi(syntax-obje)n(ct)p Fk(\000)-8
b Ff(>)p Fi(datum)16 b(x)7 b Fl(\))r(\))r(\))r(\))641 727 y
Fi(ar)n(gs)e Fl(\))r(\))r(\))r(\))r(\))r(\))175 783 y(\()q
Fg(syn)o(tax-case)17 b Fi(x)h Fl(\()r(\))227 840 y(\()r(\()p
269 840 14 2 v 281 840 V 46 w(\()q Fi(name)e(id1)24 b Ff(:)8
b(:)g(:)f Fl(\))r(\))247 896 y(\()q Fg(syn)o(tax)17 b Fl(\()q
Fg(de\014ne-structure)i Fl(\()q Fi(name)d(id1)24 b Ff(:)8 b(:)g(:)f
Fl(\))17 b(\()r(\))r(\))r(\))r(\))227 953 y(\()r(\()p 269 953
V 281 953 V 46 w(\()q Fi(name)f(id1)24 b Ff(:)8 b(:)g(:)f Fl(\))17
b(\()r(\()q Fi(id2)f(init)5 b Fl(\))24 b Ff(:)8 b(:)g(:)e Fl(\))r(\))247
1009 y(\()q Fg(with-syn)o(tax)299 1065 y Fl(\()r(\()q Fi(c)n(onstructor)17
b Fl(\()q Fi(c)n(onstruct-name)g Fl(\()q Fg(syn)o(tax)f Fi(name)5
b Fl(\))16 b(\\mak)o(e-")f(\()q Fg(syn)o(tax)h Fi(name)5 b
Fl(\))r(\))r(\))319 1122 y(\()q Fi(pr)n(e)n(dic)n(ate)17 b
Fl(\()q Fi(c)n(onstruct-name)g Fl(\()q Fg(syn)o(tax)f Fi(name)5
b Fl(\))16 b(\()q Fg(syn)o(tax)h Fi(name)5 b Fl(\))15 b(\\?")q(\))r(\))319
1178 y(\()r(\()q Fi(ac)n(c)n(ess)22 b Ff(:)8 b(:)g(:)e Fl(\))339
1235 y(\()q Fi(map)17 b Fl(\()q Fg(lam)o(b)q(da)j Fl(\()q Fi(x)7
b Fl(\))16 b(\()q Fi(c)n(onstruct-name)g(x)i Fl(\()q Fg(syn)o(tax)e
Fi(name)5 b Fl(\))15 b(\\-")g Fi(x)7 b Fl(\))r(\))458 1291
y(\()q Fg(syn)o(tax)18 b Fl(\()q Fi(id1)24 b Ff(:)8 b(:)g(:)22
b Fi(id2)i Ff(:)8 b(:)g(:)f Fl(\))r(\))r(\))r(\))319 1348 y(\()r(\()q
Fi(assign)22 b Ff(:)8 b(:)g(:)f Fl(\))339 1404 y(\()q Fi(map)17
b Fl(\()q Fg(lam)o(b)q(da)j Fl(\()q Fi(x)7 b Fl(\))510 1461
y(\()q Fi(c)n(onstruct-name)16 b(x)g Fl(\\set-")g(\()q Fg(syn)o(tax)g
Fi(name)5 b Fl(\))16 b(\\-")f Fi(x)h Fl(\\!")q(\))r(\))458
1517 y(\()q Fg(syn)o(tax)i Fl(\()q Fi(id1)24 b Ff(:)8 b(:)g(:)22
b Fi(id2)i Ff(:)8 b(:)g(:)f Fl(\))r(\))r(\))r(\))319 1574 y(\()q
Fi(structur)n(e-length)339 1630 y Fl(\()q(+)16 b(\()q Fi(length)h
Fl(\()q Fg(syn)o(tax)g Fl(\()q Fi(id1)24 b Ff(:)8 b(:)g(:)22
b Fi(id2)i Ff(:)8 b(:)g(:)f Fl(\))r(\))r(\))16 b(1)q(\))r(\))319
1686 y(\()r(\()q Fi(index)23 b Ff(:)8 b(:)g(:)f Fl(\))339 1743
y(\()q Fg(let)18 b Fi(f)f Fl(\()r(\()q Fi(i)f Fl(1)q(\))h(\()q
Fi(ids)g Fl(\()q Fg(syn)o(tax)g Fl(\()q Fi(id1)24 b Ff(:)8
b(:)g(:)22 b Fi(id2)j Ff(:)8 b(:)g(:)e Fl(\))r(\))r(\))r(\))390
1799 y(\()q Fg(if)19 b Fl(\()q Fi(nul)r(l?)d(ids)5 b Fl(\))457
1856 y(')q(\()r(\))458 1912 y(\()q Fi(c)n(ons)15 b(i)j Fl(\()q
Fi(f)f Fl(\()q(+)e Fi(i)h Fl(1)q(\))h(\()q Fi(c)n(dr)f(ids)5
b Fl(\))r(\))r(\))r(\))r(\))r(\))r(\))299 1969 y(\()q Fg(syn)o(tax)17
b Fl(\()q Fg(b)q(egin)537 2025 y Fl(\()q Fg(de\014ne)g Fi(c)n(onstructor)589
2082 y Fl(\()q Fg(lam)o(b)q(da)i Fl(\()q Fi(id1)24 b Ff(:)8
b(:)g(:)f Fl(\))641 2138 y(\()q Fg(let)p Fk(\003)18 b Fl(\()r(\()q
Fi(id2)f(init)5 b Fl(\))23 b Ff(:)8 b(:)g(:)f Fl(\))692 2195
y(\()q Fi(ve)n(ctor)16 b Fl('name)f Fi(id1)24 b Ff(:)8 b(:)g(:)22
b Fi(id2)i Ff(:)8 b(:)g(:)f Fl(\))r(\))r(\))r(\))537 2251 y(\()q
Fg(de\014ne)17 b Fi(pr)n(e)n(dic)n(ate)589 2307 y Fl(\()q Fg(lam)o(b)q(da)i
Fl(\()q Fi(x)7 b Fl(\))641 2364 y(\()q Fg(and)18 b Fl(\()q
Fi(ve)n(ctor?)f(x)7 b Fl(\))761 2420 y(\()q Fi(=)17 b Fl(\()q
Fi(ve)n(ctor-length)f(x)7 b Fl(\))16 b Fi(structur)n(e-length)5
b Fl(\))761 2477 y(\()q Fi(e)n(q?)17 b Fl(\()q Fi(ve)n(ctor-r)n(ef)f(x)h
Fl(0)q(\))e('name)q(\))r(\))r(\))r(\))537 2533 y(\()q Fg(de\014ne)i
Fi(ac)n(c)n(ess)589 2590 y Fl(\()q Fg(lam)o(b)q(da)i Fl(\()q
Fi(x)7 b Fl(\))641 2646 y(\()q Fi(ve)n(ctor-r)n(ef)15 b(x)i(index)7
b Fl(\))r(\))r(\))543 2703 y Ff(:)h(:)g(:)952 2828 y Fl(23)p
eop
%%Page: 24 25
bop 537 49 a Fl(\()q Fg(de\014ne)17 b Fi(assign)589 106 y Fl(\()q
Fg(lam)o(b)q(da)i Fl(\()q Fi(x)d(up)n(date)5 b Fl(\))641 162
y(\()q Fi(ve)n(ctor-set!)15 b(x)i(index)f(up)n(date)5 b Fl(\))r(\))r(\))543
219 y Ff(:)j(:)g(:)f Fl(\))r(\))r(\))r(\))r(\))r(\))r(\))0
310 y(Notice)19 b(the)g(c)o(hoice)h(of)e(template)h(iden)o(ti\014er)i(in)e
(eac)o(h)g(call)h(to)e Fi(c)n(onstruct-name)p Fl(.)31 b(F)l(or)18
b(the)h(constructor)f(and)0 366 y(predicate)k(iden)o(ti\014ers,)j(the)c
(structure)h(name)f(is)h(used,)i(and)e(for)e(the)i(access)g(and)g(assignmen)o
(t)f(pro)q(cedure)0 423 y(iden)o(ti\014ers,)15 b(the)e(corresp)q(onding)i
(\014eld)f(name)g(is)g(used.)20 b(These)13 b(are)g(the)h(most)e(logical)j(c)o
(hoices,)f(although)g(there)0 479 y(is)i(no)f(di\013erence)h(except)g(for)e
Fg(de\014ne-structure)i Fl(macro)e(calls)i(that)f(are)g(built)h(up)g
(incremen)o(tally)l(.)71 536 y(An)o(y)j(of)f(the)h(generated)g(pro)q(cedure)h
(de\014nitions)g(could)g(easily)g(ha)o(v)o(e)f(b)q(een)h(macro)e
(de\014nitions)j(instead.)0 592 y(F)l(or)15 b(example,)g(to)g(de\014ne)h(the)
f(accessors)g(as)g(macros,)f(it)h(w)o(ould)h(b)q(e)g(necessary)f(only)h(to)f
(replace:)72 689 y(\()q Fg(de\014ne)i Fi(ac)n(c)n(ess)123 746
y Fl(\()q Fg(lam)o(b)q(da)j Fl(\()q Fi(x)7 b Fl(\))175 802
y(\()q Fi(ve)n(ctor-r)n(ef)16 b(x)h(index)7 b Fl(\))r(\))r(\))0
893 y(with:)72 991 y(\()q Fg(de\014ne-syn)o(tax)17 b Fi(ac)n(c)n(ess)123
1047 y Fl(\()q Fg(lam)o(b)q(da)j Fl(\()q Fi(x)7 b Fl(\))175
1103 y(\()q Fg(syn)o(tax-case)17 b Fi(x)h Fl(\()r(\))227 1160
y(\()r(\()p 269 1160 14 2 v 281 1160 V 44 w Fi(x)7 b Fl(\))247
1216 y(\()q Fg(syn)o(tax)17 b Fl(\()q Fi(ve)n(ctor-r)n(ef)f(x)h(index)7
b Fl(\))r(\))r(\))r(\))r(\))r(\))0 1308 y(Using)16 b(either)h(v)o(ersion,)f
(a)f Fg(de\014ne-structure)h Fl(form)f(ma)o(y)g(app)q(ear)h(an)o(ywhere)g(a)f
Fg(de\014ne)h Fl(or)f Fg(de\014ne-syn)o(tax)0 1364 y Fl(form)i(ma)o(y)g(app)q
(ear,)h(including)i(within)f(a)e(sequence)i(of)e(de\014nitions)i(at)e(the)g
(fron)o(t)g(of)g(a)g Fg(lam)o(b)q(da)i Fl(or)e(similar)0 1421
y(b)q(o)q(dy)l(.)71 1477 y(The)f(follo)o(wing)g(de\014nition)i(de\014nes)f
Fg(quasiquote)p Fl(;)e(it)i(is)f(more)f(complicated)i(than)f(necessary)g(b)q
(ecause)h(it)0 1534 y(attempts)f(to)g(minimize)j(the)d(amoun)o(t)g(of)g
(consing.)25 b(Although)18 b(there)e(are)h(no)f(new)h(concepts)g(in)o(tro)q
(duced)h(b)o(y)0 1590 y(the)c(example,)g(it)g(is)h(a)e(go)q(o)q(d)h(example)g
(of)g(a)f(macro)g(that)g(tra)o(v)o(erses)g(the)g(en)o(tire)i(input)f
(expression)h(rather)e(than)0 1646 y(just)g(its)h(top-lev)o(el)h(structure.)k
(A)14 b(m)o(uc)o(h)g(simpler)h(v)o(ersion)f(could)h(b)q(e)f(de\014ned)h(b)o
(y)f(replacing)h(calls)g(to)e Fi(gen-c)n(ons)n Fl(,)0 1703
y Fi(gen-app)n(end)p Fl(,)h(and)i Fi(gen-ve)n(ctor)f Fl(with)g(syn)o(tax)g
(for)f(calls)i(to)f Fi(c)n(ons)o Fl(,)g Fi(app)n(end)p Fl(,)g(and)g
Fi(list)p Fa(->)p Fi(ve)n(ctor)n Fl(.)72 1800 y(\()q Fg(de\014ne-syn)o(tax)i
(quasiquote)123 1856 y Fl(\()q Fg(letrec)175 1913 y Fl(\()r(\()q
Fi(gen-c)n(ons)215 1969 y Fl(\()q Fg(lam)o(b)q(da)i Fl(\()q
Fi(x)e(y)5 b Fl(\))267 2026 y(\()q Fg(syn)o(tax-case)17 b Fi(x)g
Fl(\()q Fg(quote)q Fl(\))319 2082 y(\()r(\()q Fg(quote)g Fl(x)q(\))339
2139 y(\()q Fg(syn)o(tax-case)g Fi(y)g Fl(\()q Fg(quote)g Fl(list)q(\))390
2195 y(\()r(\()q Fg(quote)h Fl(y)r(\))e(\()q Fg(syn)o(tax)i
Fl(\()q Fg(quote)g Fl(\()q(x)d(.)g(y)r(\))r(\))r(\))r(\))390
2252 y(\()r(\()q Fi(list)h(y)24 b Ff(:)8 b(:)g(:)e Fl(\))17
b(\()q Fg(syn)o(tax)h Fl(\()q Fi(list)e Fl(\()q Fg(quote)i
Fl(x)q(\))e Fi(y)24 b Ff(:)8 b(:)g(:)e Fl(\))r(\))r(\))390
2308 y(\()q Fi(y)18 b Fl(\()q Fg(syn)o(tax)f Fl(\()q Fi(c)n(ons)f
Fl(\()q Fg(quote)i Fl(x)q(\))e Fi(y)5 b Fl(\))r(\))r(\))r(\))r(\))319
2365 y(\()q Fi(x)17 b Fl(\()q Fg(syn)o(tax-case)g Fi(y)g Fl(\()q
Fg(quote)h Fl(list)q(\))428 2421 y(\()r(\()q Fg(quote)g Fl(\()s(\))r(\))f(\()
q Fg(syn)o(tax)g Fl(\()q Fi(list)f(x)7 b Fl(\))r(\))r(\))428
2477 y(\()r(\()q Fi(list)15 b(y)24 b Ff(:)8 b(:)g(:)f Fl(\))17
b(\()q Fg(syn)o(tax)g Fl(\()q Fi(list)f(x)g(y)24 b Ff(:)8 b(:)g(:)f
Fl(\))r(\))r(\))428 2534 y(\()q Fi(y)17 b Fl(\()q Fg(syn)o(tax)h
Fl(\()q Fi(c)n(ons)d(x)h(y)5 b Fl(\))r(\))r(\))r(\))r(\))r(\))r(\))r(\))195
2590 y(\()q Fi(gen-app)n(end)215 2647 y Fl(\()q Fg(lam)o(b)q(da)19
b Fl(\()q Fi(x)e(y)5 b Fl(\))267 2703 y(\()q Fg(syn)o(tax-case)17
b Fi(x)g Fl(\()q Fg(quote)h Fi(list)d(c)n(ons)5 b Fl(\))952
2828 y(24)p eop
%%Page: 25 26
bop 319 49 a Fl(\()r(\()q Fg(quote)18 b Fl(\()q(x1)d(x2)22
b Ff(:)8 b(:)g(:)f Fl(\))r(\))339 106 y(\()q Fg(syn)o(tax-case)17
b Fi(y)g Fl(\()q Fg(quote)q Fl(\))390 162 y(\()r(\()q Fg(quote)h
Fl(y)r(\))e(\()q Fg(syn)o(tax)i Fl(\()q Fg(quote)g Fl(\()q(x1)d(x2)23
b Ff(:)8 b(:)g(:)20 b Fl(.)15 b(y)r(\))r(\))r(\))r(\))390 219
y(\()q Fi(y)j Fl(\()q Fg(syn)o(tax)f Fl(\()q Fi(app)n(end)g
Fl(\()q Fg(quote)i Fl(\()q Fi(x1)d(x2)24 b Ff(:)8 b(:)g(:)f
Fl(\))16 b Fi(y)5 b Fl(\))r(\))r(\))r(\))r(\))r(\))319 275
y(\()r(\()q Fg(quote)18 b Fl(\()s(\))r(\))e Fi(y)5 b Fl(\))319
332 y(\()r(\()q Fi(list)15 b(x1)i(x2)24 b Ff(:)8 b(:)g(:)e
Fl(\))339 388 y(\()q Fi(gen-c)n(ons)15 b Fl(\()q Fg(syn)o(tax)i
Fi(x1)7 b Fl(\))18 b(\()q Fi(gen-app)n(end)e Fl(\()q Fg(syn)o(tax)i
Fl(\()q Fi(list)d(x2)24 b Ff(:)8 b(:)g(:)f Fl(\))r(\))16 b
Fi(y)5 b Fl(\))r(\))r(\))319 444 y(\()q Fi(x)17 b Fl(\()q Fg(syn)o(tax-case)g
Fi(y)g Fl(\()q Fg(quote)h Fl(list)q(\))428 501 y(\()r(\()q
Fg(quote)g Fl(\()s(\))r(\))f(\()q Fg(syn)o(tax)f Fi(x)7 b Fl(\))r(\))428
557 y(\()q Fi(y)17 b Fl(\()q Fg(syn)o(tax)h Fl(\()q Fi(app)n(end)e(x)g(y)5
b Fl(\))r(\))r(\))r(\))r(\))r(\))r(\))r(\))195 614 y(\()q Fi(gen-ve)n(ctor)
215 670 y Fl(\()q Fg(lam)o(b)q(da)19 b Fl(\()q Fi(x)7 b Fl(\))267
727 y(\()q Fg(syn)o(tax-case)17 b Fi(x)g Fl(\()q Fg(quote)h
Fl(list)q(\))319 783 y(\()r(\()q Fg(quote)g Fl(\()q(x)23 b
Ff(:)8 b(:)g(:)e Fl(\))r(\))17 b(\()q Fg(syn)o(tax)h Fl(\()q
Fg(quote)f Fl(#)q(\()q(x)23 b Ff(:)8 b(:)g(:)e Fl(\))r(\))r(\))r(\))319
840 y(\()r(\()q Fi(list)15 b(x)24 b Ff(:)8 b(:)g(:)f Fl(\))17
b(\()q Fg(syn)o(tax)g Fl(\()q Fi(ve)n(ctor)f(x)24 b Ff(:)8
b(:)g(:)f Fl(\))r(\))r(\))319 896 y(\()q Fi(x)17 b Fl(\()q
Fg(syn)o(tax)g Fl(\()q Fi(list)p Fa(->)p Fi(ve)n(ctor)d(x)7
b Fl(\))r(\))r(\))r(\))r(\))r(\))195 953 y(\()q Fi(gen)215
1009 y Fl(\()q Fg(lam)o(b)q(da)19 b Fl(\()q Fi(p)e(lev)6 b
Fl(\))267 1065 y(\()q Fg(syn)o(tax-case)17 b Fi(p)h Fl(\()q
Fg(unquote)f(unquote-splicing)j(quasiquote)q Fl(\))319 1122
y(\()r(\()q Fg(unquote)d Fi(p)t Fl(\))339 1178 y(\()q Fg(if)h
Fl(\()q Fi(=)e(lev)g Fl(0)q(\))406 1235 y(\()q Fg(syn)o(tax)h
Fi(p)t Fl(\))406 1291 y(\()q Fi(gen-c)n(ons)f Fl(\()q Fg(syn)o(tax)i
Fl(\()q Fg(quote)f Fl(unquote)q(\))r(\))612 1348 y(\()q Fi(gen)g
Fl(\()q Fg(syn)o(tax)g Fl(\()q Fi(p)t Fl(\))r(\))g(\()q Fk(\000)f
Fi(lev)f Fl(1)q(\))r(\))r(\))r(\))r(\))319 1404 y(\()r(\()r(\()q
Fg(unquote-splicing)k Fi(p)t Fl(\))d(.)f Fi(q)5 b Fl(\))339
1461 y(\()q Fg(if)18 b Fl(\()q Fi(=)e(lev)g Fl(0)q(\))406 1517
y(\()q Fi(gen-app)n(end)h Fl(\()q Fg(syn)o(tax)g Fi(p)t Fl(\))g(\()q
Fi(gen)g Fl(\()q Fg(syn)o(tax)f Fi(q)5 b Fl(\))16 b Fi(lev)6
b Fl(\))r(\))406 1574 y(\()q Fi(gen-c)n(ons)16 b Fl(\()q Fi(gen-c)n(ons)g
Fl(\()q Fg(syn)o(tax)i Fl(\()q Fg(quote)f Fl(unquote-splicing)r(\))r(\))818
1630 y(\()q Fi(gen)g Fl(\()q Fg(syn)o(tax)f Fi(p)t Fl(\))h(\()q
Fk(\000)f Fi(lev)f Fl(1)q(\))r(\))r(\))612 1686 y(\()q Fi(gen)i
Fl(\()q Fg(syn)o(tax)f Fi(q)5 b Fl(\))16 b Fi(lev)6 b Fl(\))r(\))r(\))r(\))
319 1743 y(\()r(\()q Fg(quasiquote)17 b Fl(p)q(\))339 1799
y(\()q Fi(gen-c)n(ons)e Fl(\()q Fg(syn)o(tax)j Fl(\()q Fg(quote)f
Fl(quasiquote)q(\))r(\))544 1856 y(\()q Fi(gen)g Fl(\()q Fg(syn)o(tax)h
Fl(\()q Fi(p)t Fl(\))r(\))f(\()q(+)e Fi(lev)h Fl(1)q(\))r(\))r(\))r(\))319
1912 y(\()r(\()q Fi(p)g(.)g(q)5 b Fl(\))339 1969 y(\()q Fi(gen-c)n(ons)15
b Fl(\()q Fi(gen)i Fl(\()q Fg(syn)o(tax)f Fi(p)t Fl(\))h Fi(lev)6
b Fl(\))16 b(\()q Fi(gen)h Fl(\()q Fg(syn)o(tax)f Fi(q)5 b
Fl(\))16 b Fi(lev)6 b Fl(\))r(\))r(\))319 2025 y(\()q(#)q(\()q(x)22
b Ff(:)8 b(:)g(:)f Fl(\))17 b(\()q Fi(gen-ve)n(ctor)g Fl(\()q
Fi(gen)f Fl(\()q Fg(syn)o(tax)i Fl(\()q Fi(x)23 b Ff(:)8 b(:)g(:)f
Fl(\))r(\))16 b Fi(lev)6 b Fl(\))r(\))r(\))319 2082 y(\()q
Fi(p)17 b Fl(\()q Fg(syn)o(tax)h Fl(\()q Fg(quote)f Fl(p)q(\))r(\))r(\))r(\))
r(\))r(\))r(\))143 2138 y(\()q Fg(lam)o(b)q(da)j Fl(\()q Fi(x)7
b Fl(\))195 2195 y(\()q Fg(syn)o(tax-case)17 b Fi(x)h Fl(\()r(\))247
2251 y(\()r(\()p 289 2251 14 2 v 301 2251 V 44 w Fi(e)5 b Fl(\))17
b(\()q Fi(gen)g Fl(\()q Fg(syn)o(tax)f Fi(e)5 b Fl(\))15 b(0)q(\))r(\))r(\))r
(\))r(\))r(\))0 2325 y(As)e(with)g(references)h(to)e Fi(not)h
Fl(inserted)h(b)o(y)f(the)g Fg(unless)g Fl(transformer)f(de\014ned)i
(earlier,)g(the)f(inserted)h(references)0 2381 y(to)h Fi(c)n(ons)o
Fl(,)g Fi(list)o Fl(,)g(and)g(other)g(primitiv)o(e)i(names)e(resolv)o(e)h(to)
f(the)g(top-lev)o(el)i(bindings)g(ev)o(en)f(if)f(other)g(bindings)j(for)0
2438 y(these)d(names)h(are)e(lexically)k(apparen)o(t)d(within)h(the)g(scop)q
(e)f(of)g(a)g Fg(quasiquote)g Fl(expression:)72 2517 y(\()q
Fg(let)k Fl(\()r(\()q Fi(c)n(ons)c Fl(')q(\()q(a)f(.)h(b)q(\))r(\))r(\))122
2573 y(`)q(\()q(,)p Fi(c)n(ons)g(.)h Fl(,)p Fi(c)n(ons)5 b
Fl(\))r(\))71 2647 y(The)20 b(\014nal)g(example)h(of)e(this)i(section)f(sho)o
(ws)f(ho)o(w)g(a)h(macro)f(generating)h(another)g(macro)f(can)h(include)0
2704 y(ellipses)e(in)e(the)f(generated)g(macro)g(using)g(the)h(\\escap)q(e)f
(sequence")j(\()8 b Ff(:)g(:)g(:)28 b(:)8 b(:)g(:)f Fl(\))q(:)952
2828 y(25)p eop
%%Page: 26 27
bop 72 49 a Fl(\()q Fg(de\014ne-syn)o(tax)17 b(b)q(e-lik)o(e-b)q(egin)123
106 y Fl(\()q Fg(lam)o(b)q(da)j Fl(\()q Fi(x)7 b Fl(\))175
162 y(\()q Fg(syn)o(tax-case)17 b Fi(x)h Fl(\()r(\))227 219
y(\()r(\()p 269 219 14 2 v 281 219 V 44 w Fi(name)5 b Fl(\))247
275 y(\()q Fg(syn)o(tax)17 b Fl(\()q Fg(de\014ne-syn)o(tax)g
Fi(name)485 332 y Fl(\()q Fg(lam)o(b)q(da)j Fl(\()q Fi(x)7
b Fl(\))537 388 y(\()q Fg(syn)o(tax-case)17 b Fi(x)g Fl(\()r(\))589
444 y(\()r(\()p 631 444 V 642 444 V 44 w Fi(e0)g(e1)g Fl(\()9
b Ff(:)f(:)g(:)28 b(:)8 b(:)g(:)f Fl(\))r(\))609 501 y(\()q
Fg(syn)o(tax)17 b Fl(\()q Fg(b)q(egin)i Fi(e0)d(e1)i Fl(\()8
b Ff(:)g(:)g(:)28 b(:)8 b(:)g(:)f Fl(\))r(\))r(\))r(\))r(\))r(\))r(\))r(\))r
(\))r(\))r(\))r(\))0 587 y(F)l(ollo)o(wing)13 b(this,)i(\()q
Fg(b)q(e-lik)o(e-b)q(egin)20 b(sequence)q Fl(\))13 b(w)o(ould)g(allo)o(w)f
Fg(sequence)g Fl(to)g(b)q(e)i(used)f(in)o(terc)o(hangeably)h(with)0
644 y Fg(b)q(egin)q Fl(.)71 700 y(If)h(there)h(are)g(man)o(y)f(ellipses)j(in)
e(the)g(generated)g(macro,)e(it)i(ma)o(y)f(b)q(e)i(preferable)f(to)f(bind)i
(a)f(lo)q(cal)g(pattern)0 756 y(v)m(ariable)h(to)e(\()9 b Ff(:)f(:)g(:)28
b(:)8 b(:)g(:)f Fl(\))16 b(and)f(to)g(use)g(this)h(v)m(ariable)g(in)g(place)h
(of)d(the)j(\()8 b Ff(:)g(:)g(:)28 b(:)8 b(:)g(:)f Fl(\))16
b(in)g(the)g(de\014nition:)72 849 y(\()q Fg(de\014ne-syn)o(tax)h(b)q(e-lik)o
(e-b)q(egin)123 906 y Fl(\()q Fg(with-syn)o(tax)i Fl(\()r(\()q
Fi(dots)e Fl(\()q Fg(syn)o(tax)h Fl(\()8 b Ff(:)g(:)g(:)29
b(:)8 b(:)g(:)e Fl(\))r(\))r(\))r(\))175 962 y(\()q Fg(lam)o(b)q(da)20
b Fl(\()q Fi(x)7 b Fl(\))227 1019 y(\()q Fg(syn)o(tax-case)17
b Fi(x)h Fl(\()r(\))279 1075 y(\()r(\()p 321 1075 V 332 1075
V 44 w Fi(name)5 b Fl(\))299 1132 y(\()q Fg(syn)o(tax)17 b
Fl(\()q Fg(de\014ne-syn)o(tax)g Fi(name)537 1188 y Fl(\()q
Fg(lam)o(b)q(da)i Fl(\()q Fi(x)7 b Fl(\))589 1245 y(\()q Fg(syn)o(tax-case)17
b Fi(x)g Fl(\()r(\))641 1301 y(\()r(\()p 683 1301 V 694 1301
V 44 w Fi(e0)f(e1)h(dots)5 b Fl(\))660 1358 y(\()q Fg(syn)o(tax)18
b Fl(\()q Fg(b)q(egin)g Fi(e0)f(e1)f(dots)5 b Fl(\))r(\))r(\))r(\))r(\))r(\))
r(\))r(\))r(\))r(\))r(\))r(\))0 1529 y Fj(5)69 b(Theory)24
b(of)f(op)r(eration)0 1631 y Fl(Implemen)o(tation)f(of)f(the)g(macro)g
(system)g(is)h(surprisingly)h(straigh)o(tforw)o(ard.)36 b(In)21
b(this)h(section)g(w)o(e)f(brie\015y)0 1687 y(describ)q(e)c(ho)o(w)e(our)g
(implemen)o(tation)h(w)o(orks.)j(Other)c(strategies)g(ma)o(y)f(b)q(e)i(p)q
(ossible.)71 1744 y(Implemen)o(ting)f(the)f(basic)g(macro)f(expansion)h
(algorithm)g(is)g(a)f(pro)q(cedure)i(called)g(the)f Fi(exp)n(ander)p
Fl(,)f(whic)o(h)h(is)0 1800 y(called)h(b)q(efore)e(compilation)h(of)e(eac)o
(h)h(expression)h(en)o(tered)f(from)g(the)g(k)o(eyb)q(oard)f(or)h(loaded)h
(from)e(a)g(source)h(\014le.)0 1857 y(The)f(expander)g(tra)o(v)o(erses)e(the)
i(input)h(expression,)f(expanding)h(an)o(y)f(macros)e(it)i(encoun)o(ters)g
(and)g(handling)h(core)0 1913 y(forms)f(suc)o(h)h(as)g Fg(lam)o(b)q(da)q
Fl(,)g Fg(if)p Fl(,)g(and)g Fg(quote)p Fl(.)19 b(The)14 b(expander)f(main)o
(tains)g(a)g(lexical)i(compile-time)g(en)o(vironmen)o(t)0 1970
y(that)c(con)o(tains)g(information)g(ab)q(out)g(lexically)j(visible)g(iden)o
(ti\014ers:)19 b(macro)11 b(k)o(eyw)o(ords,)g(lexical)i(v)m(ariable)f(names,)
0 2026 y(and)k(pattern)g(v)m(ariable)i(names.)k(As)16 b(the)h(expander)f(en)o
(ters)g(the)g(scop)q(e)h(of)f(a)g(lexical)i(binding)g(construct)e(suc)o(h)0
2083 y(as)k Fg(lam)o(b)q(da)q Fl(,)h Fg(syn)o(tax-case)p Fl(,)g(or)e
Fg(letrec-syn)o(tax)q Fl(,)i(the)f(compile)i(time)e(en)o(vironmen)o(t)h(is)g
(augmen)o(ted)f(with)0 2139 y(information)f(ab)q(out)g(the)g(new)h(bindings.)
33 b(Up)q(on)20 b(lea)o(ving)g(the)f(scop)q(e,)h(this)g(information)f(is)h
(dropp)q(ed.)33 b(F)l(or)0 2195 y(macro)22 b(k)o(eyw)o(ords,)h(the)g(lexical)
h(compile-time)h(en)o(vironmen)o(t)e(holds)g(the)g(asso)q(ciated)g
(transformers.)41 b(F)l(or)0 2252 y(pattern)15 b(v)m(ariable)i(names,)f(it)g
(holds)g(the)g(nesting)g(depths,)g(i.e.,)g(the)f(n)o(um)o(b)q(er)h(of)g(lev)o
(els)h(of)e(nested)h(ellipses)i(b)o(y)0 2308 y(whic)o(h)f(the)f(pattern)f(v)m
(ariable)i(w)o(as)e(follo)o(w)o(ed.)23 b(F)l(or)15 b(lexical)j(v)m(ariable)f
(names,)e(it)i(records)e(nothing)i(more)e(than)0 2365 y(their)h(existence.)71
2421 y(Since)i(iden)o(ti\014er)h(bindings)h(ma)o(y)c(shado)o(w)h(enclosing)i
(iden)o(ti\014er)g(bindings,)g(only)f(the)g(most)e(recen)o(tly)i(en-)0
2478 y(coun)o(tered)12 b(binding)h(of)e(an)o(y)f(t)o(yp)q(e)i(is)f(relev)m
(an)o(t)h(during)h(expansion.)19 b(A)11 b(top-lev)o(el)i(compile-time)g(en)o
(vironmen)o(t)e(is)0 2534 y(main)o(tained)k(as)f(w)o(ell)i(to)d(hold)i
(bindings)i(from)c(top-lev)o(el)j(macro)d(k)o(eyw)o(ords)h(to)g(the)g(asso)q
(ciated)h(transformers.)0 2591 y(An)g(iden)o(ti\014er)i(binding)g(in)f(the)f
(top-lev)o(el)i(compile-time)g(en)o(vironmen)o(t)e(is)h(relev)m(an)o(t)f(at)g
(a)g(giv)o(en)g(p)q(oin)o(t)h(only)f(if)0 2647 y(there)h(is)g(no)g(lexical)h
(binding)h(for)d(the)h(iden)o(ti\014er.)23 b(The)15 b(phrase)h
(\\compile-time)i(en)o(vironmen)o(t")d(refers)h(to)f(the)0
2704 y(com)o(bined)f(lexical)h(and)e(top-lev)o(el)h(en)o(vironmen)o(ts;)g
(iden)o(ti\014ers)h(lo)q(ok)o(ed)e(up)h(in)g(the)f(compile-time)i(en)o
(vironmen)o(t)952 2828 y(26)p eop
%%Page: 27 28
bop 0 49 a Fl(are)15 b(\014rst)g(lo)q(ok)o(ed)i(for)d(in)j(the)f(lexical)h
(en)o(vironmen)o(t,)f(and)f(if)h(no)g(binding)i(exists)d(there,)h(then)g(in)g
(the)g(top-lev)o(el)0 106 y(en)o(vironmen)o(t.)71 162 y(Within)h(the)f(scop)q
(e)h(of)e(a)h(lexical)i(binding)g(for)e(an)g(iden)o(ti\014er)h
Ff(x)p Fl(,)f(the)g(expander)h(replaces)g(all)g(o)q(ccurrences)0
219 y(of)d Ff(x)f Fl(with)i(a)e(new)h(iden)o(ti\014er.)22 b(This)14
b(new)g(iden)o(ti\014er)i(con)o(tains)e(the)g(original)h(name)f(of)f(the)h
(iden)o(ti\014er,)i(a)d(unique)0 275 y(generated)i(name,)h(and)f(the)h(same)f
(set)g(of)g(marks)g(\(describ)q(ed)i(b)q(elo)o(w\))e(as)g Ff(x)p
Fl(.)21 b(The)15 b(original)i(name)e(is)h(retained)0 332 y(in)h(case)f(the)g
(iden)o(ti\014er)h(is)f(ultimately)h(used)g(as)e(sym)o(b)q(olic)i(data,)e
(i.e.,)h(in)h(case)f(it)g(ev)o(en)o(tually)h(app)q(ears)f(within)0
388 y(a)g Fg(quote)g Fl(expression.)23 b(The)16 b(newly)h(generated)f(name)g
(is)g(used)h(to)e(lo)q(ok)i(up)f(the)g(iden)o(ti\014er's)h(meaning)g(in)g
(the)0 444 y(compile-time)i(en)o(vironmen)o(t.)24 b(Th)o(us,)16
b(the)h(lexical)i(compile-time)f(en)o(vironmen)o(t)f(maps)f(generated)h
(names)g(to)0 501 y(binding)g(information.)71 557 y(F)l(or)h(e\016ciency)l(,)
j(this)f(substitution)g(is)f(actually)h(done)f(incremen)o(tally)l(,)j(not)d
(all)h(at)e(once,)i(b)o(y)f(creating)g(a)0 614 y(syn)o(tax)d(ob)s(ject)g
(encapsulating)i(the)f(outermost)e(form)h(with)h(an)g(en)o(vironmen)o(t)g
(mapping)g(the)g(old)g(iden)o(ti\014ers)0 670 y(to)k(the)h(corresp)q(onding)h
(new)f(iden)o(ti\014ers.)42 b(Then,)24 b(as)d(the)h(form)f(is)i(destructured)
f(and)g(tra)o(v)o(ersed)f(b)o(y)h(the)0 727 y(expander)17 b(and)g(macro)f
(transformers)f(\(using)i Fg(syn)o(tax-case)p Fl(\),)f(the)h(encapsulation)h
(is)f(\\pushed)h(do)o(wn")e(in)o(to)0 783 y(the)f(subforms)g(and)g(the)h(p)q
(ending)h(substitutions)f(are)f(p)q(erformed.)71 840 y(In)i(the)h(case)f(of)f
(lexical)k(\()p Fg(lam)o(b)q(da)p Fl(-b)q(ound\))e(v)m(ariables,)h(the)e
(generated)g(names)g(b)q(ecome)h(the)f(formal)g(pa-)0 896 y(rameter)i(names)g
(of)g(the)h(generated)g Fg(lam)o(b)q(da)g Fl(expression.)34
b(F)l(or)19 b(pattern-v)m(ariables)h(within)h Fg(syn)o(tax-case)0
953 y Fl(patterns,)16 b(a)g Fg(lam)o(b)q(da)h Fl(binding)h(for)e(eac)o(h)g
(of)g(the)g(generated)g(names)h(is)f(established)i(within)g(the)e(fender)h
(and)0 1009 y(output)g(expressions;)i(these)e(names)g(are)g(b)q(ound)h(at)f
(run)g(time)h(to)e(the)i(corresp)q(onding)g(pieces)g(of)f(the)g(input.)0
1065 y(F)l(or)f(a)h(pattern)f(v)m(ariable)j(follo)o(w)o(ed)e(b)o(y)g(an)f
(ellipsis,)k(the)d(generated)g(name)g(is)g(b)q(ound)h(to)e(a)h(list)h(of)e
(the)h(corre-)0 1122 y(sp)q(onding)g(forms;)e(for)g(t)o(w)o(o)f(lev)o(els)j
(of)f(ellipses,)h(a)f(list)g(of)g(lists)g(of)g(the)f(corresp)q(onding)i
(forms;)e(and)h(so)f(on.)22 b(F)l(or)0 1178 y Fg(let-syn)o(tax)17
b Fl(and)g Fg(letrec-syn)o(tax)g Fl(forms,)g(the)g(generated)g(name)g(is)g
(not)g(b)q(ound)h(at)e(run)h(time,)h(but)f(is)g(used)0 1235
y(solely)f(as)f(a)g(handle)h(for)f(the)g(binding)i(in)f(the)g(compile-time)h
(en)o(vironmen)o(t.)71 1291 y(When)23 b(an)f(iden)o(ti\014er)i(reference)g
(is)f(encoun)o(tered)g(b)o(y)g(the)g(expander,)h(the)f(expander's)g(action)g
(di\013ers)0 1348 y(dep)q(ending)17 b(up)q(on)f(the)f(con)o(text)f(of)h(the)g
(reference)g(and)g(the)g(visible)i(compile-time)g(binding)g(of)e(the)g(iden)o
(ti\014er.)0 1404 y(If)f(the)g(iden)o(ti\014er)i(o)q(ccurs)e(in)h(the)f(k)o
(eyw)o(ord)f(p)q(osition)i(of)e(a)h(form)f(that)g(migh)o(t)h(b)q(e)g(a)g
(macro)f(call)i(and)f(it)g(is)h(found)0 1461 y(to)g(b)q(e)i(a)e(macro)h(k)o
(eyw)o(ord)f(in)h(the)g(compile-time)i(en)o(vironmen)o(t,)e(the)g(asso)q
(ciated)g(transformer)f(is)h(in)o(v)o(ok)o(ed)g(as)0 1517 y(describ)q(ed)h(b)
q(elo)o(w.)71 1574 y(If)g(an)f(iden)o(ti\014er)j(encoun)o(tered)e(b)o(y)g
(the)g(expander)g(is)g(an)g(apparen)o(t)f(v)m(ariable)i(reference)g(and)f(it)
g(is)g(b)q(ound)0 1630 y(as)c(a)g(lexical)j(v)m(ariable)e(\()p
Fg(lam)o(b)q(da)q Fl(-b)q(ound)h(v)m(ariable\),)f(it)g(is)g(con)o(v)o(erted)f
(in)o(to)g(a)g(reference)i(to)d(the)i(corresp)q(onding)0 1686
y(generated)g(name.)20 b(If)15 b(it)f(is)h(not)f(b)q(ound)h(an)o(ywhere,)f
(it)h(is)g(assumed)f(to)g(b)q(e)h(a)f(reference)h(to)f(a)g(top-lev)o(el)h
(binding)0 1743 y(and)20 b(is)g(th)o(us)g(expanded)h(in)o(to)f(its)g
(original)h(name.)34 b(An)20 b(apparen)o(t)g(v)m(ariable)h(reference)g(to)e
(an)o(y)g(other)h(t)o(yp)q(e)0 1799 y(of)d(iden)o(ti\014er)i(\(macro)d(k)o
(eyw)o(ord)h(or)g(pattern)f(v)m(ariable\))j(is)f(an)f(in)o(v)m(alid)j
(reference,)e(whic)o(h)g(is)g(signaled)h(b)o(y)e(the)0 1856
y(expander.)71 1912 y(If)k(an)g(iden)o(ti\014er)h(app)q(ears)g(within)g(a)e
Fg(syn)o(tax)h Fl(form)f(and)h(it)g(is)h(b)q(ound)g(as)e(a)h(pattern)g(v)m
(ariable)h(in)g(the)0 1969 y(compile-time)h(en)o(vironmen)o(t,)e(the)g
(generated)f(name)h(and)g(the)f(nesting)h(lev)o(el)h(are)e(used)h(b)o(y)g
(the)f(expander)0 2025 y(to)f(generate)h(co)q(de)h(that)e(inserts)h(the)g
(corresp)q(onding)h(subforms)f(in)o(to)g(the)g(output.)34 b(An)o(y)20
b(other)f(iden)o(ti\014er)0 2082 y(app)q(earing)d(within)g(a)f
Fg(syn)o(tax)g Fl(form)f(is)i(inserted)g(in)o(to)f(the)g(output)g(unc)o
(hanged.)71 2138 y(If)g(an)g(iden)o(ti\014er)i(app)q(ears)e(within)i(a)e
Fg(quote)g Fl(form,)f(it)h(is)h(stripp)q(ed)g(do)o(wn)f(to)g(the)g(original)h
(name.)71 2195 y(A)g(macro)g(call)h(is)g(handled)h(as)e(follo)o(ws.)23
b(First,)16 b(a)g(new)h(\\mark")e(is)i(created.)23 b(Eac)o(h)16
b(mark)g(is)h(distinguish-)0 2251 y(able)g(from)e(other)h(marks,)f(but)h(it)h
(is)f(otherwise)g(unimp)q(ortan)o(t)h(ho)o(w)e(marks)h(are)f(represen)o(ted.)
23 b(W)l(e)16 b(curren)o(tly)0 2307 y(represen)o(t)d(marks)g(as)f(in)o
(tegers.)20 b(This)13 b(mark)g(is)g(attac)o(hed)g(to)f(eac)o(h)i(iden)o
(ti\014er)g(in)g(the)f(input)i(to)d(the)h(macro,)g(and)0 2364
y(the)g(resulting)h(expression)f(is)g(passed)g(to)f(the)h(transformer.)18
b(Iden)o(ti\014ers)c(in)f(the)g(output)g(from)f(the)g(transformer)0
2420 y(are)j(similarly)i(mark)o(ed,)d(except)i(that)e(iden)o(ti\014ers)j(to)e
(whic)o(h)h(the)f(mark)f(is)i(already)g(attac)o(hed)e(are)h(stripp)q(ed)h(of)
0 2477 y(the)f(mark.)k(In)d(this)g(w)o(a)o(y)l(,)e(the)h(mark)g(\\stic)o(ks")
f(only)i(to)e(iden)o(ti\014ers)j(in)o(tro)q(duced)f(b)o(y)g(the)f
(transformer;)e(it)j(do)q(es)0 2533 y(not)d(stic)o(k)g(to)f(iden)o(ti\014ers)
j(that)d(the)h(transformer)f(copies)i(from)e(the)h(input)h(in)o(to)f(the)g
(output.)19 b(As)13 b(with)g(the)g(sub-)0 2590 y(stitution)i(of)f(old)h(iden)
o(ti\014ers)h(with)f(new)g(iden)o(ti\014ers)h(describ)q(ed)h(ab)q(o)o(v)o(e,)
d(this)h(marking)f(is)h(done)g(incremen)o(tally)0 2646 y(for)h(e\016ciency;)k
(marks)c(to)g(b)q(e)i(applied)h(are)e(recorded)g(along)g(with)h
(substitutions)g(to)e(b)q(e)i(p)q(erformed)f(in)h(eac)o(h)0
2703 y(syn)o(tax)c(ob)s(ject.)952 2828 y(27)p eop
%%Page: 28 29
bop 71 49 a Fl(The)17 b(marks)f(are)h(used)h(to)f(inhibit)i(substitution)f
(of)f(macro-in)o(tro)q(duced)h(lexical)h(iden)o(ti\014ers)f(that)f(should)0
106 y(not)f(b)q(e)h(captured)g(b)o(y)g(bindings)h(in)g(the)e(con)o(text)g(of)
h(the)f(call)i(nor)e(\(if)h(b)q(ound)h(b)o(y)e(the)h(output)f(of)g(the)h
(macro\))0 162 y(capture)h(references)g(in)g(the)g(input)h(to)e(the)g(call.)
29 b(If)17 b(the)h(marks)f(on)h(an)f(o)q(ccurrence)i(of)e(an)h(iden)o
(ti\014er)h(within)0 219 y(the)c(scop)q(e)g(of)f(a)g(lexical)j(binding)f
(construct)e(are)h(not)f(the)g(same)h(as)f(the)g(marks)g(on)h(the)f(b)q(ound)
i(iden)o(ti\014er,)g(the)0 275 y(o)q(ccurrence)g(is)g(left)g(alone)f(ev)o(en)
h(if)f(the)h(iden)o(ti\014ers)g(are)f(otherwise)h(equiv)m(alen)o(t.)71
332 y(F)l(or)e(example,)i(consider)g(the)f(expansion)h(of:)72
431 y(\()q Fg(let)j Fl(\()r(\()q Fi(if)d Fl(#f)5 b(\))r(\))16
b(\()q Fg(or2)h Fi(if)f(t)5 b Fl(\))r(\))0 525 y(using)16 b(the)f(t)o(w)o
(o-sub)q(expression)h(v)o(ersion)f(of)g Fg(or)g Fl(b)q(elo)o(w:)72
625 y(\()q Fg(de\014ne-syn)o(tax)i(or2)123 681 y Fl(\()q Fg(lam)o(b)q(da)j
Fl(\()q Fi(x)7 b Fl(\))175 738 y(\()q Fg(syn)o(tax-case)17
b Fi(x)h Fl(\()r(\))227 794 y(\()r(\()p 269 794 14 2 v 281
794 V 44 w Fi(e1)f(e2)7 b Fl(\))247 850 y(\()q Fg(syn)o(tax)17
b Fl(\()q Fg(let)j Fl(\()r(\()q Fi(t)c(e1)7 b Fl(\))r(\))17
b(\()q Fg(if)h Fi(t)e(t)h(e2)7 b Fl(\))r(\))r(\))r(\))r(\))r(\))r(\))0
944 y(The)19 b(expression)h(ab)q(o)o(v)o(e)e(should)i(ev)m(aluate)f(to)g(the)
f(top-lev)o(el)i(v)m(alue)g(of)f(the)g(v)m(ariable)h Fi(t)p
Fl(.)30 b(As)19 b(the)g(expansion)0 1001 y(unfolds,)d(observ)o(e)g(ho)o(w)f
(substitution)i(and)f(marking)f(prev)o(en)o(t)h(the)g(binding)i(for)d
Fg(if)h Fl(in)g(the)g(source)g(expression)0 1057 y(from)f(in)o(terfering)h
(with)g(the)g(macro's)e(use)i(of)f Fg(if)h Fl(and)g(the)f(macro's)g(binding)i
(for)e Fi(t)h Fl(from)f(in)o(terfering)h(with)g(the)0 1114
y(source)f(expression's)h(reference)g(to)e Fi(t)p Fl(.)71 1170
y(F)l(or)d(simplicit)o(y)l(,)j(w)o(e)e(assume)g(that)f Fg(let)i
Fl(is)f(handled)i(directly)f(b)o(y)f(the)g(expander;)h(with)g(a)e(little)j
(more)d(tedium)0 1227 y(w)o(e)h(could)i(\014rst)e(expand)i(it)f(in)o(to)f
(the)h(corresp)q(onding)h Fg(lam)o(b)q(da)g Fl(application.)20
b(W)l(e)13 b(also)g(assume)f(that)g(iden)o(ti\014er)0 1283
y(substitutions)k(and)f(marks)g(are)g(applied)i(immediately)g(rather)d(than)h
(incremen)o(tally)l(.)71 1339 y(F)l(or)f(purp)q(oses)i(of)f(this)g
(discussion,)i(iden)o(ti\014ers)g(are)d(sho)o(wn)h(as)g(ordered)g(triples)i
(of)e(the)g(form:)71 1425 y Fk(h)p Fi(original-name)o Ff(;)8
b Fi(curr)n(ent-name)o Ff(;)g Fk(f)p Fi(mark)16 b Ff(:)8 b(:)g(:)d
Fk(gi)0 1519 y Fl(The)15 b(original)i(input)f(is)g(th)o(us:)72
1605 y(\()q Fk(h)p Fl(let)p Ff(;)8 b Fl(let)o Ff(;)g Fk(fgi)15
b Fl(\()r(\()q Fk(h)p Fl(if)p Ff(;)8 b Fl(if)p Ff(;)g Fk(fgi)13
b Fl(#f)5 b(\))r(\))140 1661 y(\()q Fk(h)p Fl(or2)o Ff(;)j
Fl(or2)n Ff(;)g Fk(fgi)14 b(h)p Fl(if)p Ff(;)8 b Fl(if)o Ff(;)g
Fk(fgi)14 b(h)p Fl(t)o Ff(;)8 b Fl(t)o Ff(;)g Fk(fgi)q Fl(\))r(\))71
1756 y(On)19 b(the)f(\014rst)h(step,)g(since)h Fg(let)f Fl(has)f(no)h(other)f
(binding)j(but)d(its)h(original)h(binding)g(in)g(the)f(top-lev)o(el)g(en-)0
1812 y(vironmen)o(t,)d(the)g(b)q(ound)h(v)m(ariable)h(from)d(the)i(outer)e
Fg(let)i Fl(expression)g(is)g(replaced)g(with)g(the)f(generated)g(name)0
1869 y Fi(g0001)q Fl(,)g(and)g(the)g(o)q(ccurrence)i(of)d(the)i(iden)o
(ti\014er)g(within)h(the)e(scop)q(e)h(of)e(the)i Fg(let)g Fl(expression)g(is)
f(replaced)i(with)0 1925 y(a)d(new)g(iden)o(ti\014er)i(that)e(con)o(tains)g
(b)q(oth)g(the)g(generated)h(and)f(original)h(names:)72 2011
y(\()q(let)g(\()r(\()q(g0001)e(#f)5 b(\))r(\))140 2067 y(\()q
Fk(h)p Fl(or2)o Ff(;)j Fl(or2)n Ff(;)g Fk(fgi)14 b(h)p Fl(if)p
Ff(;)8 b Fl(g0001)n Ff(;)g Fk(fgi)13 b(h)p Fl(t)o Ff(;)8 b
Fl(t)o Ff(;)g Fk(fgi)q Fl(\))r(\))0 2161 y(Existence)16 b(of)e(this)h
(binding)h(for)e Fi(g0001)i Fl(is)f(also)f(recorded)h(in)h(the)e(lexical)j
(compile-time)f(en)o(vironmen)o(t.)k(Next,)0 2218 y(the)15
b(transformer)f(for)h Fg(or2)g Fl(is)g(in)o(v)o(ok)o(ed,)g(with)h(iden)o
(ti\014ers)h(in)f(its)f(input)h(mark)o(ed)f(b)o(y)g(mark)g
Ff(m)1640 2225 y Fh(1)1659 2218 y Fl(:)72 2303 y(\()q Fk(h)p
Fl(or2)n Ff(;)8 b Fl(or2)o Ff(;)g Fk(f)p Ff(m)339 2310 y Fh(1)357
2303 y Fk(gi)15 b(h)p Fl(if)p Ff(;)8 b Fl(g0001)n Ff(;)g Fk(f)p
Ff(m)675 2310 y Fh(1)694 2303 y Fk(gi)14 b(h)p Fl(t)p Ff(;)8
b Fl(t)n Ff(;)g Fk(f)p Ff(m)906 2310 y Fh(1)925 2303 y Fk(gi)q
Fl(\))0 2398 y(The)15 b(transformer)f(for)h Fg(or2)g Fl(pro)q(duces:)72
2483 y(\()q Fk(h)p Fl(let)p Ff(;)8 b Fl(let)o Ff(;)g Fk(fgi)15
b Fl(\()r(\()q Fk(h)p Fl(t)o Ff(;)8 b Fl(t)o Ff(;)g Fk(fgi)14
b(h)p Fl(if)p Ff(;)8 b Fl(g0001)n Ff(;)g Fk(f)p Ff(m)802 2490
y Fh(1)820 2483 y Fk(gi)q Fl(\))r(\))140 2540 y(\()q Fk(h)p
Fl(if)p Ff(;)g Fl(if)p Ff(;)g Fk(fgi)13 b(h)p Fl(t)o Ff(;)8
b Fl(t)o Ff(;)g Fk(fgi)14 b(h)p Fl(t)o Ff(;)8 b Fl(t)o Ff(;)g
Fk(fgi)14 b(h)p Fl(t)o Ff(;)8 b Fl(t)o Ff(;)g Fk(f)p Ff(m)849
2547 y Fh(1)867 2540 y Fk(gi)q Fl(\))r(\))0 2634 y(Next,)16
b(within)h(the)g(output)f(from)f(the)h Fg(or2)g Fl(transformer,)f(iden)o
(ti\014ers)j(not)e(mark)o(ed)f(with)i Ff(m)1634 2641 y Fh(1)1670
2634 y Fl(are)f(so)f(mark)o(ed)0 2690 y(while)i(the)e Ff(m)237
2697 y Fh(1)272 2690 y Fl(mark)f(is)i(remo)o(v)o(ed)f(from)f(the)h(others)g
(\(since)h(iden)o(tical)h(marks)e(cancel\).)952 2828 y(28)p
eop
%%Page: 29 30
bop 72 93 a Fl(\()q Fk(h)p Fl(let)p Ff(;)8 b Fl(let)o Ff(;)g
Fk(f)p Ff(m)313 100 y Fh(1)332 93 y Fk(gi)16 b Fl(\()r(\()q
Fk(h)p Fl(t)o Ff(;)8 b Fl(t)o Ff(;)g Fk(f)p Ff(m)585 100 y
Fh(1)603 93 y Fk(gi)15 b(h)p Fl(if)p Ff(;)8 b Fl(g0001)n Ff(;)g
Fk(fgi)q Fl(\))r(\))140 149 y(\()q Fk(h)p Fl(if)p Ff(;)g Fl(if)p
Ff(;)g Fk(f)p Ff(m)334 156 y Fh(1)352 149 y Fk(gi)15 b(h)p
Fl(t)o Ff(;)8 b Fl(t)o Ff(;)g Fk(f)p Ff(m)565 156 y Fh(1)584
149 y Fk(gi)14 b(h)p Fl(t)o Ff(;)8 b Fl(t)o Ff(;)g Fk(f)p Ff(m)796
156 y Fh(1)815 149 y Fk(gi)14 b(h)p Fl(t)p Ff(;)8 b Fl(t)o
Ff(;)g Fk(fgi)q Fl(\))r(\))0 244 y(Only)18 b(the)f(curren)o(t)g(name)g(is)h
(relev)m(an)o(t)f(when)h(an)f(iden)o(ti\014er's)h(binding)h(is)f(determined)g
(in)g(the)f(compile-time)0 300 y(en)o(vironmen)o(t,)c(so)g(ev)o(en)h(though)e
(the)i(mark)e Ff(m)811 307 y Fh(1)844 300 y Fl(has)h(b)q(een)h(attac)o(hed)e
(to)h(the)g(iden)o(ti\014er)i Fg(let)p Fl(,)f(it)f(still)h(resolv)o(es)g(to)0
356 y(the)i(top-lev)o(el)i(de\014nition)g(for)d Fg(let)q Fl(.)23
b(Therefore,)16 b(the)g(b)q(ound)h(iden)o(ti\014er)h(is)f(replaced)g(with)g
(a)f(generated)g(name)0 413 y(and)f(o)q(ccurrences)g(of)f(the)g(iden)o
(ti\014er)i(\(with)f(the)f(same)g(curren)o(t)h(name)f(and)h(marks\))e(are)h
(replaced)i(with)f(a)f(new)0 469 y(iden)o(ti\014er)j(within)f(the)f(scop)q(e)
h(of)f(the)g Fg(let)h Fl(expression:)72 555 y(\()q(let)g(\()r(\()q(g0002)e
Fk(h)p Fl(if)p Ff(;)8 b Fl(g0001)n Ff(;)g Fk(fgi)q Fl(\))r(\))140
612 y(\()q Fk(h)p Fl(if)p Ff(;)g Fl(if)p Ff(;)g Fk(f)p Ff(m)334
619 y Fh(1)352 612 y Fk(gi)15 b(h)p Fl(t)o Ff(;)8 b Fl(g0002)n
Ff(;)g Fk(f)p Ff(m)661 619 y Fh(1)679 612 y Fk(gi)15 b(h)p
Fl(t)o Ff(;)8 b Fl(g0002)n Ff(;)g Fk(f)p Ff(m)988 619 y Fh(1)1007
612 y Fk(gi)14 b(h)p Fl(t)p Ff(;)8 b Fl(t)o Ff(;)g Fk(fgi)q
Fl(\))r(\))0 706 y(Existence)15 b(of)g(this)g(binding)h(for)e
Fi(g0002)h Fl(is)g(also)g(recorded)g(in)g(the)g(lexical)h(compile-time)h(en)o
(vironmen)o(t,)d(whic)o(h)0 762 y(still)j(also)e(holds)h(a)f(record)g(of)g
(the)g(binding)i(for)e Fi(g0001)p Fl(.)71 819 y(Since)22 b
Fi(g0001)h Fl(is)e(recorded)h(as)f(a)g(lexically)j(b)q(ound)e(v)m(ariable)h
(in)f(the)g(compile-time)h(en)o(vironmen)o(t,)g(the)0 875 y(o)q(ccurrence)17
b(of)f Fk(h)p Fl(if)p Ff(;)8 b Fl(g0001)n Ff(;)g Fk(fgi)14
b Fl(expands)i(in)o(to)g(a)g(reference)h(to)e Fi(g0001)q Fl(.)22
b(Th)o(us,)15 b(the)h(output)g(expression)h(so)f(far)0 931
y(consists)f(of)g(the)g(follo)o(wing:)72 1017 y(\()q(let)h(\()r(\()q(g0001)e
(#f)5 b(\))r(\))140 1074 y(\()q(let)16 b(\()r(\()q(g0002)e(g0001)q(\))r(\))
208 1130 y(\()q Fk(h)p Fl(if)p Ff(;)8 b Fl(if)p Ff(;)g Fk(f)p
Ff(m)402 1137 y Fh(1)420 1130 y Fk(gi)15 b(h)p Fl(t)o Ff(;)8
b Fl(g0002)n Ff(;)g Fk(f)p Ff(m)729 1137 y Fh(1)748 1130 y
Fk(gi)14 b(h)p Fl(t)p Ff(;)8 b Fl(g0002)m Ff(;)g Fk(f)p Ff(m)1056
1137 y Fh(1)1075 1130 y Fk(gi)15 b(h)p Fl(t)o Ff(;)8 b Fl(t)o
Ff(;)g Fk(fgi)q Fl(\))r(\))r(\))0 1224 y(with)14 b(the)g(last)g(line)i(as)d
(y)o(et)h(unexpanded.)21 b(Since)15 b(the)f(curren)o(t)g(name)g(of)g(the)g
(iden)o(ti\014er)h Fk(h)p Fl(if)q Ff(;)8 b Fl(if)o Ff(;)g Fk(f)p
Ff(m)1712 1231 y Fh(1)1731 1224 y Fk(gi)13 b Fl(is)i Fg(if)p
Fl(,)f(the)0 1281 y(last)h(line)i(is)f(recognized)g(as)f(an)g
Fg(if)h Fl(expression:)72 1366 y(\()q(let)g(\()r(\()q(g0001)e(#f)5
b(\))r(\))140 1423 y(\()q(let)16 b(\()r(\()q(g0002)e(g0001)q(\))r(\))208
1479 y(\()q(if)i Fk(h)p Fl(t)o Ff(;)8 b Fl(g0002)n Ff(;)g Fk(f)p
Ff(m)522 1486 y Fh(1)540 1479 y Fk(gi)15 b(h)p Fl(t)o Ff(;)8
b Fl(g0002)n Ff(;)g Fk(f)p Ff(m)849 1486 y Fh(1)868 1479 y
Fk(gi)14 b(h)p Fl(t)p Ff(;)8 b Fl(t)n Ff(;)g Fk(fgi)q Fl(\))r(\))r(\))0
1573 y(Only)19 b(the)f(three)g(v)m(ariable)h(references)g(within)g(this)f
Fg(if)g Fl(expression)h(remain)f(to)g(b)q(e)g(expanded.)29
b(The)18 b(curren)o(t)0 1630 y(name,)d Fi(g0002)q Fl(,)h(for)f(the)g(\014rst)
h(and)g(second)g(of)f(these)h(is)g(recorded)g(as)g(a)f(lexical)j(v)m(ariable)
f(in)f(the)g(compile-time)0 1686 y(en)o(vironmen)o(t)g(so)e(b)q(oth)i(simply)
g(expand)g(in)o(to)f Fi(g0002)q Fl(.)20 b(The)c(curren)o(t)f(name)g(for)g
(the)g(third)h(is)g Fi(t)p Fl(,)f(whic)o(h)h(has)f(no)0 1743
y(binding)j(in)f(the)f(lexical)i(compile-time)g(en)o(vironmen)o(t;)f
(therefore)f(it)g(expands)h(in)o(to)f(a)g(top-lev)o(el)h(reference)g(to)0
1799 y Fi(t)p Fl(.)j(Th)o(us,)15 b(the)g(\014nal)h(output)f(from)f(the)i
(expander)g(is:)72 1885 y(\()q(let)g(\()r(\()q(g0001)e(#f)5
b(\))r(\))140 1941 y(\()q(let)16 b(\()r(\()q(g0002)e(g0001)q(\))r(\))208
1998 y(\()q(if)i(g0002)d(g0002)h(t)q(\))r(\))r(\))71 2092 y(Resp)q(onsibilit)
o(y)g(for)e(\\pushing)h(do)o(wn")f(the)g(substitutions)i(and)e(markings)g(in)
i(the)e(actual)h(implemen)o(tation)0 2149 y(is)j(giv)o(en)g(to)f
Fg(syn)o(tax-case)g Fl(expressions.)22 b(As)15 b(a)h Fg(syn)o(tax-case)f
Fl(matc)o(hes)g(the)h(input)g(against)f(a)h(pattern,)e(an)o(y)0
2205 y(syn)o(tax)g(ob)s(jects)g(that)h(m)o(ust)f(b)q(e)i(destructured)f(are)g
(destructured)g(only)g(as)g(far)f(as)h(necessary)g(to)f(p)q(erform)h(the)0
2261 y(matc)o(h,)c(and)g(the)h(substitutions)g(and)f(markings)g(are)g
(transferred)g(to)f(the)i(sub)q(expressions)g(of)f(the)g(destructured)0
2318 y(form.)18 b(If)13 b(the)f(matc)o(h)g(is)h(successful,)h(the)e
(resulting)i(v)m(alues)f(are)f(b)q(ound)i(to)d(the)i(pattern)f(v)m(ariables)h
(\(actually)l(,)h(to)0 2374 y(the)e(corresp)q(onding)h(generated)f(names\))g
(within)h(the)f(fender)h(and)f(output)g(expressions.)19 b(Subforms)12
b(of)g Fg(syn)o(tax)0 2431 y Fl(expressions)g(within)h(the)e(scop)q(e)h(of)f
(these)g(pattern)g(v)m(ariables)h(are)f(rebuilt)i(as)e(necessary)g(to)g
(insert)h(these)f(v)m(alues.)0 2487 y(All)20 b(substitutions)f(and)g(marks)f
(attac)o(hed)g(to)h(pieces)h(of)e(the)h(output)f(from)g Fg(syn)o(tax)g
Fl(are)g(retained)i(so)e(that,)0 2544 y(when)j(they)f(are)g(subsequen)o(tly)h
(inserted)g(in)o(to)f(the)g(output)g(of)g(a)g(macro,)g(iden)o(ti\014ers)i
(within)f(these)g(pieces)0 2600 y(refer)c(to)g(the)h(bindings)h(visible)h
(where)e(they)f(\014rst)g(app)q(eared.)28 b(The)18 b(expander)g(strips)g(all)
g(suc)o(h)g(information)0 2657 y(from)d Fg(quote)h Fl(forms)f(\(using)h(the)g
(equiv)m(alen)o(t)h(of)f Fi(syntax-obje)n(ct)p Fk(\000)-8 b
Ff(>)p Fi(datum)q Fl(\),)15 b(since)i(quoted)f(sym)o(b)q(ols)g(are)f(used)952
2828 y(29)p eop
%%Page: 30 31
bop 0 49 a Fl(as)15 b(ordinary)g(sym)o(b)q(olic)i(data.)71
106 y(Tw)o(o)f(iden)o(ti\014ers)i(are)f Fi(b)n(ound-identi\014er=?)g
Fl(if)h(and)f(only)h(if)f(they)g(ha)o(v)o(e)g(the)g(same)g(curren)o(t)g(name)
g(\(whic)o(h)0 162 y(implies)d(they)d(ha)o(v)o(e)g(the)h(same)f(original)h
(name\))f(and)h(the)f(same)h(marks.)17 b(Tw)o(o)11 b(iden)o(ti\014ers)i(are)e
Fi(fr)n(e)n(e-identi\014er=?)0 219 y Fl(if)i(and)f(only)h(if)g(they)f(ha)o(v)
o(e)g(the)g(same)g(curren)o(t)g(name.)19 b(This)13 b(is)f(a)g(re\015ection)h
(of)f(the)g(compile-time)j(en)o(vironmen)o(t)0 275 y(lo)q(okup)23
b(and)f(iden)o(ti\014er)i(replacemen)o(t)f(rules:)34 b(only)23
b(the)f(curren)o(t)g(name)g(is)g(relev)m(an)o(t)h(for)e(determining)j(an)0
332 y(iden)o(ti\014er's)17 b(binding,)g(while)h(b)q(oth)d(the)h(curren)o(t)g
(name)g(and)g(the)f(marks)g(m)o(ust)h(agree)f(for)g(an)h(iden)o(ti\014er)h
(to)e(b)q(e)0 388 y(replaced)h(within)h(the)e(scop)q(e)h(of)f(a)f(lexical)k
(binding)f(construct.)71 444 y(Tw)o(o)12 b(iden)o(ti\014ers)k(that)d(are)g
Fi(b)n(ound-identi\014er=?)g Fl(ma)o(y)g(not)h(b)q(e)g Fi(e)n(qv?)p
Fl(,)f(since)i(other)f(information)g(\(including)0 501 y(source)h
(annotations\))f(ma)o(y)g(b)q(e)i(presen)o(t)f(in)g(the)g(iden)o(ti\014er)i
(structure.)i(Th)o(us,)c(it)g(is)g(rarely)g(useful)h(to)e(use)h
Fi(e)n(qv?)0 557 y Fl(on)g(iden)o(ti\014ers.)71 614 y(The)g(implemen)o
(tation)i(of)e Fi(implicit-identi\014er)f Fl(is)i(straigh)o(tforw)o(ard,)d
(although)j(it)f(do)q(es)h(place)g(constrain)o(ts)0 670 y(on)g(the)h
(implemen)o(tation)h(that)d(otherwise)i(w)o(ould)g(not)f(b)q(e)h(necessary)l
(.)24 b(Sp)q(eci\014cally)m(,)19 b(all)e(iden)o(ti\014er)h(substitu-)0
727 y(tions)d(required)h(b)o(y)e(binding)j(forms)c(visible)k(to)d(an)h(o)q
(ccurrence)h(of)e(an)g(iden)o(ti\014er)j(m)o(ust)d(b)q(e)h(recorded)g(with)g
(the)0 783 y(iden)o(ti\014er,)f(including)g(those)d(substitutions)i(that)e
(do)g(not)g(a\013ect)g(the)h(iden)o(ti\014er)h(due)f(to)f(a)h(di\013erence)h
(in)f(curren)o(t)0 840 y(name)k(or)g(marks.)22 b(An)16 b(implicit)j(iden)o
(ti\014er)e(is)g(formed)f(b)o(y)g(cop)o(ying)h(the)f(substitutions)h(and)f
(marks)f(from)h(the)0 896 y(template)i(iden)o(ti\014er)i(in)o(to)e(a)g(new)h
(iden)o(ti\014er.)30 b(The)19 b(original)g(name)f(of)g(the)g(new)h(iden)o
(ti\014er)g(is)g(giv)o(en)g(b)o(y)f(the)0 953 y(second)h(argumen)o(t)g(to)f
Fi(implicit-identi\014er)o Fl(,)i(and)f(the)g(curren)o(t)g(name)g(is)g
(determined)h(b)o(y)f(the)g(substitutions)0 1009 y(and)c(marks)g(recorded)g
(with)h(the)f(template)h(iden)o(ti\014er.)0 1152 y Fj(References)0
1254 y Fl([1])22 b(William)15 b(Clinger)f(and)f(Jonathan)h(Rees.)i(Macros)c
(that)h(w)o(ork.)i(In)f Fi(Confer)n(enc)n(e)f(R)n(e)n(c)n(or)n(d)g(of)i(the)g
(Eighte)n(enth)71 1310 y(A)o(nnual)k(A)o(CM)g(Symp)n(osium)h(on)g(Principles)
f(of)h(Pr)n(o)n(gr)n(amming)g(L)n(anguages)p Fl(,)f(pages)g(155{162,)f(Jan)o
(uary)71 1367 y(1991.)0 1460 y([2])k(William)f(Clinger,)h(Jonathan)e(A.)f
(Rees,)i(et)e(al.)34 b(The)20 b(revised)1197 1444 y Fh(4)1238
1460 y Fl(rep)q(ort)f(on)h(the)g(algorithmic)h(language)71
1517 y(Sc)o(heme.)f Fi(LISP)15 b(Pointers)p Fl(,)f(4\(3\),)g(1991.)0
1611 y([3])22 b(R.)14 b(Ken)o(t)h(Dyb)o(vig.)20 b Fi(The)c(Scheme)g(Pr)n(o)n
(gr)n(amming)g(L)n(anguage)p Fl(.)j(Pren)o(tice-Hall,)d(1987.)0
1704 y([4])22 b(Rob)q(ert)11 b(Hieb,)j(R.)d(Ken)o(t)i(Dyb)o(vig,)f(and)h
(Carl)f(Bruggeman.)j(Syn)o(tactic)e(abstraction)e(in)j(sc)o(heme.)h(T)l(ec)o
(hnical)71 1761 y(Rep)q(ort)f(355,)g(Indiana)j(Computer)d(Science)j
(Departmen)o(t,)d(June)j(1992.)0 1855 y([5])22 b(Eugene)f(Kohlb)q(ec)o(k)o
(er.)38 b Fi(Syntactic)21 b(Extensions)e(in)i(the)h(Pr)n(o)n(gr)n(amming)f(L)
n(anguage)f(Lisp)p Fl(.)36 b(PhD)21 b(thesis,)71 1911 y(Indiana)16
b(Univ)o(ersit)o(y)l(,)g(Blo)q(omington,)f(August)g(1986.)0
2005 y([6])22 b(Eugene)15 b(Kohlb)q(ec)o(k)o(er,)h(Daniel)h(P)l(.)d(F)l
(riedman,)i(Matthias)e(F)l(elleisen,)j(and)f(Bruce)f(Duba.)20
b(Hygienic)d(macro)71 2061 y(expansion.)j(In)c Fi(Pr)n(o)n(c)n(e)n(e)n(dings)
e(of)i(the)g(1986)h(A)o(CM)f(Confer)n(enc)n(e)e(on)i(Lisp)f(and)h(F)m
(unctional)f(Pr)n(o)n(gr)n(amming)p Fl(,)71 2118 y(pages)g(151{161,)e(1986.)
952 2828 y(30)p eop
%%Trailer
end
userdict /end-hook known{end-hook}if
%%EOF
